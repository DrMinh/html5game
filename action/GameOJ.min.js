var gameOJ={stage:null,stage1:null,stage2:null,loadMC:null,asset:null,Socket:null,gameW:0,gameH:0,
gameSW:0,gameSH:0,gameTT:0,gameNN:0,Sound:[],bulletList:[],playerList:[],enemyList:[],effectList:[],
scoreList:{value:[],updated:!1,redraw:!1,enemyPoint:0,teamPoint:0},schema:[],currentMap:null,
currentTheme:null,player:null,SpriteSheetList:[],AniL1NameList:[],playerControl:null,pingtime:0,
userNameInput:null,pickedTank:1,playerID:null,playerTeam:null,dataTeam:null,dataDead:null,
userNameUpdateList:null,tankStyleUpdateList:null,moveTankData:{Y:null,B:null,E:null,H:null,HE:null},
gameTime:0,gameEnd:{endCode:0,point:0,lastEnemy:""},canvasOfLayer:{mapL1Layer:null,
mapL1_5Layer:null,mapL2Layer:null},staticValues:{mapL1LayerNumber:0,aniL1LayerNumber:1,
mapL1_5LayerNumber:2,mapItemLayerNumber:3,tankLayerNumber:4,enemyLayerNumber:5,bulletLayerNumber:6,
mapL2LayerNumber:7,effectLayerNumber:8,scoreLayerNumber:9,controlLayerNumber:10,alertLayerNumer:11},
socketName:{},bulletInfor:{tank1:{speed:6,dame:50,effect:[1],sound:"shoot1"},tank2:{speed:5,dame:50,
effect:[11],sound:"shoot1"},tank3:{speed:5,dame:80,effect:[9,10],sound:"shoot3"},tank1_1:{speed:5,
dame:150,effect:[15],sound:"shoot1"},tank3_1:{speed:5,dame:50,effect:[16],sound:"shoot3"},enemy1:{
size:10,speed:3,dame:180,effect:[18],sound:"shoote1"}},skillData:{tank1_1:{countdown_default:5e3,
type:1,sprite:"skill1_1"},tank2_1:{countdown_default:1e4,type:3,sprite:"skill2_1"},tank3_1:{
countdown_default:5e3,type:1,sprite:"skill3_1"}},skillValue:{k1:{countdown:0}},effectSound:{
effect2:"effect2",effect13:"effect3",effect14:"effect3",effect7:"effect4"},unknownData:{
scoreListValue:[]},addCon:function(e,t){var a=this;a[e]=t},KetThua:function(e,t){
t.prototype=Object.create(e.prototype),t.prototype.constructor=t},setval:function(){
gameOJ.Socket=io("//tanknode.herokuapp.com",{parser:customParser}),gameOJ.buildSchema(),
gameOJ.Socket.on(gameOJ.socketName.tank,function(e){gameOJ.saveTankData(e)
}),gameOJ.Socket.on(gameOJ.socketName.bullet,function(e){gameOJ.saveBulletData(e)}),
gameOJ.Socket.on(gameOJ.socketName.enemy,function(e){gameOJ.saveEnemyData(e)
}),gameOJ.Socket.on(gameOJ.socketName.hideTank,function(e){gameOJ.saveHideTankData(e)}),
gameOJ.Socket.on(gameOJ.socketName.hideEnemy,function(e){gameOJ.saveHideEnemyData(e)}),
gameOJ.Socket.on(gameOJ.socketName.updateEffect,function(e){gameOJ.applyEffect(e)}),
gameOJ.Socket.on("map_infor",function(e){gameOJ.getAndBuildMap(e)
}),gameOJ.Socket.on(gameOJ.socketName.rebuildEffect,function(e){
""!==e.length&&gameOJ.applyEffect(e,!1)}),gameOJ.Socket.on("update_username",function(e){
gameOJ.saveUpdateUserName(e)}),gameOJ.Socket.on("update_tankstyle",function(e){
gameOJ.saveUpdateTankStyle(e)}),gameOJ.Socket.on("update_player",function(e){
gameOJ.savePlayerID(e.p),gameOJ.gameTime=e.t,gameOJ.playerTeam=e.g
}),gameOJ.Socket.on(gameOJ.socketName.updateScore,function(e){gameOJ.saveScore(e)}),
gameOJ.Socket.on("update_status",function(e){gameOJ.updateStatus(e)
}),gameOJ.Socket.on("update_skill",function(e){gameOJ.updateSkill(e)
}),gameOJ.Socket.on("update_team",function(e){gameOJ.saveDataTeam(e)
}),gameOJ.Socket.on(gameOJ.socketName.updateDead,function(e){gameOJ.saveDeadData(e)}),
gameOJ.Socket.on(gameOJ.socketName.deadBullet,function(e){gameOJ.saveDetroyedBullet(e)}),
gameOJ.Socket.on("rp",function(e){gameOJ.saveLogoutPlayer(e)
}),gameOJ.userNameInput=document.getElementById("inputArea"),
gameOJ.userNameInput.addEventListener("submit",e=>{
var t=document.getElementById("userJoinGameName").value
;if(!gameOJ.checkUserName(t))return document.getElementById("namerule").style.display="block",
void e.preventDefault()
;if(gameOJ.userNameInput.style.display="none",document.getElementById("namerule").style.display="none",
0!==gameOJ.stage1.numChildren){let e=gameOJ.stage1.getChildAt(gameOJ.stage1.numChildren-1)
;e.getChildAt(e.numChildren-1).text=t,e.cache(0,0,200,30)}e.preventDefault()}),gameOJ.gameH=300,
gameOJ.gameW=500,gameOJ.gameSH=1,gameOJ.gameSW=1,gameOJ.stage=new createjs.StageGL("demoCanvas"),
gameOJ.stage1=new createjs.Container,
gameOJ.stage2=new createjs.Container,gameOJ.stage3=new createjs.Container,gameOJ.stage3.visible=!1,
gameOJ.stage.addChild(gameOJ.stage1,gameOJ.stage2,gameOJ.stage3),gameOJ.asset=[{
src:"./asset/boxy_bold_fat.png",id:"boxy_font"},{src:"./asset/resize.jpg",id:"resize"},{
src:"./asset/bullet_1.png",id:"bullet"},{src:"./asset/tankBase.png",id:"tankBase"},{
src:"./asset/tankTurret.png",id:"tankTurret"},{src:"./asset/enemy.png",id:"enemy"},{
src:"./asset/enemy_turret.png",id:"enemyTurret"},{src:"./asset/effect.png",id:"effect"},{
src:"./asset/map_1.png",id:"map_1"},{src:"./asset/hpbar.png",id:"hpbar"},{
src:"./asset/menuimage_r.png",id:"menuImage"},{src:"./asset/UIList.png",id:"uiList"},{
src:"./asset/effect_p.png",id:"effect_p"},{src:"./asset/item.png",id:"item"},{
src:"./asset/icon.png",id:"icon"},{src:"./asset/skill.png",id:"skill"},{src:"./asset/logo.png",
id:"logo"},{src:"./map/map3.json",id:"map3"},{src:"./sound/theme1.ogg",id:"theme1"},{
src:"./sound/shoot1.ogg",id:"shoot1"},{src:"./sound/shoot1.ogg",id:"shoot3"},{
src:"./sound/shoote1.ogg",id:"shoote1"},{src:"./sound/effect2.ogg",id:"effect2"},{
src:"./sound/effect3.ogg",id:"effect3"},{src:"./sound/effect4.ogg",id:"effect4"},{
src:"./sound/win1.ogg",id:"win1"},{src:"./sound/bell.ogg",id:"bell"},{src:"./sound/s1.ogg",id:"s1"
},{src:"./sound/peffect1.ogg",id:"peffect1"},{src:"./sound/peffect7.ogg",id:"peffect7"}],
gameOJ.loadMC=new LoadMi(gameOJ),createjs.Ticker.addEventListener("tick",gameOJ.tick),
createjs.Ticker.timingMode=createjs.Ticker.RAF,
createjs.Ticker.framerate=60,gameOJ.stage.enableMouseOver(20),gameOJ.stage.mouseEnabled=!0,
createjs.Touch.enable(gameOJ.stage),gameOJ.stage.snapToPixelEnabled=!0,this.AddSound(),
gameOJ.FixCanvas(),window.addEventListener("resize",gameOJ.FixCanvas)},AddSound:function(){
this.Sound.shoot1=new Howl({src:["sound/shoot1.ogg"],autoplay:!1,loop:!1,volume:.2}),
this.Sound.shoot3=new Howl({src:["sound/shoot3.ogg"],autoplay:!1,loop:!1,volume:.2}),
this.Sound.shoote1=new Howl({src:["sound/shoote1.ogg"],autoplay:!1,loop:!1,volume:.2}),
this.Sound.effect2=new Howl({src:["sound/effect2.ogg"],autoplay:!1,loop:!1,volume:.2}),
this.Sound.effect3=new Howl({src:["sound/effect3.ogg"],autoplay:!1,loop:!1,volume:.2}),
this.Sound.effect4=new Howl({src:["sound/effect4.ogg"],autoplay:!1,loop:!1,volume:.2}),
this.Sound.peffect1=new Howl({src:["sound/peffect1.ogg"],autoplay:!1,loop:!1,volume:.2}),
this.Sound.peffect7=new Howl({src:["sound/peffect7.ogg"],autoplay:!1,loop:!1,volume:.2}),
this.Sound.win1=new Howl({src:["sound/win1.ogg"],autoplay:!1,loop:!1,volume:.2}),
this.Sound.bell=new Howl({src:["sound/bell.ogg"],autoplay:!1,loop:!1,volume:.2}),
this.Sound.s1=new Howl({src:["sound/s1.ogg"],autoplay:!1,loop:!1,volume:.2
}),this.Sound.theme1=new Howl({src:["sound/theme1.ogg"],autoplay:!1,loop:!0,volume:.2})},
playSound:function(e,t,a){let i=1,n=Math.max(a,t);i=1-.1*~~(n/50),i<=0||(gameOJ.Sound[e].volume(i),
gameOJ.Sound[e].play())},buildSchema:function(e=customParser.PacketBuilder){var t=0
;gameOJ.socketName.moveTank=++t,e.build(t,"int8"),gameOJ.socketName.shootBullet=++t,
e.build(t,"float32"),gameOJ.socketName.shootSkill=++t,e.build(t,{t:"uint8",r:"float32",p:"string"}),
gameOJ.socketName.tank=++t,e.build(t,[{p:"string",x:"int16",y:"int16",g:"float32",m:"int16",
t:"int16",e:["uint8"],s:"float32",reload:"uint16"}]),gameOJ.socketName.bullet=++t,e.build(t,[{
i:"string",p:"string",x:"int16",y:"int16",r:"float32",n:"int8",s:"string"
}]),gameOJ.socketName.updateEffect=++t,e.build(t,"string"),gameOJ.socketName.rebuildEffect=++t,
e.build(t,"string"),
gameOJ.socketName.deadBullet=++t,e.build(t,["string"]),gameOJ.socketName.updateDead=++t,e.build(t,[{
playerId:"string",time:"uint32"}]),gameOJ.socketName.updateScore=++t,e.build(t,[{playerID:"string",
d:"int8",point:"int8"
}]),gameOJ.socketName.hideTank=++t,e.build(t,["string"]),gameOJ.socketName.enemy=++t,e.build(t,[{
p:"string",x:"int16",y:"int16",g:"float32",m:"int16",t:"int16",e:["uint8"],s:"float32",
reload:"uint16",team:"string",style:"string"}]),gameOJ.socketName.hideEnemy=++t,
e.build(t,["string"]),gameOJ.socketName.deadEnemy=++t,e.build(t,[{playerId:"string",time:"uint32"}])
},checkUserName:function(e){var t=/^[0-9a-zA-Z_]{4,15}$/;return!!e.match(t)},
CreateAnimation:function(){var e={images:[gameOJ.loadMC.getAsset("resize")],frames:{width:170,
height:180},animations:{main:[0,38,!0,.5]}};this.SpriteSheetList.resize=new createjs.SpriteSheet(e)
;var t=new createjs.Sprite(this.SpriteSheetList.resize)
;t.gotoAndPlay("main"),t.scaleX=gameOJ.gameW/170,t.scaleY=gameOJ.gameH/180,gameOJ.stage3.addChild(t)
;var a={images:[gameOJ.loadMC.getAsset("tankBase")],frames:{width:32,height:32},animations:{tank1:0,
tank2:1,tank3:2}};this.SpriteSheetList.TankBase=new createjs.SpriteSheet(a);var i={
images:[gameOJ.loadMC.getAsset("tankTurret")],frames:{width:32,height:32},animations:{tank1:0,
tank1s:[1,3,"tank1",.5],tank2:4,tank2s:[5,7,"tank2",.5],tank3:8,tank3s:[9,10,"tank3",.5]}}
;this.SpriteSheetList.TankTurret=new createjs.SpriteSheet(i);var n={
images:[gameOJ.loadMC.getAsset("enemy")],frames:{width:50,height:50},animations:{enemy1:0}}
;this.SpriteSheetList.Enemy=new createjs.SpriteSheet(n);var s={
images:[gameOJ.loadMC.getAsset("enemyTurret")],frames:{width:50,height:50},animations:{enemy1:0,
enemy1s:[1,3,"enemy1",.5]}};this.SpriteSheetList.EnemyTurret=new createjs.SpriteSheet(s);var r={
images:[gameOJ.loadMC.getAsset("bullet")],frames:{width:50,height:50},animations:{tank1:0,tank2:1,
tank3:2,tank1_1:[3,6,!0,.5],tank3_1:[7],enemy1:[8,11,!0,.5]}}
;this.SpriteSheetList.bullet=new createjs.SpriteSheet(r);var o={
images:[gameOJ.loadMC.getAsset("effect")],frames:{width:50,height:50},animations:{
effect1:[0,6,!1,.5],effect2:[7,16,!1,.3],effect3:[17,21,!1,.3],effect4:[22,26,!1,.3],effect5:[27],
effect6:[28,36,!1,.3],effect7:[37,43,!1,.2],effect8:[44,52,!1,.2],effect9:[53,58,!1,.5],
effect10:[59],effect11:[60,65,!1,.5],effect12:[66,71,!1,.1],effect13:[72,73,!1,.1],
effect14:[74,75,!1,.1],effect15:[76,83,!1,.3],effect16:[84,93,!1,.2],effect17:[94,100,!1,.3],
effect18:[101,108,!1,.3]}};this.SpriteSheetList.effect=new createjs.SpriteSheet(o);var m={
images:[gameOJ.loadMC.getAsset("effect_p")],frames:{width:50,height:50},animations:{
effect1:[0,2,!0,.5],effect2:[3,5,!0,.5],effect3:[6,9,!0,.5],effect4:[10,14,!0,.2],effect5:[15],
effect6:[16,19,!0,.3],effect10:[20]}};this.SpriteSheetList.effect_p=new createjs.SpriteSheet(m)
;var l={images:[gameOJ.loadMC.getAsset("item")],frames:{width:50,height:50},animations:{
item1:[0,4,!0,.2],item2:[5],item3:[6,7,!0,.1],item4:[8,13,!0,.1],item5:[14,18,!0,.2]}}
;this.SpriteSheetList.item=new createjs.SpriteSheet(l);var g={
images:[gameOJ.loadMC.getAsset("icon")],frames:{width:50,height:50},animations:{board:[0],kill1:[1],
kill2:[2],kill3:[3],kill4:[7],kill5:[4,7,!1,.8]}}
;this.SpriteSheetList.icon=new createjs.SpriteSheet(g);var c={
images:[gameOJ.loadMC.getAsset("logo")],frames:{width:200,height:64},animations:{
victory:[1,3,!0,.1],defeat:[4]}};this.SpriteSheetList.logo=new createjs.SpriteSheet(c);var h={
images:[gameOJ.loadMC.getAsset("skill")],frames:{width:40,height:40},animations:{back:[0],
skill1_1:[1],skill2_1:[2],skill3_1:[3]}};this.SpriteSheetList.skill=new createjs.SpriteSheet(h)
;var d={images:[gameOJ.loadMC.getAsset("boxy_font")],frames:{width:9,height:8},animations:{c0:[0],
c1:[1],c2:[2],c3:[3],c4:[4],c5:[5],c6:[6],c7:[7],c8:[8],c9:[9],"c:":[82]}}
;this.SpriteSheetList.font=new createjs.SpriteSheet(d);var u={
images:[gameOJ.loadMC.getAsset("map_1")],frames:{width:16,height:16},animations:{a123:{
frames:[123,124,125,163,164,165],next:!0,speed:.1},a16:{frames:[16,18,20,96,98,100],next:!0,speed:.1
},a17:{frames:[17,19,21,97,99,101],next:!0,speed:.1},a56:{frames:[56,58,60,136,138,140],next:!0,
speed:.1},a57:{frames:[57,59,61,137,139,141],next:!0,speed:.1}}}
;this.SpriteSheetList.map_1=new createjs.SpriteSheet(u),this.AniL1NameList.push(123,16,17,56,57)
;var p={images:[gameOJ.loadMC.getAsset("hpbar")],frames:{width:60,height:20}}
;this.SpriteSheetList.hpbar=new createjs.SpriteSheet(p)},resetGame:function(){gameOJ.bulletList=[],
gameOJ.playerList=[],gameOJ.enemyList=[],gameOJ.effectList=[],gameOJ.scoreList={value:[],updated:!1,
redraw:!1},gameOJ.currentMap=null,gameOJ.player=null,gameOJ.pingtime=0},createMap:function(e){
mapData=gameOJ.loadMC.getAsset(e),gameOJ.currentMap=mapData
;for(var t=new createjs.Container,a=0;a<mapData.layers[0].data.length;a++){
var i=mapData.layers[0].data[a]-1,n=a%mapData.width,s=Math.floor(a/mapData.width);if(-1!==i){
var r=new createjs.Sprite(this.SpriteSheetList.map_1)
;-1===this.AniL1NameList.indexOf(i)?(r.gotoAndStop(i),
r.x=n*mapData.tilewidth,r.y=s*mapData.tileheight,t.addChild(r)):(r.gotoAndPlay("a"+i),
r.x=n*mapData.tilewidth,
r.y=s*mapData.tileheight,gameOJ.stage2.getChildAt(gameOJ.staticValues.aniL1LayerNumber).addChild(r)),
n++,n>=mapData.width&&(s++,n=0)}}for(var o=0;o<mapData.layers[5].objects.length;o++){
let e=mapData.layers[5].objects[o],a=new createjs.Bitmap(gameOJ.loadMC.getAsset("map_1"))
;a.sourceRect=new createjs.Rectangle(496,368,32,32),a.x=e.x-8,a.y=e.y-8,t.addChild(a)}
t.cache(0,0,mapData.width*mapData.tilewidth,mapData.height*mapData.tileheight)
;var m=new createjs.Bitmap(t.cacheCanvas)
;m.sourceRect=new createjs.Rectangle(0,0,gameOJ.gameW,gameOJ.gameH),
gameOJ.stage2.getChildAt(gameOJ.staticValues.mapL1LayerNumber).addChild(m),t.removeAllChildren(),
gameOJ.canvasOfLayer.mapL1Layer=t;var l=new createjs.Container
;for(a=0;a<mapData.layers[1].data.length;a++){i=mapData.layers[1].data[a]-1,n=a%mapData.width,
s=Math.floor(a/mapData.width);if(-1!==i){r=new createjs.Sprite(this.SpriteSheetList.map_1)
;r.gotoAndStop(i),r.x=n*mapData.tilewidth,r.y=s*mapData.tileheight,l.addChild(r),n++,
n>=mapData.width&&(s++,n=0)}}
l.cache(0,0,mapData.width*mapData.tilewidth,mapData.height*mapData.tileheight)
;var g=new createjs.Bitmap(l.cacheCanvas)
;g.sourceRect=new createjs.Rectangle(0,0,gameOJ.gameW,gameOJ.gameH),
gameOJ.stage2.getChildAt(gameOJ.staticValues.mapL1_5LayerNumber).addChild(g),l.removeAllChildren(),
gameOJ.canvasOfLayer.mapL1_5Layer=l;var c=new createjs.Container
;for(a=0;a<mapData.layers[2].data.length;a++){i=mapData.layers[2].data[a]-1,n=a%mapData.width,
s=Math.floor(a/mapData.width);if(-1!==i){r=new createjs.Sprite(this.SpriteSheetList.map_1)
;r.gotoAndStop(i),r.x=n*mapData.tilewidth,r.y=s*mapData.tileheight,c.addChild(r),n++,
n>=mapData.width&&(s++,n=0)}}
c.cache(0,0,mapData.width*mapData.tilewidth,mapData.height*mapData.tileheight)
;var h=new createjs.Bitmap(c.cacheCanvas)
;h.sourceRect=new createjs.Rectangle(0,0,gameOJ.gameW,gameOJ.gameH),
gameOJ.stage2.getChildAt(gameOJ.staticValues.mapL2LayerNumber).addChild(h),c.removeAllChildren(),
gameOJ.canvasOfLayer.mapL2Layer=c,Boolean(mapData.theme)?(gameOJ.playSound(mapData.theme,300,300),
gameOJ.currentTheme=mapData.theme):(gameOJ.playSound("theme1",300,300),gameOJ.currentTheme="theme1")
},FixCanvas:function(){
gameOJ.stage.canvas.width=window.innerWidth,gameOJ.stage.canvas.height=window.innerHeight,
gameOJ.gameSH=gameOJ.stage.canvas.height/gameOJ.gameH,
gameOJ.gameSW=gameOJ.stage.canvas.width/gameOJ.gameW,gameOJ.stage.scaleX=gameOJ.gameSW,
gameOJ.stage.scaleY=gameOJ.gameSH,
gameOJ.stage.updateViewport(gameOJ.stage.canvas.width,gameOJ.stage.canvas.height),
window.innerHeight>window.innerWidth?gameOJ.stage3.visible=!0:gameOJ.stage3.visible=!1},
Fitcon:function(){var e=new createjs.Container;return e.scaleX=gameOJ.gameSW,e.scaleY=gameOJ.gameSH,
e},clearCanvas:function(){gameOJ.stage.removeAllChildren(),gameOJ.stage1.removeAllChildren(),
gameOJ.stage2.removeAllChildren()
;var e=new createjs.Container,t=new createjs.Container,a=new createjs.Container,i=new createjs.Container,n=new createjs.Container,s=new createjs.Container,r=new createjs.Container,o=new createjs.Container,m=new createjs.Container,l=new createjs.Container,g=new createjs.Container,c=new createjs.Container
;gameOJ.stage2.addChild(n,s,r,o,e,t,a,i,m,l,c,g),
gameOJ.stage.addChild(gameOJ.stage1,gameOJ.stage2,gameOJ.stage3)},changeTT:function(e){
gameOJ.gameTT=e,gameOJ.gameNN=0,gameOJ.playerID=null,gameOJ.playerTeam=null,gameOJ.clearCanvas()},
createFinishMenu:function(e){
null!==gameOJ.currentTheme&&gameOJ.Sound[gameOJ.currentTheme].volume(.2),
gameOJ.stage2.getChildAt(gameOJ.staticValues.controlLayerNumber).alpha=0
;var t=new createjs.Bitmap(gameOJ.loadMC.getAsset("uiList"))
;t.sourceRect=new createjs.Rectangle(18,24,302,45),
t.regX=t.sourceRect.width/2,t.regY=t.sourceRect.height/2,t.x=gameOJ.gameW/2,t.y=gameOJ.gameH/2-90
;var a=new createjs.Bitmap(gameOJ.loadMC.getAsset("uiList"))
;a.sourceRect=new createjs.Rectangle(26,230,302,60),a.regX=a.sourceRect.width/2,
a.regY=a.sourceRect.height/2,a.x=gameOJ.gameW/2,a.y=gameOJ.gameH/2-90
;var i=new createjs.Sprite(this.SpriteSheetList.logo,"victory");i.regX=100,i.regY=32,
i.x=gameOJ.gameW/2,i.y=gameOJ.gameH/2-90
;var n=new createjs.Sprite(this.SpriteSheetList.logo,"defeat");n.regX=100,n.regY=32,
n.x=gameOJ.gameW/2,n.y=gameOJ.gameH/2-90;let s=gameOJ.findPlayer(e.lastEnemy)
;if(1===e.endCode&&-1!==s)var r=gameOJ.playerList[s].playerName;else r="__"
;var o=new createjs.Container,m=new createjs.Shape((new createjs.Graphics).beginFill("#000000").drawRect(0,0,220,100)),l=new createjs.Text(e.point+"","20px Arial","#FFFFFF"),g=new createjs.Text(r,"20px Arial","#FFFFFF"),c=new createjs.Text("Point:","20px Arial","#FFFFFF"),h=new createjs.Text("Enemy:","20px Arial","#FFFFFF")
;c.maxWidth=100,c.x=20,c.y=20,l.maxWidth=100,l.x=100,l.y=20,g.maxWidth=100,g.x=100,g.y=40,
h.maxWidth=100,h.x=20,h.y=40,o.addChild(m,c,h,l,g),o.cache(0,0,220,150),o.regX=110,o.regY=75,
o.alpha=.8,o.x=gameOJ.gameW/2,o.y=gameOJ.gameH/2+30
;var d=new createjs.Bitmap(gameOJ.loadMC.getAsset("uiList"))
;d.sourceRect=new createjs.Rectangle(85,93,180,60),
d.regX=d.sourceRect.width/2,d.regY=d.sourceRect.height/2,d.x=gameOJ.gameW/2,d.y=gameOJ.gameH/2+100,
d.on("click",function(){null!==gameOJ.currentTheme&&(gameOJ.Sound[gameOJ.currentTheme].stop(),
gameOJ.currentTheme=null),gameOJ.leaveMatch(),gameOJ.changeTT(1)
}),2===e.endCode?(gameOJ.stage2.getChildAt(gameOJ.staticValues.alertLayerNumer).removeAllChildren(),
gameOJ.stage2.getChildAt(gameOJ.staticValues.alertLayerNumer).addChild(a,d,o)):1===e.endCode?(gameOJ.stage2.getChildAt(gameOJ.staticValues.alertLayerNumer).removeAllChildren(),
gameOJ.stage2.getChildAt(gameOJ.staticValues.alertLayerNumer).addChild(t,d,o)):3===e.endCode?(gameOJ.playSound("win1",0,0),
gameOJ.stage2.getChildAt(gameOJ.staticValues.alertLayerNumer).removeAllChildren(),
gameOJ.stage2.getChildAt(gameOJ.staticValues.alertLayerNumer).addChild(i,d,o)):4===e.endCode&&(gameOJ.playSound("shoot1",0,0),
gameOJ.stage2.getChildAt(gameOJ.staticValues.alertLayerNumer).removeAllChildren(),
gameOJ.stage2.getChildAt(gameOJ.staticValues.alertLayerNumer).addChild(n,d,o))},
updateScoreList:function(){
if(0!==gameOJ.stage2.getChildAt(gameOJ.staticValues.scoreLayerNumber).numChildren)var e=gameOJ.stage2.getChildAt(gameOJ.staticValues.scoreLayerNumber).getChildAt(0);else{
e=new createjs.Container;e.alpha=.8,e.x=gameOJ.gameW/2-120,e.y=gameOJ.gameH/2-100,e.visible=!1,
gameOJ.stage2.getChildAt(gameOJ.staticValues.scoreLayerNumber).addChild(e)}e.removeAllChildren(),
e.addChild(new createjs.Shape((new createjs.Graphics).beginFill("#000000").drawRect(0,0,480,400)))
;var t=new createjs.Text("Leaderboard [G]","36px Arial","#FFFFFF");t.maxWidth=240,t.x=120,t.y=10,
e.addChild(t);var a=[0,0],i=new createjs.Container;i.x=240,i.y=340
;for(var n=999999,s=0;s<gameOJ.scoreList.value.length;s++){var r=gameOJ.scoreList.value[s]
;if(Boolean(gameOJ.player)&&r.playerID===gameOJ.player.playerID){a[0]+=parseInt(r.point)
;var o="green";0===s&&r.point>gameOJ.player.killPoint&&(n=gameOJ.player.killPoint),
gameOJ.player.updateKillPoint(parseInt(r.point))}else if(""!==r.team&&r.team===gameOJ.player.team){
a[0]+=parseInt(r.point);o="#80b7ff"}else{a[1]+=parseInt(r.point);o="#ff665e"}
1===s&&parseInt(r.point)>=n&&gameOJ.playSound("s1",100,100)
;var m=new createjs.Text(r.nick,"30px Arial",o);m.maxWidth=240,m.x=20,m.y=2*(20*(s+1)+5)
;var l=new createjs.Text(r.point+"/"+r.dead,"30px Arial",o);l.x=360,l.y=2*(20*(s+1)+5),
l.maxWidth=240,e.addChild(m,l)}for(var g=0;g<a.length;g++){
l=new createjs.Text(a[g]+"","30px Arial",0===g?"#80b7ff":"#ff665e");if(l.lineWidth=60,l.maxWidth=60,
l.x=30*g*2,i.regX+=20,a.length-g>=2){var c=new createjs.Text("-","30px Arial","#EEEEEE")
;c.lineWidth=60,c.maxWidth=60,c.x=30*g*2+32,i.addChild(c)}i.addChild(l)}e.addChild(i),
e.cache(0,0,480,400),e.scaleX=e.scaleY=.5},changeMapCanvas:function(e,t,a,i,n){
var s=gameOJ.canvasOfLayer[e],r=new createjs.Sprite(this.SpriteSheetList.map_1)
;r.x=i*this.currentMap.tilewidth,r.y=n*this.currentMap.tileheight,-1!==t&&0!==t||(r.gotoAndStop(0),
s.addChild(r),
s.updateCache("destination-out")),0===t?(r.gotoAndStop(a),s.updateCache("source-over")):1===t&&(s.addChild(r),
r.gotoAndStop(a),s.updateCache("source-over")),s.removeAllChildren()},addItem:function(e,t,a,i){
let n=new createjs.Sprite(gameOJ.SpriteSheetList.item,"item"+a);n.itemID=i,n.regX=n.regY=16,n.x=e,
n.y=t,gameOJ.stage2.getChildAt(gameOJ.staticValues.mapItemLayerNumber).addChild(n)},
removeItem:function(e){var t=gameOJ.stage2.getChildAt(gameOJ.staticValues.mapItemLayerNumber)
;let a=t.children.findIndex(t=>t.itemID===e)
;-1!==a&&("item3"===t.getChildAt(a).currentAnimation&&gameOJ.addEffect(t.getChildAt(a).x+8,t.getChildAt(a).y+8,0,"7"),
t.removeChildAt(a))},moveCamera:function(e,t,a){var i=e-gameOJ.gameW/2,n=t-gameOJ.gameH/2
;i<0&&(i=0),
i>gameOJ.currentMap.width*gameOJ.currentMap.tilewidth-gameOJ.gameW&&(i=gameOJ.currentMap.width*gameOJ.currentMap.tilewidth-gameOJ.gameW),
n<0&&(n=0),
n>gameOJ.currentMap.height*gameOJ.currentMap.tileheight-gameOJ.gameH&&(n=gameOJ.currentMap.height*gameOJ.currentMap.tileheight-gameOJ.gameH),
gameOJ.stage2.getChildAt(gameOJ.staticValues.mapL1LayerNumber).getChildAt(0).sourceRect.x=i,
gameOJ.stage2.getChildAt(gameOJ.staticValues.mapL1LayerNumber).getChildAt(0).sourceRect.y=n,
gameOJ.stage2.getChildAt(gameOJ.staticValues.aniL1LayerNumber).x=-i,
gameOJ.stage2.getChildAt(gameOJ.staticValues.aniL1LayerNumber).y=-n,
gameOJ.stage2.getChildAt(gameOJ.staticValues.mapL1_5LayerNumber).getChildAt(0).sourceRect.x=i,
gameOJ.stage2.getChildAt(gameOJ.staticValues.mapL1_5LayerNumber).getChildAt(0).sourceRect.y=n,
gameOJ.stage2.getChildAt(gameOJ.staticValues.mapItemLayerNumber).x=-i,
gameOJ.stage2.getChildAt(gameOJ.staticValues.mapItemLayerNumber).y=-n,
gameOJ.stage2.getChildAt(gameOJ.staticValues.mapL2LayerNumber).getChildAt(0).sourceRect.x=i,
gameOJ.stage2.getChildAt(gameOJ.staticValues.mapL2LayerNumber).getChildAt(0).sourceRect.y=n,
gameOJ.stage2.getChildAt(gameOJ.staticValues.tankLayerNumber).x=-i,
gameOJ.stage2.getChildAt(gameOJ.staticValues.tankLayerNumber).y=-n,
gameOJ.stage2.getChildAt(gameOJ.staticValues.enemyLayerNumber).x=-i,
gameOJ.stage2.getChildAt(gameOJ.staticValues.enemyLayerNumber).y=-n,
gameOJ.stage2.getChildAt(gameOJ.staticValues.bulletLayerNumber).x=-i,
gameOJ.stage2.getChildAt(gameOJ.staticValues.bulletLayerNumber).y=-n,
gameOJ.stage2.getChildAt(gameOJ.staticValues.effectLayerNumber).x=-i,
gameOJ.stage2.getChildAt(gameOJ.staticValues.effectLayerNumber).y=-n},showAndHideBoard:function(e){
if(gameOJ.stage2.getChildAt(gameOJ.staticValues.scoreLayerNumber).numChildren>0){
var t=gameOJ.stage2.getChildAt(gameOJ.staticValues.scoreLayerNumber).getChildAt(0);t.visible=e}},
buildTimeText:function(){
var e=("00"+~~(gameOJ.gameTime/1e3/60)).slice(-2),t=("00"+~~(gameOJ.gameTime/1e3%60)).slice(-2)
;t=e+":"+t;for(var a=new createjs.Container,i=0;i<t.length;i++){
let e=new createjs.Sprite(gameOJ.SpriteSheetList.font);e.gotoAndStop("c"+t.charAt(i)),e.x=10*i,
a.addChild(e)}
a.regX=20,a.x=gameOJ.gameW/2,a.y=2,gameOJ.stage2.getChildAt(gameOJ.staticValues.alertLayerNumer).addChild(a)
},updateTimeText:function(e){if(0!==gameOJ.gameTime){var t=gameOJ.gameTime;gameOJ.gameTime-=e,
t>15e3&&gameOJ.gameTime<15e3&&gameOJ.playSound("bell",0,0)
;var a=("00"+~~(gameOJ.gameTime/1e3/60)).slice(-2),i=("00"+~~(gameOJ.gameTime/1e3%60)).slice(-2)
;i=a+":"+i
;for(var n=gameOJ.stage2.getChildAt(gameOJ.staticValues.alertLayerNumer).getChildAt(gameOJ.stage2.getChildAt(gameOJ.staticValues.alertLayerNumer).numChildren-1),s=0;s<i.length;s++)n.getChildAt(s).gotoAndStop("c"+i.charAt(s))
}},blockGame:function(){2===gameOJ.gameTT&&gameOJ.playerControl.clearMove()},findPlayer:function(e){
return gameOJ.playerList.findIndex(t=>t.playerID===e)},findEnemy:function(e){
return gameOJ.enemyList.findIndex(t=>t.playerID===e)},findBullet:function(e){
return gameOJ.bulletList.findIndex(t=>t.bulletID===e)},addPlayer:function(e,t,a,i){
var n=new gameOJ.Player(e,t,a,i)
;gameOJ.playerList.push(n),gameOJ.stage2.getChildAt(gameOJ.staticValues.tankLayerNumber).addChild(n.tankGraphic)
},addEnemy:function(e,t,a,i,n){var s=new gameOJ.TowerEnemy(e,t,a,i,n);gameOJ.enemyList.push(s),
gameOJ.stage2.getChildAt(gameOJ.staticValues.enemyLayerNumber).addChild(s.tankGraphic)},
addBullet:function(e,t,a,i,n,s,r=!1){var o=new gameOJ.Bullet(e,t,a,i,n,s,r)
;gameOJ.bulletList.push(o),
gameOJ.stage2.getChildAt(gameOJ.staticValues.bulletLayerNumber).addChild(o.bulletGraphic)},
addEffect:function(e,t,a,i){var n=new gameOJ.Effect(e,t,a,i,gameOJ.effectList.length)
;gameOJ.effectList.push(n),
gameOJ.stage2.getChildAt(gameOJ.staticValues.effectLayerNumber).addChild(n.effectGraphic)},
removePlayer:function(e,t=-1){var a=-1!==t?t:gameOJ.findPlayer(e)
;gameOJ.stage2.getChildAt(gameOJ.staticValues.tankLayerNumber).removeChild(gameOJ.playerList[a].tankGraphic),
gameOJ.playerList.splice(a,1);var i=gameOJ.scoreList.value.findIndex(t=>t.playerID===e)
;-1!==i&&(gameOJ.scoreList.value.splice(i,1),gameOJ.scoreList.redraw=!0)},
removeEnemy:function(e,t=-1){var a=-1!==t?t:gameOJ.findEnemy(e)
;gameOJ.stage2.getChildAt(gameOJ.staticValues.enemyLayerNumber).removeChild(gameOJ.enemyList[a].tankGraphic),
gameOJ.enemyList.splice(a,1)},removeBullet:function(e){var t=gameOJ.findBullet(e)
;gameOJ.stage2.getChildAt(gameOJ.staticValues.bulletLayerNumber).removeChild(gameOJ.bulletList[t].bulletGraphic),
gameOJ.bulletList.splice(t,1)},removeEffect:function(e){
gameOJ.stage2.getChildAt(gameOJ.staticValues.effectLayerNumber).removeChildAt(e),
gameOJ.effectList.splice(e,1)},updateScoreListNick:function(){
for(var e=!1,t=0;t<gameOJ.scoreList.value.length;t++)if("@"===gameOJ.scoreList.value[t].nick){
var a=gameOJ.findPlayer(gameOJ.scoreList.value[t].playerID)
;-1!==a?(gameOJ.scoreList.value[t].nick=gameOJ.playerList[a].playerName,
gameOJ.scoreList.value[t].team=gameOJ.playerList[a].team):(gameOJ.scoreList.updated=!0,e=!0)}
return e},stopAllPlayer:function(){for(var e=0;e<gameOJ.playerList.length;e++){
var t=gameOJ.playerList[e];t.addNewPosition(t.tankPoint.x+1,t.tankPoint.y+1,-1)}},
displayKillIcon:function(e){e>5&&(e=5)
;var t=gameOJ.stage2.getChildAt(gameOJ.staticValues.alertLayerNumer).getChildAt(3);t.visible=!0,
t.displayScore=1e3,t.gotoAndPlay("kill"+e)},createInGameMenu:function(){
let e=new createjs.Sprite(gameOJ.SpriteSheetList.icon,"board");e.on("mousedown",()=>{
gameOJ.showAndHideBoard(!0)}),e.on("pressup",()=>{gameOJ.showAndHideBoard(!1)})
;let t=new createjs.Container,a=new createjs.Sprite(gameOJ.SpriteSheetList.skill,"skill1_1"),i=new createjs.Sprite(gameOJ.SpriteSheetList.skill,"back"),n=new createjs.Container
;n.x=12,n.y=12,t.addChild(i,a,n),t.alpha=.8,t.regX=t.regY=20,t.x=gameOJ.gameW/2,t.y=gameOJ.gameH-20,
n.scaleX=n.scaleY=2;let s=new createjs.Container;s.scaleX=s.scaleY=5,s.x=gameOJ.gameW/2-25,
s.y=gameOJ.gameH/2-25,s.countdown=0;let r=new createjs.Sprite(gameOJ.SpriteSheetList.icon,"kill1")
;r.x=gameOJ.gameW/2-25,r.y=gameOJ.gameH/2-120,r.visible=!1,r.displayScore=0,r.on("tick",()=>{
r.displayScore>0&&(r.displayScore-=17,r.displayScore<=0&&(r.visible=!1))
}),gameOJ.stage2.getChildAt(gameOJ.staticValues.alertLayerNumer).addChild(e,t,s,r)},
tick:function(e){1==gameOJ.gameTT?gameOJ.tickMenu():2==gameOJ.gameTT&&gameOJ.tickPlay(e),
gameOJ.gameNN++,gameOJ.stage.update()},tickMenu:function(){if(0===gameOJ.gameNN){gameOJ.resetGame()
;var e=new createjs.Bitmap(gameOJ.loadMC.getAsset("menuImage")),t=new createjs.Bitmap(gameOJ.loadMC.getAsset("uiList"))
;t.sourceRect=new createjs.Rectangle(168,293,45,45),t.x=gameOJ.gameW/2-35-45,t.y=120
;var a=new createjs.Bitmap(gameOJ.loadMC.getAsset("uiList"))
;a.sourceRect=new createjs.Rectangle(216,293,46,46),a.x=gameOJ.gameW/2+32,a.y=120
;for(var i=new createjs.Container,n=1;n<4;n++){
let e=new createjs.Sprite(gameOJ.SpriteSheetList.TankBase,"tank"+n),t=new createjs.Sprite(gameOJ.SpriteSheetList.TankTurret,"tank"+n)
;e.x=32*(n-1),t.x=e.x,i.addChild(e,t)}i.cache(0,0,32*n-1,32)
;var s=new createjs.Bitmap(i.cacheCanvas)
;s.sourceRect=new createjs.Rectangle(32*(gameOJ.pickedTank-1),0,32,32),s.scaleX=s.scaleY=2,
s.regX=s.regY=16,s.y=gameOJ.gameH/2-64+50,s.x=gameOJ.gameW/2
;var r=new createjs.Bitmap(gameOJ.loadMC.getAsset("uiList"))
;r.sourceRect=new createjs.Rectangle(30,295,110,110),r.regX=r.regY=55,r.x=gameOJ.gameW/2,
r.y=gameOJ.gameH/2+80+50
;var o=new createjs.Container,m=new createjs.Text(document.getElementById("userJoinGameName").value,"15px Arial","#FFFFFF"),l=new createjs.Shape((new createjs.Graphics).beginStroke("white").f("#999999").drawRect(0,0,200,30))
;m.maxWidth=200,m.maxHeight=30,m.textAlign="center",m.x=100,m.y=7,o.addChild(l,m),
o.cache(0,0,200,30),o.regX=100,o.regY=15,o.x=gameOJ.gameW/2,o.y=gameOJ.gameH/2+50
;var g=new createjs.Bitmap(gameOJ.loadMC.getAsset("logo"))
;g.sourceRect=new createjs.Rectangle(0,0,200,64),g.x=gameOJ.gameW/2,g.y=gameOJ.gameH/2-80,
g.regX=100,g.regY=32
;var c=new createjs.Shape((new createjs.Graphics).f("#000000").drawRect(0,0,250,270))
;return c.x=gameOJ.gameW/2,c.y=gameOJ.gameH/2,c.regX=125,c.regY=125,c.alpha=.5,c.cache(0,0,250,270),
gameOJ.stage1.addChild(e,c,t,a,s,r,g,o),t.on("mousedown",()=>{
0===s.sourceRect.x?(s.sourceRect.x=32*(n-2),gameOJ.pickedTank=n-1):(s.sourceRect.x-=32,
gameOJ.pickedTank--)}),a.on("mousedown",()=>{s.sourceRect.x===32*(n-2)?(s.sourceRect.x=0,
gameOJ.pickedTank=1):(s.sourceRect.x+=32,gameOJ.pickedTank++)}),r.on("mousedown",()=>{
gameOJ.changeTT(2),gameOJ.joinGame(document.getElementById("userJoinGameName").value)}),
void o.on("mousedown",()=>{gameOJ.userNameInput.style.display="block"
;let e=document.getElementById("userJoinGameName");e.focus(),e.value=e.value})}},
tickPlay:function(e){if(0===gameOJ.gameNN){gameOJ.createControl()
;var t=new createjs.Bitmap(gameOJ.loadMC.getAsset("menuImage")),a=new createjs.Bitmap(gameOJ.loadMC.getAsset("uiList")),i=new createjs.Container
;a.sourceRect=new createjs.Rectangle(32,160,279,64),a.regX=a.sourceRect.width/2,
a.regY=a.sourceRect.height/2,a.x=gameOJ.gameW/2,a.y=gameOJ.gameH/2-100,i.addChild(t,a),
gameOJ.stage2.addChild(i)}else if(gameOJ.playerList.length>0){gameOJ.updateTimeText(e.delta),
gameOJ.updateSkillCountdown(gameOJ.skillValue.k1.countdown-e.delta),
gameOJ.updateDeadCountdown(e.delta)
;for(var n=0,s=0;Boolean(gameOJ.playerList[s])&&gameOJ.player;)Boolean(gameOJ.playerList[s].removed)&&gameOJ.playerList[s].removed===gameOJ.pingtime?(gameOJ.playerList[s].updateShootTime(Math.round(e.delta)),
gameOJ.playerList[s].Tick(e.delta),
s++):Boolean(gameOJ.playerList[s].removed)&&gameOJ.playerList[s].removed!==gameOJ.pingtime?(gameOJ.playerList[s].updateShootTime(Math.round(e.delta)),
gameOJ.playerList[s].Tick(e.delta),
s++):(gameOJ.addEffect(gameOJ.playerList[s].tankPoint.x,gameOJ.playerList[s].tankPoint.y,gameOJ.playerList[s].tankBaseSprite.rotation,"5"),
gameOJ.addEffect(gameOJ.playerList[s].tankPoint.x,gameOJ.playerList[s].tankPoint.y,gameOJ.playerList[s].tankBaseSprite.rotation,"2"),
gameOJ.removePlayer(gameOJ.playerList[s].playerID),n++)
;gameOJ.scoreList.redraw&&(gameOJ.updateScoreList(),gameOJ.scoreList.redraw=!1),n=0
;for(var r=0;Boolean(gameOJ.enemyList[r])&&gameOJ.player;)Boolean(gameOJ.enemyList[r].removed)&&gameOJ.enemyList[r].removed===gameOJ.pingtime?(gameOJ.enemyList[r].updateShootTime(Math.round(e.delta)),
gameOJ.enemyList[r].Tick(e.delta),
r++):Boolean(gameOJ.enemyList[r].removed)&&gameOJ.enemyList[r].removed!==gameOJ.pingtime?(gameOJ.enemyList[r].updateShootTime(Math.round(e.delta)),
gameOJ.enemyList[r].Tick(e.delta),r++):(gameOJ.removeEnemy(gameOJ.enemyList[r].playerID,r),n++);n=0
;for(var o=0;Boolean(gameOJ.bulletList[o]);)if(Boolean(gameOJ.bulletList[o].removed)&&gameOJ.bulletList[o].removed===gameOJ.pingtime)gameOJ.bulletList[o].Tick(),
o++;else if(Boolean(gameOJ.bulletList[o].removed)&&gameOJ.bulletList[o].removed!==gameOJ.pingtime)gameOJ.bulletList[o].Tick(),
o++;else{var m=gameOJ.bulletList[o]
;if(!m.fake)for(var l,g=gameOJ.bulletInfor[m.bulletStyle].effect,c=0;Boolean(l=g[c]);)gameOJ.addEffect(m.bulletPoint.x,m.bulletPoint.y,m.bulletRotation+90,""+l),
c++;gameOJ.removeBullet(m.bulletID),n++}n=0
;for(var h=0;Boolean(gameOJ.effectList[h]);)gameOJ.effectList[h].sortID-=n,
gameOJ.effectList[h].live>0?(gameOJ.effectList[h].Tick(),
h++):(gameOJ.removeEffect(gameOJ.effectList[h].sortID),n++)
;"key"===gameOJ.playerControl.controlType?(gameOJ.playerControl.mouseMoveEvent(gameOJ.stage.mouseX,gameOJ.stage.mouseY),
gameOJ.player&&(gameOJ.player.tankAimSprite.visible=gameOJ.playerControl.touchAim),
2===gameOJ.playerControl.spaceSkill.a&&gameOJ.shootSkill()):"touch"===gameOJ.playerControl.controlType&&(gameOJ.playerControl.fakeMouseMoveEvent(gameOJ.player.tankPoint.x+gameOJ.playerControl.fakeMouse.x,gameOJ.player.tankPoint.y+gameOJ.playerControl.fakeMouse.y),
gameOJ.playerControl.touchShoot&&gameOJ.player.lastShootTime<1&&(gameOJ.shootBullet(),
gameOJ.player&&gameOJ.player.updateShootTime(Math.round(e.delta))),
gameOJ.player&&(gameOJ.player.tankAimSprite.visible=gameOJ.playerControl.touchAim),
2===gameOJ.playerControl.spaceSkill.a&&gameOJ.shootSkill()),
gameOJ.player&&gameOJ.moveCamera(gameOJ.player.tankPoint.x,gameOJ.player.tankPoint.y),
null!==gameOJ.player&&gameOJ.moveTurret()}
0!==gameOJ.gameEnd.endCode&&(gameOJ.createFinishMenu(gameOJ.gameEnd),
gameOJ.gameEnd.endCode>2&&gameOJ.stopAllPlayer(),gameOJ.gameEnd.endCode=0,gameOJ.gameEnd.point=0,
gameOJ.gameEnd.lastEnemy="",gameOJ.gameTime=0,gameOJ.skillValue.k1.countdown=0)},
updateData:function(e){if(2===gameOJ.gameTT&&gameOJ.gameNN>0&&null!==gameOJ.currentMap){
var t=Date.now();if(null!==e.Y){for(var a=0;a<e.Y.length;a++){update_player=e.Y[a]
;var i=gameOJ.findPlayer(update_player.p);if(-1===i){
gameOJ.addPlayer(update_player.x,update_player.y,update_player.p)
;let e=gameOJ.playerList[gameOJ.playerList.length-1];e.removed=t,e.moveSpeed=update_player.s,
e.updateVisible(!0),i=gameOJ.playerList.length-1}else{var n=gameOJ.playerList[i]
;n.updateVisible(!0)&&n.tankVisible&&(n.changePosition(update_player.x,update_player.y),
n.showTank()),n.addNewPosition(update_player.x,update_player.y,update_player.m),
n.moveTurret(update_player.g),n.updateEffects(update_player.e),n.lastShootTime=update_player.reload,
n.tankHP=update_player.t,n.moveSpeed=update_player.s,n.removed=t}
null===gameOJ.player&&Boolean(gameOJ.playerID)&&gameOJ.playerList[i].playerID===gameOJ.playerID&&(gameOJ.player=gameOJ.playerList[i],
gameOJ.player.tankHpBar.getChildAt(2).sourceRect.y-=10,
gameOJ.player.tankReloadBar.getChildAt(0).sourceRect.y=40,
gameOJ.player.tankReloadBar.getChildAt(1).sourceRect.y=50,
gameOJ.stage2.removeChildAt(gameOJ.stage2.numChildren-1),gameOJ.createInGameMenu(),
gameOJ.buildTimeText())}
null!==gameOJ.userNameUpdateList&&(gameOJ.userNameUpdateList=gameOJ.updateUsername(gameOJ.userNameUpdateList)),
null!==gameOJ.dataTeam&&(gameOJ.updateTeam(gameOJ.dataTeam),gameOJ.dataTeam=null),
null!==gameOJ.tankStyleUpdateList&&(gameOJ.tankStyleUpdateList=gameOJ.updateNewTankStyle(gameOJ.tankStyleUpdateList)),
gameOJ.scoreList.updated&&(gameOJ.scoreList.updated=gameOJ.updateScoreListNick(),
gameOJ.scoreList.redraw=!0)}if(null!==e.E)for(a=0;a<e.E.length;a++){var s;update_enemy=e.E[a]
;var r=gameOJ.findEnemy(update_enemy.p);if(-1===r){
gameOJ.addEnemy(update_enemy.x,update_enemy.y,update_enemy.p,update_enemy.style)
;let e=gameOJ.enemyList[gameOJ.enemyList.length-1];e.removed=t,e.moveSpeed=update_enemy.s,
e.tankHP=update_enemy.t,
e.updateVisible(!0),update_enemy.team===gameOJ.playerTeam?(e.team=update_enemy.team,
e.tankHpBar.getChildAt(2).sourceRect.y=80,e.tankReloadBar.getChildAt(0).sourceRect.y=40,
e.tankReloadBar.getChildAt(1).sourceRect.y=50):e.team=update_enemy.team,s=e
}else s=gameOJ.enemyList[r],
s.updateVisible(!0)&&s.tankVisible&&(s.changePosition(update_enemy.x,update_enemy.y),s.showTank())
;s.addNewPosition(update_enemy.x,update_enemy.y,update_enemy.m),s.moveTurret(update_enemy.g),
s.updateEffects(update_enemy.e),
s.lastShootTime=update_enemy.reload,s.countdown=update_enemy.reload>s.countdown?update_enemy.reload:s.countdown,
s.tankMaxHP=update_enemy.t>s.tankMaxHP?update_enemy.t:s.tankMaxHP,s.tankHP=update_enemy.t,
s.moveSpeed=update_enemy.s,s.removed=t}if(null!==e.HE)for(a=0;a<e.HE.length;a++){
r=gameOJ.findEnemy(e.HE[a]);-1!==r&&(gameOJ.enemyList[r].removed=0)}
if(null!==e.B)for(a=0;a<e.B.length;a++){var o=e.B[a],m=gameOJ.findBullet(o.i);if(-1===m){
var l=gameOJ.player||{tankPoint:{x:0,y:0}};if(gameOJ.addBullet(o.x,o.y,o.r,o.p,o.i,o.s),
gameOJ.bulletList[gameOJ.bulletList.length-1].removed=t,
gameOJ.playSound(gameOJ.bulletInfor[o.s].sound,Math.abs(l.tankPoint.x-o.x),Math.abs((l.tankPoint.y||0)-o.y)),
gameOJ.addEffect(o.x,o.y,o.r+90,"17"),o.n&&"3_1"!=o.s){if("e"!==o.p.charAt(o.p.length-1)){
i=gameOJ.findPlayer(o.p);var g=gameOJ.playerList}else i=gameOJ.findEnemy(o.p),g=gameOJ.enemyList
;if(-1!==i){let e=g[i];e.tankTurretSprite.gotoAndPlay(e.objectType+e.tankStyle+"s")}}
}else gameOJ.bulletList[m].removed=t}if(null!==e.H)for(a=0;a<e.H.length;a++){
i=gameOJ.findPlayer(e.H[a]);-1!==i&&gameOJ.playerList[i].updateVisible(!1)}
Boolean(e.e)&&gameOJ.applyEffect(e.e),null!==gameOJ.dataDead&&(gameOJ.updateDead(gameOJ.dataDead),
gameOJ.dataDead=null),gameOJ.pingtime=t,gameOJ.moveTankData.Y=null,gameOJ.moveTankData.B=null,
gameOJ.moveTankData.H=null,gameOJ.moveTankData.E=null,gameOJ.moveTankData.HE=null}},
applyEffect:function(e,t=!0){if(2===gameOJ.gameTT&&null!==gameOJ.currentMap){
var a,i=e.split(";"),n=0;for(i.length--;Boolean(a=i[n]);){let e=a.split(",")
;"I"===e[0]?gameOJ.addItem(parseInt(e[1]),parseInt(e[2]),parseInt(e[3]),e[4]):"RI"===e[0]?gameOJ.removeItem(e[1]):"E"===e[0]&&t?gameOJ.addEffect(parseInt(e[1]),parseInt(e[2]),parseInt(e[3]),e[4]):"E"!==e[0]&&gameOJ.changeMapCanvas("map"+e[0]+"Layer",parseInt(e[1]),parseInt(e[2]),parseInt(e[3]),parseInt(e[4])),
n++}}},saveTankData:function(e){gameOJ.moveTankData.Y=e,gameOJ.updateData(gameOJ.moveTankData)},
saveBulletData:function(e){gameOJ.moveTankData.B=e,gameOJ.updateData(gameOJ.moveTankData)},
saveEnemyData:function(e){gameOJ.moveTankData.E=e,gameOJ.updateData(gameOJ.moveTankData)},
saveHideTankData:function(e){gameOJ.moveTankData.H=e,gameOJ.updateData(gameOJ.moveTankData)},
saveHideEnemyData:function(e){gameOJ.moveTankData.HE=e,gameOJ.updateData(gameOJ.moveTankData)},
saveUpdateUserName:function(e){2===gameOJ.gameTT&&(gameOJ.userNameUpdateList=e)},
saveUpdateTankStyle:function(e){2===gameOJ.gameTT&&(gameOJ.tankStyleUpdateList=e)},
savePlayerID:function(e){2===gameOJ.gameTT&&(gameOJ.playerID=e)},saveDataTeam:function(e){
gameOJ.dataTeam=e},saveDeadData:function(e){gameOJ.dataDead=e},saveDetroyedBullet:function(e){
for(var t=0;t<e.length;t++){var a=gameOJ.findBullet(e[t]);-1!==a&&(gameOJ.bulletList[a].removed=0)}
},saveLogoutPlayer:function(e){for(var t=0;t<e.length;t++){var a=gameOJ.findPlayer(e[t])
;-1!==a&&(gameOJ.playerList[a].removed=0)}},updateTeam:function(e){e=e.split("|"),e.length--
;for(var t=0;t<e.length;t++){var a=e[t].split(" "),i=gameOJ.findPlayer(a[0]);if(-1!==i){
let e=gameOJ.playerList[i];a[1]===gameOJ.playerTeam&&e!==gameOJ.player?(e.team=a[1],
e.tankHpBar.getChildAt(2).sourceRect.y=80,e.tankReloadBar.getChildAt(0).sourceRect.y=40,
e.tankReloadBar.getChildAt(1).sourceRect.y=50):e.team=a[1]}}},updateDead:function(e){
for(var t=0;t<e.length;t++){var a=e[t],i=gameOJ.findPlayer(a.playerId);if(-1!==i){
let e=gameOJ.playerList[i];e.updateVisible(!1),e.movePointList=[],e.targetMove={baseRotaion:null,
tankPosition:null,turretRotation:null
},gameOJ.addEffect(e.tankPoint.x,e.tankPoint.y,e.tankBaseSprite.rotation,"2"),
e===gameOJ.player&&(gameOJ.player.comboKill=0,
gameOJ.stage2.getChildAt(gameOJ.staticValues.alertLayerNumer).getChildAt(2).countdown=parseInt(a.time))
}}},updateStatus:function(e){
2===gameOJ.gameTT&&(gameOJ.gameEnd.endCode=e.r,gameOJ.gameEnd.point=e.p,
gameOJ.gameEnd.lastEnemy=e.rs)},updateSkillIcon:function(e){
gameOJ.stage2.getChildAt(gameOJ.staticValues.alertLayerNumer).getChildAt(1).getChildAt(1).gotoAndStop("skill"+e)
},updateSkill:function(e){for(var t=e.split("|"),a=0;a<t.length;a++){if(""===t[a])return
;var i=t[a].split(" ");i[0];gameOJ.updateSkillCountdown(i[1])}},updateDeadCountdown:function(e){
if(0===gameOJ.gameTime)return
;var t=gameOJ.stage2.getChildAt(gameOJ.staticValues.alertLayerNumer).getChildAt(2)
;if(t.countdown-=e,t.countdown<0)return t.countdown=0,void(t.visible=!1);t.visible=!0
;let a=~~(t.countdown/1e3)+"",i=Math.max(t.numChildren,a.length)
;for(var n=0;n<i;n++)if(n<t.numChildren&&n<a.length)t.getChildAt(n).gotoAndStop("c"+a.charAt(n));else if(n>=t.numChildren){
let e=new createjs.Sprite(gameOJ.SpriteSheetList.font,"c"+a.charAt(n));t.addChild(e)
}else n>=a.length&&t.removeChildAt(n)},updateSkillCountdown:function(e){if(0!==gameOJ.gameTime){
e<=0&&(e=0),gameOJ.skillValue.k1.countdown=e
;var t=~~(parseInt(e)/1e3)+"",a=gameOJ.stage2.getChildAt(gameOJ.staticValues.alertLayerNumer).getChildAt(1).getChildAt(2),i=Math.max(t.length,a.numChildren)
;a.visible=e>0
;for(var n=0;n<i;n++)if(n<a.numChildren)a.getChildAt(n).gotoAndStop("c"+t.charAt(n));else if(n>=a.numChildren){
let e=new createjs.Sprite(gameOJ.SpriteSheetList.font);e.gotoAndStop("c"+t.charAt(n)),e.x=10*n,
a.addChild(e)}else n>=t.length&&a.removeChildAt(n)}},saveScore:function(e){
if(2===gameOJ.gameTT)for(var t,a=0;t=e[a];){
var i=gameOJ.scoreList.value.findIndex(e=>e.playerID===t.playerID)
;for(-1!==i?(gameOJ.scoreList.value[i].point=t.point,gameOJ.scoreList.value[i].dead=t.d,
gameOJ.scoreList.updated=!0,gameOJ.scoreList.redraw=!0):(gameOJ.scoreList.value.push({
playerID:t.playerID,point:t.point,dead:t.d,nick:"@",team:""}),gameOJ.scoreList.updated=!0,
i=gameOJ.scoreList.value.length-1);i>0&&gameOJ.scoreList.value[i-1].point<t.point;){
let e=gameOJ.scoreList.value[i-1];gameOJ.scoreList.value[i-1]=gameOJ.scoreList.value[i],
gameOJ.scoreList.value[i]=e,i-=1}a++}},updateUsername:function(e){if(2===gameOJ.gameTT){
for(var t=[],a=0;a<e.length;a++){var i=e[a],n=gameOJ.findPlayer(i.playerID)
;-1!==n?gameOJ.playerList[n].updateNickName(i.playerName):t.push(i)}return t.length>0?t:null}
return null},updateNewTankStyle:function(e){if(2===gameOJ.gameTT){for(var t=[],a=0;a<e.length;a++){
var i=e[a],n=gameOJ.findPlayer(i.p);if(-1!==n){var s=gameOJ.playerList[n];s.updateTankStyle(i.s),
gameOJ.player===s&&(s.setTankAim(s.tankStyle),gameOJ.updateSkillIcon(s.tankStyle+"_1"))
}else t.push(i)}return t.length>0?t:null}return null},getAndBuildMap:function(e){
2===gameOJ.gameTT&&gameOJ.createMap(e.mapName)},joinGame:function(e){
gameOJ.Socket.emit("join-game",{userName:e,tankStyle:""+gameOJ.pickedTank})},movePlayer:function(e){
null!==gameOJ.player&&gameOJ.Socket.emit(gameOJ.socketName.moveTank,e)},moveTurret:function(){
gameOJ.gameNN},shootBullet:function(){if(null!==gameOJ.player){var e=gameOJ.player.shoot()
;gameOJ.Socket.emit(gameOJ.socketName.shootBullet,Math.round(e))}},shootSkill:function(){
null!==gameOJ.player&&(gameOJ.Socket.emit(gameOJ.socketName.shootSkill,{
t:gameOJ.playerControl.spaceSkill.t,r:Math.round(gameOJ.playerControl.spaceSkill.r),
p:gameOJ.playerControl.spaceSkill.p}),gameOJ.playerControl.spaceSkill.a=0)},leaveMatch:function(){
gameOJ.Socket.emit("leave-match","ok")},createControl:function(){
gameOJ.playerControl=new gameOJ.GameControl}};(function(){function e(e,t,a,i="@",n="tank"){
this.tankMaxHP=500,this.countdown=300,this.timeNowServer=0,this.nextBullet="1",this.tankRSize=15,
this.killPoint=0,this.comboKill=0,this.lastShootTime=0,this.tankPoint=new KhoiTest._Point(e,t),
this.tankVisible=!0,this.gunAngle=0,this.tankHP=500,this.moveSpeed=1.5,this.playerName=i,
this.tankStyle="1",this.playerID=a,this.removed=1,this.movePointList=[],this.team="",
this.objectType=n,this.targetMove={baseRotaion:null,tankPosition:null,turretRotation:null},
this.tankAimSprite=new createjs.Shape,this.tankEffectSprite=new createjs.Container,
this.tankNickSprite=new createjs.Text(this.playerName,"15px Arial","#FFFFFF"),
this.tankBaseSprite=new createjs.Sprite(gameOJ.SpriteSheetList.TankBase,"tank"+this.tankStyle),
this.tankTurretSprite=new createjs.Sprite(gameOJ.SpriteSheetList.TankTurret,"tank"+this.tankStyle),
this.tankHpBar=new createjs.Container,this.tankReloadBar=new createjs.Container,
this.tankGraphic=new createjs.Container,
this.tankGraphic.addChild(this.tankBaseSprite,this.tankTurretSprite,this.tankAimSprite,this.tankEffectSprite,this.tankNickSprite,this.tankHpBar,this.tankReloadBar),
this.tankBaseSprite.regX=this.tankBaseSprite.regY=16,
this.tankTurretSprite.regX=this.tankTurretSprite.regY=16
;var s=Math.min(8*this.playerName.length,100)
;this.tankNickSprite.regX=s/2,this.tankNickSprite.regY=60,this.tankNickSprite.cache(0,0,s,15)
;var r=new createjs.Bitmap(gameOJ.loadMC.getAsset("hpbar")),o=new createjs.Bitmap(gameOJ.loadMC.getAsset("hpbar")),m=new createjs.Bitmap(gameOJ.loadMC.getAsset("hpbar"))
;o.x=1,
m.x=1,r.sourceRect=new createjs.Rectangle(0,0,30,10),o.sourceRect=new createjs.Rectangle(0,30,30,10),
m.sourceRect=new createjs.Rectangle(0,10,30,10),
this.tankHpBar.addChild(r,m,o),this.tankHpBar.regX=15,this.tankHpBar.regY=30
;var l=new createjs.Bitmap(gameOJ.loadMC.getAsset("hpbar")),g=new createjs.Bitmap(gameOJ.loadMC.getAsset("hpbar"))
;g.x=1,
l.sourceRect=new createjs.Rectangle(0,60,30,10),g.sourceRect=new createjs.Rectangle(0,70,30,10),
this.tankReloadBar.addChild(l,g),this.tankReloadBar.regX=15,this.tankReloadBar.regY=5,
this.tankReloadBar.y=-31,this.tankReloadBar.visible=!1,this.tankAimSprite.visible=!1
;let c=new createjs.Sprite(gameOJ.SpriteSheetList.effect_p,"effect1");c.visible=!1,c.regX=c.regY=25,
c.effectType=1;let h=new createjs.Sprite(gameOJ.SpriteSheetList.effect_p,"effect2");h.visible=!1,
h.regX=h.regY=25,h.alpha=.5,h.effectType=2;let d=new createjs.Container;d.visible=!1,d.effectType=3
;let u=new createjs.Sprite(gameOJ.SpriteSheetList.effect_p,"effect3");u.visible=!1,u.regX=u.regY=25,
u.effectType=4;let p=new createjs.Sprite(gameOJ.SpriteSheetList.effect_p,"effect4");p.visible=!1,
p.regX=p.regY=25,p.alpha=.5,p.effectType=5;let O=new createjs.Container;O.visible=!1,O.effectType=6
;let J=new createjs.Sprite(gameOJ.SpriteSheetList.effect_p,"effect5");J.visible=!1,J.regX=J.regY=25,
J.alpha=.5,J.effectType=7;let f=new createjs.Sprite(gameOJ.SpriteSheetList.effect_p,"effect6")
;f.visible=!1,f.regX=f.regY=25,f.alpha=1,f.effectType=8;let y=new createjs.Container;y.effectType=9
;let k=new createjs.Sprite(gameOJ.SpriteSheetList.effect_p,"effect10");k.visible=!1,
k.regX=k.regY=25,
k.alpha=.5,k.effectType=10,this.effectSpriteStore=[],this.effectSpriteStore.push(c,h,d,u,p,O,J,f,y,k),
this.changePosition(e,t,s,15),this.changeTurretRotation(this.gunAngle)}var t=e.prototype
;t.moveTo=function(e,t,a,i=-1){var n=new KhoiTest._Point(e,t)
;if(i<0)var s=Math.max(this.moveSpeed,this.tankPoint.lengP(n)/5);else s=i
;var r=this.tankPoint.angleP(n);this.updateHistoryMove(a),this.targetMove.tankPosition={
targetPoint:n,stepValue:s,angle:r}},t.updateEffects=function(e){for(var t=[],a=0;a<e.length;a++){
var i=e[a],n=this.effectSpriteStore[i-1];t[i]=!0,6===i&&(this.tankGraphic.alpha=.6),
n.visible||(this.tankEffectSprite.addChild(n),
n.visible=!0,Boolean(gameOJ.Sound["peffect"+i])&&gameOJ.playSound("peffect"+ +i,Math.abs(this.tankPoint.x-gameOJ.player.tankPoint.x),Math.abs(this.tankPoint.y-gameOJ.player.tankPoint.y)))
}for(var s=0;s<this.tankEffectSprite.numChildren;s++){var r=this.tankEffectSprite.getChildAt(s)
;Boolean(t[r.effectType])||(r.visible=!1,6===r.effectType&&(this.tankGraphic.alpha=1),
this.tankEffectSprite.removeChildAt(s),s--)}},t.updateVisible=function(e){
if(e===this.tankVisible)return!1;if(this.tankVisible=e,!e){var t={x:0,y:0}
;0===this.movePointList.length?(t.x=this.tankPoint.x+1,
t.y=this.tankPoint.y+1):(t.x=this.movePointList[this.movePointList.length-1].x,
t.y=this.movePointList[this.movePointList.length-1].y),this.hideTank()}return!0},
t.updateKillPoint=function(e){var t=this,a=e-this.killPoint;this.killPoint=e,this.comboKill+=a,
a>0&&gameOJ.displayKillIcon(t.comboKill)},t.showTank=function(){this.tankGraphic.visible=!0},
t.hideTank=function(){this.tankGraphic.visible=!1,this.targetMove.tankPosition=null,
this.movePointList.length=0},t.addNewPosition=function(e,t,a){
1===this.movePointList.length&&this.movePointList[0].reuse&&(this.targetMove.tankPosition=null),
this.movePointList.push({x:e,y:t,moveCode:a,reuse:!1})},t.updateNickName=function(e,t=null){
if(this.playerName!==e){null!==t&&(this.tankNickSprite.color=t),this.playerName=e,
this.tankNickSprite.text=e;var a=Math.min(8*e.length,100);this.tankNickSprite.maxWidth=120,
this.tankNickSprite.regX=a/2,this.tankNickSprite.regY=60,this.tankNickSprite.cache(0,0,120,15)}},
t.updateTankStyle=function(e){this.tankStyle=e,this.tankBaseSprite.gotoAndPlay("tank"+e),
this.tankTurretSprite.gotoAndPlay("tank"+e),"1"===e?(this.countdown=750,this.nextBullet="1",
this.tankHP=500-this.tankMaxHP+this.tankHP,
this.tankMaxHP=500,this.tankRSize=15):"2"===e?(this.countdown=1e3,this.nextBullet="2",
this.tankHP=700-this.tankMaxHP+this.tankHP,
this.tankMaxHP=700,this.tankRSize=15):"3"===e&&(this.countdown=1e3,this.nextBullet="3",
this.tankHP=500-this.tankMaxHP+this.tankHP,this.tankMaxHP=500,this.tankRSize=15)},
t.setTankAim=function(e){
"1"===e?(this.tankAimSprite.graphics.beginFill("#2300f5").drawRect(0,0,20,280),
this.tankAimSprite.regY=295,this.tankAimSprite.regX=10,this.tankAimSprite.alpha=.3,
this.tankAimSprite.cache(0,0,20,280)):"2"===e?(this.tankAimSprite.graphics.s("#2300f5").drawCircle(0,0,30),
this.tankAimSprite.regY=0,this.tankAimSprite.regX=0,this.tankAimSprite.alpha=.2,
this.tankAimSprite.cache(-30,-30,60,60)):"3"===e?(this.tankAimSprite.graphics.beginFill("#2300f5").drawRect(0,0,20,280),
this.tankAimSprite.regY=295,this.tankAimSprite.regX=10,this.tankAimSprite.alpha=.3,
this.tankAimSprite.cache(0,0,20,280)):"4"===e&&(this.tankAimSprite.graphics.sd([2,2]).setStrokeStyle(2).beginStroke("red").drawRect(0,0,3,gameOJ.gameW),
this.tankAimSprite.regY=gameOJ.gameW+15,this.tankAimSprite.regX=1,this.tankAimSprite.alpha=.5,
this.tankAimSprite.cache(0,0,3,gameOJ.gameW))},t.applyNewPosition=function(e){var t,a=-1
;if(this.movePointList.length>10&&(this.movePointList=[this.movePointList[this.movePointList.length-1],this.movePointList[this.movePointList.length-2]],
this.changePosition(this.movePointList[0].x,this.movePointList[0].y)),
0!==this.movePointList.length){
if(1===this.movePointList.length&&-1===this.movePointList[0].moveCode)return this.movePointList.shift(),
void(this.targetMove.tankPosition=null);1===this.movePointList.length?(t=this.movePointList[0],
null!==this.targetMove.tankPosition&&(newPoint=this.tankPoint.moveT(66*this.moveSpeed,45*(this.movePointList[0].moveCode-2)),
t.x=newPoint.x,
t.y=newPoint.y,a=this.moveSpeed,t.reuse=!0)):this.movePointList.length>1&&(this.movePointList.shift(),
t=this.movePointList[0]),this.moveTo(t.x,t.y,t.moveCode,a)}else this.targetMove.tankPosition=null},
t.shootFakeBullet=function(e){var t=this.timeNowServer;this.gunAngle=e
;var a=this.tankPoint.moveT(16,e-90);return gameOJ.addBullet(a.x,a.y,e,this.playerID,"1","fake",!0),
gameOJ.bulletList[gameOJ.bulletList.length-1].removed=gameOJ.pingtime,this.lastShootTime=t,!0},
t.changePosition=function(e,t){this.tankPoint.setV(e,t),this.tankGraphic.x=e,this.tankGraphic.y=t},
t.updateBloodBar=function(){
this.tankHpBar.getChildAt(2).sourceRect.x=30-this.tankHP/this.tankMaxHP*30,
this.tankHpBar.getChildAt(1).sourceRect.x<this.tankHpBar.getChildAt(2).sourceRect.x?this.tankHpBar.getChildAt(1).sourceRect.x+=1:this.tankHpBar.getChildAt(1).sourceRect.x=this.tankHpBar.getChildAt(2).sourceRect.x
},t.moveTurret=function(e){var t=e,a=this.tankTurretSprite.rotation,i=1
;if(Math.abs(a-t)<1e-4)this.tankTurretSprite.rotation=t;else{if(a<180)var n=a+180,s=a,r=1;else n=a,
s=a-180,r=-1
;t>=s&&t<n?i*=r:i=-i*r,i*=i>0&&t<a?Math.abs(360-a+t)/5:i<0&&t>a?Math.abs(360-t+a)/5:Math.abs(a-t)/5,
this.targetMove.turretRotation={value:t,stepValue:i}}},t.changeTurretRotation=function(e){
e<0&&(e+=360),this.gunAngle=e,this.tankTurretSprite.rotation=e},t.updateHistoryMove=function(e){
if(-1!==e&&this.tankBaseSprite.rotation!==45*e){var t=45*e,a=5,i=this.tankBaseSprite.rotation
;if(i<180)var n=i+180,s=i,r=1;else n=i,s=i-180,r=-1
;t>=s&&t<n?a*=r:a=-a*r,this.targetMove.baseRotaion={value:t,stepValue:a}
}else this.targetMove.baseRotaion=null},t.shoot=function(){return this.gunAngle},
t.updateShootTime=function(e){
0!==this.lastShootTime&&(this.lastShootTime-=e,this.tankReloadBar.visible=!0,
this.tankReloadBar.getChildAt(1).sourceRect.width=30*(this.countdown-this.lastShootTime)/this.countdown,
this.lastShootTime<=0&&(this.lastShootTime=0,this.tankReloadBar.visible=!1))},t.Tick=function(e){
if(this.updateBloodBar(),
null!==this.targetMove.baseRotaion&&(this.tankBaseSprite.rotation+=this.targetMove.baseRotaion.stepValue,
this.tankBaseSprite.rotation<0?this.tankBaseSprite.rotation=360+this.tankBaseSprite.rotation:this.tankBaseSprite.rotation>=360&&(this.tankBaseSprite.rotation=this.tankBaseSprite.rotation%360),
Math.abs(this.tankBaseSprite.rotation+this.targetMove.baseRotaion.stepValue-this.targetMove.baseRotaion.value)<Math.abs(this.targetMove.baseRotaion.stepValue)?(this.tankBaseSprite.rotation=this.targetMove.baseRotaion.value,
this.targetMove.baseRotaion=null):this.tankBaseSprite.rotation===this.targetMove.baseRotaion.value&&(this.targetMove.baseRotaion=null)),
null!==this.targetMove.tankPosition){
var t=this.tankPoint.lengP(this.targetMove.tankPosition.targetPoint),a=e<16.7?e/16.7:1;a=1
;if(t>this.targetMove.tankPosition.stepValue*a){
var i=this.tankPoint.moveT(this.targetMove.tankPosition.stepValue*a,this.targetMove.tankPosition.angle)
;this.changePosition(i.x,i.y)
}else this.changePosition(this.targetMove.tankPosition.targetPoint.x,this.targetMove.tankPosition.targetPoint.y),
this.applyNewPosition(t)}else this.applyNewPosition();if(null!==this.targetMove.turretRotation){
var n=this.tankTurretSprite.rotation
;this.changeTurretRotation(this.tankTurretSprite.rotation+this.targetMove.turretRotation.stepValue)
;var s=1
;this.tankTurretSprite.rotation<0?(this.changeTurretRotation(360+this.tankTurretSprite.rotation),
s=-1):this.tankTurretSprite.rotation>=360&&(this.changeTurretRotation(this.tankTurretSprite.rotation%360),
s=-1),
(Math.abs(this.tankTurretSprite.rotation+this.targetMove.turretRotation.stepValue-this.targetMove.turretRotation.value)<Math.abs(this.targetMove.turretRotation.stepValue)||this.tankTurretSprite.rotation===this.targetMove.turretRotation.value||s*(this.tankTurretSprite.rotation-this.targetMove.turretRotation.value)*(n-this.targetMove.turretRotation.value)<0)&&(this.changeTurretRotation(this.targetMove.turretRotation.value),
this.targetMove.turretRotation=null)}this.tankAimSprite.rotation=gameOJ.playerControl.spaceSkill.r},
gameOJ.addCon("Player",e)})(),function(){function e(e,t,a,i="@",n="1"){
gameOJ.Player.call(this,e,t,a,i,"enemy"),this.updateTankStyle(n),this.tankNickSprite.visible=!1,
this.master=""}gameOJ.KetThua(gameOJ.Player,e);var t=e.prototype;t.updateTankStyle=function(e="1"){
this.tankStyle=e,
"1"===e&&(this.countdown=750,this.nextBullet="1",this.tankHP=100-this.tankMaxHP+this.tankHP,
this.tankMaxHP=100,
this.tankRSize=15,this.tankGraphic.removeChildAt(0),this.tankGraphic.removeChildAt(0),
this.tankBaseSprite=new createjs.Sprite(gameOJ.SpriteSheetList.Enemy,"enemy1"),
this.tankTurretSprite=new createjs.Sprite(gameOJ.SpriteSheetList.EnemyTurret,"enemy1"),
this.tankBaseSprite.regX=this.tankBaseSprite.regY=25,
this.tankTurretSprite.regX=this.tankTurretSprite.regY=25,this.tankBaseSprite.gotoAndPlay("tank"+e),
this.tankTurretSprite.gotoAndPlay("tank"+e),this.tankGraphic.addChildAt(this.tankBaseSprite,0),
this.tankGraphic.addChildAt(this.tankTurretSprite,1))},gameOJ.addCon("TowerEnemy",e)}(),function(){
function e(e,t,a,i,n,s,r=!1){this.bulletPoint=new KhoiTest._Point(e,t),this.bulletRotation=a,
this.playerID=i,this.bulletID=n,this.live=1,this.speed=gameOJ.bulletInfor[s].speed,
this.bulletStyle=s,
this.fake=r,this.removed=1,this.bulletSprite=new createjs.Sprite(gameOJ.SpriteSheetList.bullet,s),
this.bulletGraphic=new createjs.Container,this.bulletSprite.regX=25,this.bulletSprite.regY=25,
this.bulletSprite.rotation=this.bulletRotation+90,this.bulletGraphic.addChild(this.bulletSprite),
this.bulletGraphic.x=e,this.bulletGraphic.y=t}var t=e.prototype;t.moveTo=function(e,t){
this.changePosition(e,t)},t.changePosition=function(e,t){this.bulletPoint.setV(e,t),
this.bulletGraphic.x=e,this.bulletGraphic.y=t},t.Tick=function(){if(this.live){
var e=this.bulletPoint.moveT(this.speed,this.bulletRotation);this.changePosition(e.x,e.y)}},
gameOJ.addCon("Bullet",e)}(),function(){function e(e,t,a,i,n){
this.effectPoint=new KhoiTest._Point(e,t),this.effectRotation=a,this.live=100,this.sortID=n,
this.style=i,this.effectSprite=new createjs.Sprite(gameOJ.SpriteSheetList.effect,"effect"+i),
this.effectGraphic=new createjs.Container,this.effectSprite.regX=25,this.effectSprite.regY=25,
this.effectSprite.rotation=this.effectRotation,this.effectGraphic.addChild(this.effectSprite),
this.effectGraphic.x=e,this.effectGraphic.y=t;let s=this;var r
;"5"!==i&&"10"!=this.style&&this.effectSprite.on("animationend",()=>{s.effectGraphic.visible=!1}),
Boolean(r=gameOJ.effectSound["effect"+i])&&gameOJ.playSound(r,Math.abs((Boolean(gameOJ.player)?gameOJ.player.tankPoint.x:0)-e),Math.abs((Boolean(gameOJ.player)?gameOJ.player.tankPoint.y:0)-t))
}var t=e.prototype;t.moveTo=function(e,t){this.changePosition(e,t)},t.changePosition=function(e,t){
this.effectPoint.setV(e,t),this.effectGraphic.x=e,this.effectGraphic.y=t},t.Tick=function(){
this.live&&(this.live--,
"5"!==this.style&&"10"!==this.style&&"3"!==this.style||(this.effectGraphic.alpha-=.01,
this.effectGraphic.scaleX+=.03,this.effectGraphic.scaleY+=.03))},gameOJ.addCon("Effect",e)}(),
function(){function e(){this.moveMap=[],this.moveMap.KeyDKeyW=this.moveMap.KeyWKeyD=1,
this.moveMap.KeyDKeyS=this.moveMap.KeySKeyD=3,this.moveMap.KeyAKeyS=this.moveMap.KeySKeyA=5,
this.moveMap.KeyAKeyW=this.moveMap.KeyWKeyA=7,this.moveMap.KeyW=0,this.moveMap.KeyD=2,
this.moveMap.KeyS=4,
this.moveMap.KeyA=6,this.moveStack=[],this.touchCode=-1,this.fakeMouse=new KhoiTest._Point(0,0),
this.touchShoot=!1,this.touchAim=!1,this.spaceSkill={t:1,r:0,p:"",a:0},this.controlType=null,
this.buildKeyEvent()}var t=e.prototype;t.buildKeyEvent=function(){var e=this
;document.onkeydown=function(t){
if(null===e.controlType&&(e.controlType="key",gameOJ.stage2.getChildAt(gameOJ.staticValues.controlLayerNumber).alpha=0,
gameOJ.stage2.getChildAt(gameOJ.staticValues.controlLayerNumber).hitArea=new createjs.Shape((new createjs.Graphics).beginFill("#ff0000").drawRect(0,0,gameOJ.gameW,gameOJ.gameH)),
gameOJ.stage2.getChildAt(gameOJ.staticValues.controlLayerNumber).on("mousedown",function(){
0===e.spaceSkill.a&&gameOJ.shootBullet()})),!t)t=window.event;if(2===gameOJ.gameTT){
if("KeyS"===t.code||"KeyD"===t.code||"KeyA"===t.code||"KeyW"===t.code){
if(-1!==e.moveStack.indexOf(t.code))return
;e.moveStack.push(t.code),gameOJ.movePlayer(e.buildMoveCode())}
"KeyG"===t.code&&gameOJ.showAndHideBoard(!0),"Space"===t.code&&(e.spaceSkill.a=1,e.touchAim=!0)}},
document.onkeyup=function(t){if(2===gameOJ.gameTT){
if("KeyS"===t.code||"KeyD"===t.code||"KeyA"===t.code||"KeyW"===t.code){
var a=e.moveStack.indexOf(t.code);e.moveStack.splice(a,1),gameOJ.movePlayer(e.buildMoveCode())}
"KeyG"===t.code&&gameOJ.showAndHideBoard(!1),"Space"===t.code&&(e.spaceSkill.a=2,e.touchAim=!1)}}
;var t=new createjs.Shape((new createjs.Graphics).setStrokeStyle(2).beginStroke("#000000").drawCircle(0,0,30)),a=new createjs.Shape((new createjs.Graphics).beginFill("#000000").drawCircle(0,0,10))
;t.x=50,
t.y=gameOJ.gameH-50,t.cache(-35,-35,70,70),t.hitArea=new createjs.Shape((new createjs.Graphics).setStrokeStyle(2).beginStroke("#000000").beginFill("#000000").drawCircle(0,0,30)),
a.x=t.x,a.y=t.y,a.cache(-20,-20,40,40)
;var i=new createjs.Shape((new createjs.Graphics).setStrokeStyle(2).beginStroke("#000000").drawCircle(0,0,30)),n=new createjs.Shape((new createjs.Graphics).beginFill("#000000").drawCircle(0,0,10))
;i.x=gameOJ.gameW-60,
i.y=gameOJ.gameH-60,i.cache(-45,-45,90,90),i.hitArea=new createjs.Shape((new createjs.Graphics).setStrokeStyle(2).beginStroke("#000000").beginFill("#000000").drawCircle(0,0,30)),
n.x=i.x,n.y=i.y,n.cache(-20,-20,40,40)
;var s=new createjs.Shape((new createjs.Graphics).setStrokeStyle(2).beginStroke("#000000").drawCircle(0,0,20)),r=new KhoiTest._Point(i.x,i.y).moveT(60,-80)
;s.x=r.x,
s.y=r.y,s.cache(-45,-45,90,90),s.hitArea=new createjs.Shape((new createjs.Graphics).setStrokeStyle(2).beginStroke("#000000").beginFill("#000000").drawCircle(0,0,20)),
gameOJ.stage2.getChildAt(gameOJ.staticValues.controlLayerNumber).addChild(t,a,i,n,s),
gameOJ.stage2.getChildAt(gameOJ.staticValues.controlLayerNumber).alpha=.5,t.on("pressmove",t=>{
e.touchMoveEvent(t,e)}),t.on("mousedown",t=>{e.touchMoveEvent(t,e)}),t.on("pressup",function(){
a.x=t.x,a.y=t.y,gameOJ.movePlayer(-1),e.touchCode=-1}),i.on("pressmove",t=>{e.touchTurretEvent(t,e)
}),i.on("mousedown",t=>{e.touchTurretEvent(t,e)}),i.on("pressup",function(){n.x=i.x,n.y=i.y,
e.touchShoot=!1,e.touchAim=!1}),s.on("mousedown",t=>{e.touchSkillEvent(t,e,1)}),
s.on("pressmove",t=>{e.touchSkillEvent(t,e,1)}),s.on("pressup",function(){e.spaceSkill.a=2,
e.touchAim=!1})},t.mouseMoveEvent=function(e,t){
var a=gameOJ.stage2.getChildAt(gameOJ.staticValues.mapL1LayerNumber).getChildAt(0).sourceRect,i=e/gameOJ.gameSW+a.x,n=t/gameOJ.gameSH+a.y
;if(null!==gameOJ.player&&gameOJ.gameNN%1==0){
var s=new KhoiTest._Point(i,n),r=gameOJ.player.tankPoint.angleP(s)+90
;1===this.spaceSkill.a?(this.spaceSkill.r=r,
this.spaceSkill.a=1,this.touchAim=!0):gameOJ.player.changeTurretRotation(r)}
},t.fakeMouseMoveEvent=function(e,t){if(null!==gameOJ.player&&this.touchShoot){
var a=new KhoiTest._Point(e,t),i=gameOJ.player.tankPoint.angleP(a)+90
;gameOJ.player.changeTurretRotation(i)}},t.buildMoveCode=function(){
if(1===this.moveStack.length)return this.moveMap[this.moveStack[0]];if(this.moveStack.length>1){
var e=this.moveStack.length,t=this.moveMap[this.moveStack[e-1]+this.moveStack[e-2]]
;return Boolean(t)?t:this.moveMap[this.moveStack[e-1]]}return-1},t.clearMove=function(){
2===gameOJ.gameTT&&(this.moveStack=[],gameOJ.movePlayer(-1))},t.touchMoveEvent=function(e,t){
null===t.controlType&&(t.controlType="touch")
;var a=new KhoiTest._Point(0,0),i=new KhoiTest._Point(0,0),n=gameOJ.stage2.getChildAt(gameOJ.staticValues.controlLayerNumber).getChildAt(0),s=gameOJ.stage2.getChildAt(gameOJ.staticValues.controlLayerNumber).getChildAt(1)
;i.x=e.localX,i.y=e.localY;let r=a.angleP(i),o=a.lengP(i);if(o<=30)s.x=n.x+i.x,s.y=n.y+i.y;else{
let e=new KhoiTest._Point(n.x,n.y).moveT(30,r);s.x=e.x,s.y=e.y}let m=t.findTouchMoveCode(r)
;m!==t.touchCode&&(t.touchCode=m,gameOJ.movePlayer(m))},t.touchTurretEvent=function(e,t){
null===t.controlType&&(t.controlType="touch")
;var a=new KhoiTest._Point(0,0),i=new KhoiTest._Point(0,0),n=gameOJ.stage2.getChildAt(gameOJ.staticValues.controlLayerNumber).getChildAt(2),s=gameOJ.stage2.getChildAt(gameOJ.staticValues.controlLayerNumber).getChildAt(3)
;i.x=e.localX,i.y=e.localY;let r=a.angleP(i),o=a.lengP(i);if(o>30){
let e=new KhoiTest._Point(n.x,n.y).moveT(30,r);s.x=e.x,s.y=e.y}else s.x=n.x+i.x,s.y=n.y+i.y
;t.touchShoot=!0,t.touchAim=!1,this.fakeMouse.x=i.x,this.fakeMouse.y=i.y
},t.touchSkillEvent=function(e,t,a){null===t.controlType&&(t.controlType="touch")
;var i=new KhoiTest._Point(0,0),n=new KhoiTest._Point(0,0);n.x=e.localX,n.y=e.localY
;let s=i.angleP(n);i.lengP(n);1===a&&(t.spaceSkill.r=s+90,t.spaceSkill.a=1,t.touchAim=!0)},
t.findTouchMoveCode=function(e){
return e>=-112.5&&e<-67.5?0:e>=-67.5&&e<-22.5?1:e>=-22.5&&e<22.5?2:e>=22.5&&e<67.5?3:e>=67.5&&e<112.5?4:e>=112.5&&e<157.5?5:e>=157.5||e<-157.5?6:e>=-157.5&&e<-112.5?7:void 0
},gameOJ.addCon("GameControl",e)}();