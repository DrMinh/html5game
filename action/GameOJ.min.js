var gameOJ={stage:null,stage1:null,stage2:null,loadMC:null,asset:null,Socket:null,gameW:0,gameH:0,
gameSW:0,gameSH:0,gameTT:0,gameNN:0,Sound:[],SoundMark:[],bulletList:[],playerList:[],enemyList:[],
effectList:[],scoreList:{value:[],updated:!1,redraw:!1,teamPoint:[]},schema:[],slotInfor:null,
currentMap:null,currentTheme:null,player:null,SpriteSheetList:[],AniL1NameList:[],
playerControl:null,pingtime:0,userNameInput:null,pickedTank:1,playerID:null,playerTeam:null,
dataTeam:null,teamSort:[],dataDead:null,userNameUpdateList:null,tankStyleUpdateList:null,
moveTankData:{Y:null,B:null,E:null,H:null,HE:null},gameTime:0,gameEnd:{endCode:0,winTeam:null,
reward:null,isEnd:!1},canvasOfLayer:{mapL1Layer:null,mapL1_5Layer:null,mapL2Layer:null},
staticValues:{mapL1LayerNumber:0,aniL1LayerNumber:1,mapL1_5LayerNumber:2,mapItemLayerNumber:3,
tankLayerNumber:4,enemyLayerNumber:5,bulletLayerNumber:6,mapL2LayerNumber:7,effectLayerNumber:8,
scoreLayerNumber:9,controlLayerNumber:10,alertLayerNumer:11},socketName:{},gameSetting:{
allowSound:1,fullScreen:0},bulletInfor:{tank1:{speed:6,dame:50,effect:[1],sound:"shoot1"},tank2:{
speed:5,dame:50,effect:[11],sound:"shoot2"},tank3:{speed:5,dame:80,effect:[9,10],sound:"shoot3"},
tank1_1:{speed:5,dame:150,effect:[15],sound:"skill1_1"},tank3_1:{speed:5,dame:50,effect:[16],
sound:"shoot3"},enemy1:{size:10,speed:3,dame:180,effect:[18],sound:"shoote1"}},skillData:{tank1_1:{
countdown_default:5e3,type:1,sprite:"skill1_1"},tank2_1:{countdown_default:1e4,type:3,
sprite:"skill2_1"},tank3_1:{countdown_default:5e3,type:1,sprite:"skill3_1"}},skillValue:{k1:{
countdown:0}},effectSound:{effect2:"effect2",effect13:"effect3",effect14:"effect3",
effect7:"effect4",effectitem:"effectitem"},unknownData:{scoreListValue:[]},addCon:function(e,t){
var a=this;a[e]=t},KetThua:function(e,t){t.prototype=Object.create(e.prototype),
t.prototype.constructor=t},setval:function(){gameOJ.Socket=io("//tanknode.herokuapp.com",{
parser:customParser}),gameOJ.buildSchema(),gameOJ.Socket.on(gameOJ.socketName.tank,function(e){
gameOJ.saveTankData(e)}),gameOJ.Socket.on(gameOJ.socketName.bullet,function(e){
gameOJ.saveBulletData(e)}),gameOJ.Socket.on(gameOJ.socketName.enemy,function(e){
gameOJ.saveEnemyData(e)}),gameOJ.Socket.on(gameOJ.socketName.hideTank,function(e){
gameOJ.saveHideTankData(e)}),gameOJ.Socket.on(gameOJ.socketName.hideEnemy,function(e){
gameOJ.saveHideEnemyData(e)}),gameOJ.Socket.on(gameOJ.socketName.updateEffect,function(e){
gameOJ.applyEffect(e)}),gameOJ.Socket.on("map_infor",function(e){gameOJ.getAndBuildMap(e)}),
gameOJ.Socket.on(gameOJ.socketName.rebuildEffect,function(e){""!==e.length&&gameOJ.applyEffect(e,!1)
}),gameOJ.Socket.on(gameOJ.socketName.updateUserName,function(e){gameOJ.saveUpdateUserName(e)}),
gameOJ.Socket.on(gameOJ.socketName.updateTankStyle,function(e){gameOJ.saveUpdateTankStyle(e)}),
gameOJ.Socket.on(gameOJ.socketName.updatePlayer,function(e){gameOJ.savePlayerID(e.playerID),
gameOJ.gameTime=e.currentTime,gameOJ.playerTeam=e.playerTeam
}),gameOJ.Socket.on(gameOJ.socketName.updateScore,function(e){gameOJ.saveScore(e)}),
gameOJ.Socket.on(gameOJ.socketName.updateStatus,function(e){gameOJ.updateStatus(e)}),
gameOJ.Socket.on(gameOJ.socketName.updateSkill,function(e){gameOJ.updateSkill(e)}),
gameOJ.Socket.on(gameOJ.socketName.updateSlot,function(e){gameOJ.updateSlot(e)}),
gameOJ.Socket.on(gameOJ.socketName.updateTeam,function(e){gameOJ.saveDataTeam(e)}),
gameOJ.Socket.on(gameOJ.socketName.updateDead,function(e){gameOJ.saveDeadData(e)}),
gameOJ.Socket.on(gameOJ.socketName.deadBullet,function(e){gameOJ.saveDetroyedBullet(e)}),
gameOJ.Socket.on("rp",function(e){gameOJ.saveLogoutPlayer(e)
}),gameOJ.userNameInput=document.getElementById("inputArea"),
gameOJ.userNameInput.addEventListener("submit",e=>{
var t=document.getElementById("userJoinGameName").value
;if(!gameOJ.checkUserName(t))return document.getElementById("namerule").style.display="block",
void e.preventDefault()
;if(gameOJ.userNameInput.style.display="none",document.getElementById("namerule").style.display="none",
0!==gameOJ.stage1.numChildren){let e=gameOJ.stage1.getChildAt(gameOJ.stage1.numChildren-2)
;e.getChildAt(e.numChildren-1).text=t,e.cache(0,0,200,30)}e.preventDefault()}),gameOJ.gameH=300,
gameOJ.gameW=500,gameOJ.gameSH=1,gameOJ.gameSW=1,gameOJ.stage=new createjs.StageGL("demoCanvas"),
gameOJ.stage1=new createjs.Container,
gameOJ.stage2=new createjs.Container,gameOJ.stage3=new createjs.Container,gameOJ.stage3.visible=!1,
gameOJ.stage.addChild(gameOJ.stage1,gameOJ.stage2,gameOJ.stage3),gameOJ.asset=[{
src:"./asset/font_background.png",id:"font_background"},{src:"./asset/font_border.png",
id:"font_border"},{src:"./asset/resize.jpg",id:"resize"},{src:"./asset/bullet_1.png",id:"bullet"},{
src:"./asset/tankBase.png",id:"tankBase"},{src:"./asset/tankBigSize.png",id:"tankBigSize"},{
src:"./asset/tankTurret.png",id:"tankTurret"},{src:"./asset/enemy.png",id:"enemy"},{
src:"./asset/enemy_turret.png",id:"enemyTurret"},{src:"./asset/effect.png",id:"effect"},{
src:"./asset/map_1.png",id:"map_1"},{src:"./asset/hpbar.png",id:"hpbar"},{
src:"./asset/menuimage_r.png",id:"menuImage"},{src:"./asset/UIList.png",id:"uiList"},{
src:"./asset/effect_p.png",id:"effect_p"},{src:"./asset/dropItem.png",id:"dropItem"},{
src:"./asset/icon.png",id:"icon"},{src:"./asset/skill.png",id:"skill"},{src:"./asset/logo.png",
id:"logo"},{src:"./static/itemmap.json",id:"itemmap"},{src:"./static/reward.json",id:"reward"},{
src:"./static/fontcolor.json",id:"fontcolor"},{src:"./map/map3.json",id:"map3"},{
src:"./sound/theme1.ogg",id:"theme1"},{src:"./sound/shoot1.ogg",id:"shoot1"},{
src:"./sound/shoot2.ogg",id:"shoot2"},{src:"./sound/shoot3.ogg",id:"shoot3"},{
src:"./sound/skill1_1.ogg",id:"skill1_1"},{src:"./sound/shoote1.ogg",id:"shoote1"},{
src:"./sound/item.ogg",id:"effectitem"},{src:"./sound/effect2.ogg",id:"effect2"},{
src:"./sound/effect3.ogg",id:"effect3"},{src:"./sound/effect4.ogg",id:"effect4"},{
src:"./sound/win1.ogg",id:"win1"},{src:"./sound/ticking.ogg",id:"ticking"},{src:"./sound/bell.ogg",
id:"bell"},{src:"./sound/s1.ogg",id:"s1"},{src:"./sound/kill.ogg",id:"kill"},{
src:"./sound/peffect1.ogg",id:"peffect1"},{src:"./sound/peffect7.ogg",id:"peffect7"}],
gameOJ.loadMC=new LoadMi(gameOJ),createjs.Ticker.addEventListener("tick",gameOJ.tick),
createjs.Ticker.timingMode=createjs.Ticker.RAF,
createjs.Ticker.framerate=60,gameOJ.stage.enableMouseOver(20),gameOJ.stage.mouseEnabled=!0,
createjs.Touch.enable(gameOJ.stage),gameOJ.stage.snapToPixelEnabled=!0,this.AddSound(),
gameOJ.FixCanvas(),window.addEventListener("resize",gameOJ.FixCanvas)},AddSound:function(){
this.Sound.shoot1=new Howl({src:["sound/shoot1.ogg"],autoplay:!1,loop:!1,volume:.2}),
this.SoundMark.shoot1=-1,this.Sound.shoot2=new Howl({src:["sound/shoot2.ogg"],autoplay:!1,loop:!1,
volume:.2}),this.SoundMark.shoot2=-1,this.Sound.shoot3=new Howl({src:["sound/shoot3.ogg"],
autoplay:!1,loop:!1,volume:.2}),this.SoundMark.shoot3=-1,this.Sound.skill1_1=new Howl({
src:["sound/skill1_1.ogg"],autoplay:!1,loop:!1,volume:.2}),this.SoundMark.shoot3=-1,
this.Sound.shoote1=new Howl({src:["sound/shoote1.ogg"],autoplay:!1,loop:!1,volume:.2}),
this.SoundMark.shoote1=-1,this.Sound.effect2=new Howl({src:["sound/effect2.ogg"],autoplay:!1,
loop:!1,volume:.2}),this.SoundMark.effect2=-1,this.Sound.effect3=new Howl({
src:["sound/effect3.ogg"],autoplay:!1,loop:!1,volume:.2}),this.SoundMark.effect3=-1,
this.Sound.effect4=new Howl({src:["sound/effect4.ogg"],autoplay:!1,loop:!1,volume:.2}),
this.SoundMark.effect4=-1,this.Sound.effectitem=new Howl({src:["sound/item.ogg"],autoplay:!1,
loop:!1,volume:.2}),this.SoundMark.effectitem=-1,this.Sound.peffect1=new Howl({
src:["sound/peffect1.ogg"],autoplay:!1,loop:!1,volume:.2}),this.SoundMark.peffect1=-1,
this.Sound.peffect7=new Howl({src:["sound/peffect7.ogg"],autoplay:!1,loop:!1,volume:.2}),
this.SoundMark.peffect7=-1,this.Sound.win1=new Howl({src:["sound/win1.ogg"],autoplay:!1,loop:!1,
volume:.2}),this.SoundMark.win1=-1,this.Sound.bell=new Howl({src:["sound/bell.ogg"],autoplay:!1,
loop:!1,volume:.2}),this.SoundMark.bell=-1,this.Sound.s1=new Howl({src:["sound/s1.ogg"],autoplay:!1,
loop:!1,volume:.2}),this.SoundMark.s1=-1,this.Sound.kill=new Howl({src:["sound/kill.ogg"],
autoplay:!1,loop:!1,volume:.2}),this.SoundMark.kill=-1,this.Sound.ticking=new Howl({
src:["sound/ticking.ogg"],autoplay:!1,loop:!1,volume:.2}),this.SoundMark.ticking=-1,
this.Sound.theme1=new Howl({src:["sound/theme1.ogg"],autoplay:!1,loop:!0,volume:.2}),
this.SoundMark.theme1=-1},playSound:function(e,t,a,i=0){if(i){if(gameOJ.SoundMark[e]===i)return
;gameOJ.SoundMark[e]=i}let n=1,l=Math.max(a,t);n=1-.1*~~(l/50),n<=0||(gameOJ.Sound[e].volume(n),
gameOJ.Sound[e].play())},openFullscreen:function(){if(!document.fullscreenElement){
gameOJ.gameSetting.fullScreen=1;var e=gameOJ.stage.canvas
;e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen()
}},exitFullscreen:function(){document.fullscreenElement&&(gameOJ.gameSetting.fullScreen=0,
document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen())
},changeSoundGame:function(e){gameOJ.gameSetting.allowSound=e,Howler.volume(e)},
buildSchema:function(e=customParser.PacketBuilder){var t=0;gameOJ.socketName.moveTank=++t,
e.build(t,"int8"),
gameOJ.socketName.shootBullet=++t,e.build(t,"float32"),gameOJ.socketName.shootSkill=++t,e.build(t,{
t:"uint8",r:"float32",p:"string"}),gameOJ.socketName.buildItem=++t,e.build(t,["uint8"]),
gameOJ.socketName.tank=++t,e.build(t,[{p:"string",x:"int16",y:"int16",g:"float32",m:"int16",
t:"int16",e:["uint8"],s:"float32",reload:"uint16",moveAngle:"float32"
}]),gameOJ.socketName.bullet=++t,e.build(t,[{i:"string",p:"string",x:"int16",y:"int16",r:"float32",
n:"int8",s:"string"
}]),gameOJ.socketName.updateEffect=++t,e.build(t,"string"),gameOJ.socketName.rebuildEffect=++t,
e.build(t,"string"),
gameOJ.socketName.deadBullet=++t,e.build(t,["string"]),gameOJ.socketName.updateDead=++t,e.build(t,[{
playerId:"string",time:"uint32"}]),gameOJ.socketName.updateScore=++t,e.build(t,{teamPoint:["int8"],
scoreList:[{playerID:"string",d:"int8",point:"int8"}]}),gameOJ.socketName.hideTank=++t,
e.build(t,["string"]),gameOJ.socketName.enemy=++t,e.build(t,[{p:"string",x:"int16",y:"int16",
g:"float32",m:"int16",t:"int16",e:["uint8"],s:"float32",reload:"uint16",team:"string",
style:"string",moveAngle:"float32"}]),gameOJ.socketName.hideEnemy=++t,e.build(t,["string"]),
gameOJ.socketName.deadEnemy=++t,e.build(t,[{playerId:"string",time:"uint32"
}]),gameOJ.socketName.updatePlayer=++t,e.build(t,{playerID:"string",currentTime:"uint32",
playerTeam:"string"}),gameOJ.socketName.updateUserName=++t,e.build(t,[{playerName:"string",
playerID:"string"}]),gameOJ.socketName.updateTankStyle=++t,e.build(t,[{p:"string",s:"string"}]),
gameOJ.socketName.updateSkill=++t,e.build(t,[{index:"int8",countDown:"uint32"}]),
gameOJ.socketName.updateTeam=++t,e.build(t,{data:[{playerID:"string",teamID:"string"}],isFull:"int8"
}),gameOJ.socketName.updateSlot=++t,e.build(t,[{playerID:"string",slotList:["int8"],
unlimitSlot:["int8"],updateItem:["int8"]}]),gameOJ.socketName.updateStatus=++t,e.build(t,{
endCode:"int8",winTeam:"string",reward:[{id:"int8",number:"int16"}]})},checkUserName:function(e){
var t=/^[0-9a-zA-Z_]{4,15}$/;return!!e.match(t)},buildAfterLoad:function(){this.saveItemInfor(),
this.CreateAnimation()},saveItemInfor:function(){gameOJ.slotInfor=gameOJ.loadMC.getAsset("itemmap")
},getSlotInfor:function(e){return e>=gameOJ.slotInfor.length?null:gameOJ.slotInfor[e]},
CreateAnimation:function(){var e={images:[gameOJ.loadMC.getAsset("resize")],frames:{width:170,
height:180},animations:{main:[0,38,!0,.5]}};this.SpriteSheetList.resize=new createjs.SpriteSheet(e)
;var t=new createjs.Sprite(this.SpriteSheetList.resize)
;t.gotoAndPlay("main"),t.scaleX=gameOJ.gameW/170,t.scaleY=gameOJ.gameH/180,gameOJ.stage3.addChild(t)
;var a={images:[gameOJ.loadMC.getAsset("tankBase")],frames:{width:32,height:32},animations:{tank1:0,
tank2:1,tank3:2}};this.SpriteSheetList.TankBase=new createjs.SpriteSheet(a);var i={
images:[gameOJ.loadMC.getAsset("tankTurret")],frames:{width:32,height:32},animations:{tank1:0,
tank1s:[1,3,"tank1",.5],tank2:4,tank2s:[5,7,"tank2",.5],tank3:8,tank3s:[9,10,"tank3",.5]}}
;this.SpriteSheetList.TankTurret=new createjs.SpriteSheet(i);var n={
images:[gameOJ.loadMC.getAsset("enemy")],frames:{width:50,height:50},animations:{enemy1:0}}
;this.SpriteSheetList.Enemy=new createjs.SpriteSheet(n);var l={
images:[gameOJ.loadMC.getAsset("enemyTurret")],frames:{width:50,height:50},animations:{enemy1:0,
enemy1s:[1,3,"enemy1",.5]}};this.SpriteSheetList.EnemyTurret=new createjs.SpriteSheet(l);var r={
images:[gameOJ.loadMC.getAsset("tankBigSize")],frames:{width:50,height:50},animations:{
tank1:[0,3,!0,.1],tank2:[4,7,!0,.1],tank3:[8,11,!0,.1]}}
;this.SpriteSheetList.TankBigSize=new createjs.SpriteSheet(r);var s={
images:[gameOJ.loadMC.getAsset("bullet")],frames:{width:50,height:50},animations:{tank1:0,tank2:1,
tank3:2,tank1_1:[3,6,!0,.5],tank3_1:[7],enemy1:[8,11,!0,.5]}}
;this.SpriteSheetList.bullet=new createjs.SpriteSheet(s);var o={
images:[gameOJ.loadMC.getAsset("effect")],frames:{width:50,height:50},animations:{
effect1:[0,6,!1,.5],effect2:[7,16,!1,.3],effect3:[17,21,!1,.3],effect4:[22,26,!1,.3],effect5:[27],
effect6:[28,36,!1,.3],effect7:[37,43,!1,.2],effect8:[44,52,!1,.2],effect9:[53,58,!1,.5],
effect10:[59],effect11:[60,65,!1,.5],effect12:[66,71,!1,.1],effect13:[72,73,!1,.1],
effect14:[74,75,!1,.1],effect15:[76,83,!1,.3],effect16:[84,93,!1,.2],effect17:[94,100,!1,.3],
effect18:[101,108,!1,.3]}};this.SpriteSheetList.effect=new createjs.SpriteSheet(o);var m={
images:[gameOJ.loadMC.getAsset("effect_p")],frames:{width:50,height:50},animations:{
effect1:[0,2,!0,.5],effect2:[3,5,!0,.5],effect3:[6,9,!0,.5],effect4:[10,14,!0,.2],effect5:[15],
effect6:[16,19,!0,.3],effect10:[20],effect11:[21,24,!0,.3]}}
;this.SpriteSheetList.effect_p=new createjs.SpriteSheet(m);var g={
images:[gameOJ.loadMC.getAsset("dropItem")],frames:{width:50,height:50},animations:{item1:0,
item2:[1,2,!0,.1],item3:[4,8,!0,.1],item4:[10,14,!0,.1],item5:[16,20,!0,.1],slot1:3,slot2:9,
slot3:15,slot4:21,slot5:22,slot6:23,slot7:24,slot8:25,slot9:26}}
;this.SpriteSheetList.item=new createjs.SpriteSheet(g);var c={
images:[gameOJ.loadMC.getAsset("icon")],frames:{width:50,height:50},animations:{board:0,kill1:1,
kill2:2,kill3:3,kill4:4,kill5:[4,7,!0,.5],fullScreenGo:8,fullScreenExit:9,soundAllow:10,
soundNotAllow:11,emptySlot:12,buildItem:13,buildBack:14,install:15,installOff:16,closeIcon:17,
backBoard:18,point:19,dead:20,timerBack:21,reward1:22,reward2:23}}
;this.SpriteSheetList.icon=new createjs.SpriteSheet(c);var d={
images:[gameOJ.loadMC.getAsset("logo")],frames:{width:200,height:64},animations:{
victory:[1,3,!0,.1],defeat:[4]}};this.SpriteSheetList.logo=new createjs.SpriteSheet(d);var h={
images:[gameOJ.loadMC.getAsset("skill")],frames:{width:40,height:40},animations:{back:[0],
skill1_1:[1],skill2_1:[2],skill3_1:[3]}};this.SpriteSheetList.skill=new createjs.SpriteSheet(h),
this.buildFont();var u={images:[gameOJ.loadMC.getAsset("map_1")],frames:{width:16,height:16},
animations:{a123:{frames:[123,124,125,163,164,165],next:!0,speed:.1},a16:{
frames:[16,18,20,96,98,100],next:!0,speed:.1},a17:{frames:[17,19,21,97,99,101],next:!0,speed:.1},
a56:{frames:[56,58,60,136,138,140],next:!0,speed:.1},a57:{frames:[57,59,61,137,139,141],next:!0,
speed:.1}}}
;this.SpriteSheetList.map_1=new createjs.SpriteSheet(u),this.AniL1NameList.push(123,16,17,56,57)
;var p={images:[gameOJ.loadMC.getAsset("hpbar")],frames:{width:60,height:20}}
;this.SpriteSheetList.hpbar=new createjs.SpriteSheet(p)},buildFont:function(){
let e=gameOJ.loadMC.getAsset("fontcolor");for(var t=0;t<e.length;t++){
let i=e[t],n=new createjs.Container,l=new createjs.Bitmap(gameOJ.loadMC.getAsset("font_background")),r=new createjs.Bitmap(gameOJ.loadMC.getAsset("font_border"))
;n.addChild(r,l),
l.filters=[new createjs.ColorFilter(0,0,0,1,i.data[0],i.data[1],i.data[2],i.data[3])],
l.cache(0,0,81,81),n.cache(0,0,81,81),n.removeAllChildren();var a={images:[n.cacheCanvas],frames:{
width:9,height:8},animations:{c0:0,c1:1,c2:2,c3:3,c4:4,c5:5,c6:6,c7:7,c8:8,c9:9,"c:":82,c_:79,
"c+":65,"c.":68,"c?":35,"c!":69,"c-":67,A:10,B:11,C:12,D:13,E:14,F:15,G:16,H:17,I:18,J:19,K:20,L:21,
M:22,N:23,O:24,P:25,Q:26,R:27,S:28,T:29,U:30,V:31,W:32,X:33,Y:34,Z:35,a:39,b:40,c:41,d:42,e:43,f:44,
g:45,h:46,i:47,j:48,k:49,l:50,m:51,n:52,o:53,p:54,q:55,r:56,s:57,t:58,u:59,v:60,w:61,x:62,y:63,z:64}
};this.SpriteSheetList["font_"+i.name]=new createjs.SpriteSheet(a)}},resetGame:function(){
gameOJ.bulletList=[],gameOJ.playerList=[],gameOJ.enemyList=[],gameOJ.effectList=[],
gameOJ.scoreList={value:[],updated:!1,redraw:!1,teamPoint:[]},gameOJ.currentMap=null,
gameOJ.player=null,gameOJ.pingtime=0},createMap:function(e){mapData=gameOJ.loadMC.getAsset(e),
gameOJ.currentMap=mapData;for(var t=new createjs.Container,a=0;a<mapData.layers[0].data.length;a++){
var i=mapData.layers[0].data[a]-1,n=a%mapData.width,l=Math.floor(a/mapData.width);if(-1!==i){
var r=new createjs.Sprite(this.SpriteSheetList.map_1)
;-1===this.AniL1NameList.indexOf(i)?(r.gotoAndStop(i),
r.x=n*mapData.tilewidth,r.y=l*mapData.tileheight,t.addChild(r)):(r.gotoAndPlay("a"+i),
r.x=n*mapData.tilewidth,
r.y=l*mapData.tileheight,gameOJ.stage2.getChildAt(gameOJ.staticValues.aniL1LayerNumber).addChild(r)),
n++,n>=mapData.width&&(l++,n=0)}}for(var s=0;s<mapData.layers[5].objects.length;s++){
let e=mapData.layers[5].objects[s],a=new createjs.Bitmap(gameOJ.loadMC.getAsset("map_1"))
;a.sourceRect=new createjs.Rectangle(496,368,32,32),a.x=e.x-8,a.y=e.y-8,t.addChild(a)}
t.cache(0,0,mapData.width*mapData.tilewidth,mapData.height*mapData.tileheight)
;var o=new createjs.Bitmap(t.cacheCanvas)
;o.sourceRect=new createjs.Rectangle(0,0,gameOJ.gameW,gameOJ.gameH),
gameOJ.stage2.getChildAt(gameOJ.staticValues.mapL1LayerNumber).addChild(o),t.removeAllChildren(),
gameOJ.canvasOfLayer.mapL1Layer=t;var m=new createjs.Container
;for(a=0;a<mapData.layers[1].data.length;a++){i=mapData.layers[1].data[a]-1,n=a%mapData.width,
l=Math.floor(a/mapData.width);if(-1!==i){r=new createjs.Sprite(this.SpriteSheetList.map_1)
;r.gotoAndStop(i),r.x=n*mapData.tilewidth,r.y=l*mapData.tileheight,m.addChild(r),n++,
n>=mapData.width&&(l++,n=0)}}
m.cache(0,0,mapData.width*mapData.tilewidth,mapData.height*mapData.tileheight)
;var g=new createjs.Bitmap(m.cacheCanvas)
;g.sourceRect=new createjs.Rectangle(0,0,gameOJ.gameW,gameOJ.gameH),
gameOJ.stage2.getChildAt(gameOJ.staticValues.mapL1_5LayerNumber).addChild(g),m.removeAllChildren(),
gameOJ.canvasOfLayer.mapL1_5Layer=m;var c=new createjs.Container
;for(a=0;a<mapData.layers[2].data.length;a++){i=mapData.layers[2].data[a]-1,n=a%mapData.width,
l=Math.floor(a/mapData.width);if(-1!==i){r=new createjs.Sprite(this.SpriteSheetList.map_1)
;r.gotoAndStop(i),r.x=n*mapData.tilewidth,r.y=l*mapData.tileheight,c.addChild(r),n++,
n>=mapData.width&&(l++,n=0)}}
c.cache(0,0,mapData.width*mapData.tilewidth,mapData.height*mapData.tileheight)
;var d=new createjs.Bitmap(c.cacheCanvas)
;d.sourceRect=new createjs.Rectangle(0,0,gameOJ.gameW,gameOJ.gameH),
gameOJ.stage2.getChildAt(gameOJ.staticValues.mapL2LayerNumber).addChild(d),c.removeAllChildren(),
gameOJ.canvasOfLayer.mapL2Layer=c,Boolean(mapData.theme)?(gameOJ.playSound(mapData.theme,300,300),
gameOJ.currentTheme=mapData.theme):(gameOJ.playSound("theme1",300,300),gameOJ.currentTheme="theme1")
},FixCanvas:function(){
gameOJ.stage.canvas.width=window.innerWidth,gameOJ.stage.canvas.height=window.innerHeight,
gameOJ.gameSH=gameOJ.stage.canvas.height/gameOJ.gameH,
gameOJ.gameSW=gameOJ.stage.canvas.width/gameOJ.gameW,gameOJ.stage.scaleX=gameOJ.gameSW,
gameOJ.stage.scaleY=gameOJ.gameSH,
gameOJ.stage.updateViewport(gameOJ.stage.canvas.width,gameOJ.stage.canvas.height),
window.innerHeight>window.innerWidth?gameOJ.stage3.visible=!0:gameOJ.stage3.visible=!1},
Fitcon:function(){var e=new createjs.Container;return e.scaleX=gameOJ.gameSW,e.scaleY=gameOJ.gameSH,
e},buildText:function(e,t,a=null,i=null){
let n=a||new createjs.Container,l=0,r=0,s=i||"whi",o=e.split(/[\s\/]/),m=0,g=0
;for(let a=0;a<e.length;a++){let i=e.charAt(a);if(" "===i)l+=10,m++,g=1;else if("/"===i)l=0,r+=11,
m++,g=1;else if("["===i)s=e.substring(a+1,a+4),a+=4;else{g&&l+10*o[m].length>t&&(l=0,r+=11)
;let e=i.match(/[a-z]/i)?"":"c",a=new createjs.Sprite(gameOJ.SpriteSheetList["font_"+s],e+i);a.x=l,
a.y=r,n.addChild(a),l+=10,g=0}}return n.cache(0,0,t+10,r+11),n.removeAllChildren(),n.text=e,n},
buildBoard:function(e,t,a,i=null){
let n=16,l=a.x+1,r=a.y+1,s=a.width-2,o=a.height-2,m=i||new createjs.Container,g=~~(e/n),c=~~(t/n),d=e-g*n,h=t-c*n
;if(d&&g++,h&&c++,s>e||o>t){m.removeAllChildren()
;let i=new createjs.Bitmap(gameOJ.loadMC.getAsset("icon"));return i.sourceRect=a,i.scaleX=e/s,
i.scaleY=t/o,m.addChild(i),m}
let u=[new createjs.Rectangle(0+l,0+r,n,n),new createjs.Rectangle(n+l,0+r,n,n),new createjs.Rectangle(2*n+l,0+r,n,n),new createjs.Rectangle(0+l,n+r,n,n),new createjs.Rectangle(n+l,n+r,n,n),new createjs.Rectangle(2*n+l,n+r,n,n),new createjs.Rectangle(0+l,2*n+r,n,n),new createjs.Rectangle(n+l,2*n+r,n,n),new createjs.Rectangle(2*n+l,2*n+r,n,n)],p=0,O=0,J=gameOJ.loadMC.getAsset("icon")
;for(;O<c;){let e=0,t=new createjs.Bitmap(J),a=16*p,i=16*O;p&&p<g-1?e++:p===g-1&&(e+=2,a-=n-d),
O&&O<c-1?e+=3:O===c-1&&(e+=6,i-=n-h),t.sourceRect=u[e],t.x=a,t.y=i,m.addChild(t),p++,p===g&&(p=0,
O++)}return m.cache(0,0,e,t),m.removeAllChildren(),m},buildButton:function(e,t="whi",a,i,n,l=null){
let r=gameOJ.buildText(e,10*e.length,null,t);r.regY=5,r.regX=5*e.length,r.x=a/2,r.y=i/2
;let s=gameOJ.buildBoard(a,i,n),o=l||new createjs.Container;return o.addChild(s,r),o},
clearCanvas:function(){gameOJ.stage.removeAllChildren(),gameOJ.stage1.removeAllChildren(),
gameOJ.stage2.removeAllChildren()
;var e=new createjs.Container,t=new createjs.Container,a=new createjs.Container,i=new createjs.Container,n=new createjs.Container,l=new createjs.Container,r=new createjs.Container,s=new createjs.Container,o=new createjs.Container,m=new createjs.Container,g=new createjs.Container,c=new createjs.Container
;gameOJ.stage2.addChild(n,l,r,s,e,t,a,i,o,m,c,g),
gameOJ.stage.addChild(gameOJ.stage1,gameOJ.stage2,gameOJ.stage3)},changeTT:function(e){
gameOJ.gameTT=e,gameOJ.gameNN=0,gameOJ.playerID=null,gameOJ.playerTeam=null,gameOJ.clearCanvas()},
createFinishMenu:function(){
gameOJ.stopAllPlayer(),null!==gameOJ.currentTheme&&gameOJ.Sound[gameOJ.currentTheme].volume(.1),
gameOJ.stage2.getChildAt(gameOJ.staticValues.controlLayerNumber).alpha=0,
gameOJ.stage2.getChildAt(gameOJ.staticValues.alertLayerNumer).removeAllChildren()
;var e=gameOJ.stage2.getChildAt(gameOJ.staticValues.scoreLayerNumber).getChildAt(0);let t;e.x=20,
e.y=20,
e.visible=!0,t=2===gameOJ.teamSort.length?gameOJ.stage2.getChildAt(gameOJ.staticValues.scoreLayerNumber).getChildAt(1).getChildAt(1):new createjs.Container,
t.x=170,t.y=gameOJ.gameH-45
;var a=new createjs.Shape((new createjs.Graphics).beginFill("#000000").drawRect(0,0,500,300))
;a.cache(0,0,500,300),a.alpha=0,a.on("tick",()=>{a.alpha<1&&(a.alpha+=.01)})
;let i=gameOJ.buildButton("Continue","whi",100,40,gameOJ.SpriteSheetList.icon.getFrame(18).rect)
;i.getChildAt(1).scaleY=2,i.x=gameOJ.gameW-110,i.y=gameOJ.gameH-50,i.on("mousedown",()=>{
null!==gameOJ.currentTheme&&(gameOJ.Sound[gameOJ.currentTheme].stop(),gameOJ.currentTheme=null),
gameOJ.leaveMatch(),gameOJ.changeTT(1)})
;let n=new createjs.Sprite(gameOJ.SpriteSheetList.TankBigSize)
;n.gotoAndPlay("tank"+gameOJ.player.tankStyle),n.x=gameOJ.gameW-180,n.y=gameOJ.gameH/2-110,
n.scaleX=n.scaleY=4
;let l=new createjs.Container,r=gameOJ.gameEnd.reward.length>3?4.5/gameOJ.gameEnd.reward.length:1.5
;l.x=n.x+100,l.y=n.y+170,l.scaleX=l.scaleY=r;let s=gameOJ.loadMC.getAsset("reward")
;for(let e=0;e<gameOJ.gameEnd.reward.length;e++){
let t=gameOJ.gameEnd.reward[e],a=(s[gameOJ.gameEnd.reward[e].id-1],
new createjs.Container),i=new createjs.Sprite(gameOJ.SpriteSheetList.icon,"reward"+t.id)
;if(i.regX=i.regY=25,a.addChild(i),a.x=28*e,t.number>0){let e=gameOJ.buildText(t.number+"",40)
;e.scaleX=1/e.text.length,a.addChild(e)}l.addChild(a),a.alpha=0,a.scaleX=a.scaleY=11.5
;let r=0===e?2e3:2e3+e*~~(2e3/gameOJ.gameEnd.reward.length);a.on("tick",t=>{
r<=0?a.scaleX>1.5&&(a.scaleX=a.scaleY-=1)&&(a.alpha+=.1):(r-=17,r<=0&&(l.x=n.x+100-14*e,
gameOJ.playSound("effectitem",0,0)))})}if(gameOJ.playerTeam!==gameOJ.gameEnd.winTeam){
var o=new createjs.Sprite(this.SpriteSheetList.logo,"defeat");o.regX=100,o.regY=32,
o.x=gameOJ.gameW-90,
o.y=30,gameOJ.stage2.getChildAt(gameOJ.staticValues.alertLayerNumer).addChild(a,o,e,n,i,t,l)}else{
var m=new createjs.Sprite(this.SpriteSheetList.logo,"victory");m.regX=100,m.regY=32,
m.x=gameOJ.gameW-90,
m.y=30,gameOJ.stage2.getChildAt(gameOJ.staticValues.alertLayerNumer).addChild(a,m,e,n,i,t,l)}},
updateScoreList:function(){
if(0!==gameOJ.stage2.getChildAt(gameOJ.staticValues.scoreLayerNumber).numChildren)var e=gameOJ.stage2.getChildAt(gameOJ.staticValues.scoreLayerNumber).getChildAt(0),t=gameOJ.stage2.getChildAt(gameOJ.staticValues.scoreLayerNumber).getChildAt(1);else{
e=new createjs.Container;e.alpha=.8,e.x=gameOJ.gameW/2-150,e.y=gameOJ.gameH/2-125-15,e.visible=!1
;let a=new createjs.Container;a.y=10
;let i=new createjs.Container,n=new createjs.Sprite(this.SpriteSheetList.icon,"point")
;n.regX=n.regY=25,n.x=215;let l=new createjs.Sprite(this.SpriteSheetList.icon,"dead")
;l.regX=l.regY=25,
l.x=255,i.y=20,i.addChild(n,l),e.addChild(gameOJ.buildBoard(300,250,gameOJ.SpriteSheetList.icon.getFrame(18).rect),a,i),
e.on("mousedown",()=>{gameOJ.showAndHideBoard(!1)});t=new createjs.Container;t.alpha=.6,
t.x=gameOJ.gameW/2;let r=new createjs.Sprite(this.SpriteSheetList.icon,"timerBack");r.x=5,r.regX=25,
r.scaleX=2;let s=gameOJ.buildText("0",30,null,"gre");s.x=-20,s.y=21,s.scaleY=1.5
;let o=gameOJ.buildText("0",30,null,"red");o.x=20,o.y=21,o.scaleY=1.5
;let m=gameOJ.buildText("VS",30);m.scaleY=2,m.x=-5,m.y=21;let g=new createjs.Container
;g.addChild(s,o,m),
g.visible=!1,t.addChild(r,g),gameOJ.stage2.getChildAt(gameOJ.staticValues.scoreLayerNumber).addChild(e,t)
}let a=e.getChildAt(1);if(2===gameOJ.teamSort.length){let e=t.getChildAt(1)
;!e.visible&&(e.visible=!0)
;for(let t=0,a=gameOJ.scoreList.teamPoint.length;t<a;t++)if(gameOJ.teamSort[t]===gameOJ.player.team){
let a=e.getChildAt(0);gameOJ.buildText(gameOJ.scoreList.teamPoint[t]+"",30,a,"gre"),
a.x=-10-10*a.text.length}else{let a=e.getChildAt(1)
;gameOJ.buildText(gameOJ.scoreList.teamPoint[t]+"",30,a,"red")}}
for(var i=0,n=gameOJ.scoreList.value.length;i<n;i++){var l=gameOJ.scoreList.value[i]
;if(null===l.player)continue;let e=0
;e=l.player===gameOJ.player?1:l.player.team===gameOJ.player.team?2:3
;let t,n=a.children.findIndex(e=>Boolean(e.playerID)&&e.playerID===l.playerID);if(-1===n){
t=new createjs.Container
;let i=gameOJ.buildText(l.player.playerName,160,null,1===e?"gre":2===e?"whi":"red");i.x=20,
i.scaleY=2;let n=gameOJ.buildText(l.player.killPoint+"",30,null,1===e?"gre":2===e?"whi":"red")
;n.x=190,n.scaleY=2
;let r=gameOJ.buildText(l.player.deadPoint+"",40,null,1===e?"gre":2===e?"whi":"red");r.x=230,
r.scaleY=2;let s=new createjs.Sprite(gameOJ.SpriteSheetList.TankBigSize)
;s.gotoAndStop("tank"+l.player.tankStyle),s.scaleX=s.scaleY=.5,s.regX=25,s.regY=10,
t.addChild(i,n,r,s),t.playerID=l.playerID,t.x=20,a.addChild(t)}else{t=a.getChildAt(n)
;let i=t.getChildAt(1);gameOJ.buildText(l.player.killPoint+"",30,i,1===e?"gre":2===e?"whi":"red")
;let r=t.getChildAt(2);gameOJ.buildText(l.player.deadPoint+"",30,r,1===e?"gre":2===e?"whi":"red")}
t.y=25*(i+1)}},changeMapCanvas:function(e,t,a,i,n){
var l=gameOJ.canvasOfLayer[e],r=new createjs.Sprite(this.SpriteSheetList.map_1)
;r.x=i*this.currentMap.tilewidth,r.y=n*this.currentMap.tileheight,-1!==t&&0!==t||(r.gotoAndStop(0),
l.addChild(r),
l.updateCache("destination-out")),0===t?(r.gotoAndStop(a),l.updateCache("source-over")):1===t&&(l.addChild(r),
r.gotoAndStop(a),l.updateCache("source-over")),l.removeAllChildren()},addItem:function(e,t,a,i){
let n=new createjs.Sprite(gameOJ.SpriteSheetList.item,"item"+a);n.itemID=i,n.regX=n.regY=16,n.x=e,
n.y=t,gameOJ.stage2.getChildAt(gameOJ.staticValues.mapItemLayerNumber).addChild(n)},
removeItem:function(e){var t=gameOJ.stage2.getChildAt(gameOJ.staticValues.mapItemLayerNumber)
;let a=t.children.findIndex(t=>t.itemID===e)
;-1!==a&&("item2"===t.getChildAt(a).currentAnimation&&gameOJ.addEffect(t.getChildAt(a).x+8,t.getChildAt(a).y+8,0,"7"),
t.removeChildAt(a))},moveCamera:function(e,t,a){var i=e-gameOJ.gameW/2,n=t-gameOJ.gameH/2
;i<0&&(i=0),
i>gameOJ.currentMap.width*gameOJ.currentMap.tilewidth-gameOJ.gameW&&(i=gameOJ.currentMap.width*gameOJ.currentMap.tilewidth-gameOJ.gameW),
n<0&&(n=0),
n>gameOJ.currentMap.height*gameOJ.currentMap.tileheight-gameOJ.gameH&&(n=gameOJ.currentMap.height*gameOJ.currentMap.tileheight-gameOJ.gameH),
gameOJ.stage2.getChildAt(gameOJ.staticValues.mapL1LayerNumber).getChildAt(0).sourceRect.x=i,
gameOJ.stage2.getChildAt(gameOJ.staticValues.mapL1LayerNumber).getChildAt(0).sourceRect.y=n,
gameOJ.stage2.getChildAt(gameOJ.staticValues.aniL1LayerNumber).x=-i,
gameOJ.stage2.getChildAt(gameOJ.staticValues.aniL1LayerNumber).y=-n,
gameOJ.stage2.getChildAt(gameOJ.staticValues.mapL1_5LayerNumber).getChildAt(0).sourceRect.x=i,
gameOJ.stage2.getChildAt(gameOJ.staticValues.mapL1_5LayerNumber).getChildAt(0).sourceRect.y=n,
gameOJ.stage2.getChildAt(gameOJ.staticValues.mapItemLayerNumber).x=-i,
gameOJ.stage2.getChildAt(gameOJ.staticValues.mapItemLayerNumber).y=-n,
gameOJ.stage2.getChildAt(gameOJ.staticValues.mapL2LayerNumber).getChildAt(0).sourceRect.x=i,
gameOJ.stage2.getChildAt(gameOJ.staticValues.mapL2LayerNumber).getChildAt(0).sourceRect.y=n,
gameOJ.stage2.getChildAt(gameOJ.staticValues.tankLayerNumber).x=-i,
gameOJ.stage2.getChildAt(gameOJ.staticValues.tankLayerNumber).y=-n,
gameOJ.stage2.getChildAt(gameOJ.staticValues.enemyLayerNumber).x=-i,
gameOJ.stage2.getChildAt(gameOJ.staticValues.enemyLayerNumber).y=-n,
gameOJ.stage2.getChildAt(gameOJ.staticValues.bulletLayerNumber).x=-i,
gameOJ.stage2.getChildAt(gameOJ.staticValues.bulletLayerNumber).y=-n,
gameOJ.stage2.getChildAt(gameOJ.staticValues.effectLayerNumber).x=-i,
gameOJ.stage2.getChildAt(gameOJ.staticValues.effectLayerNumber).y=-n},
showAndHideBoard:function(e=null){
if(gameOJ.stage2.getChildAt(gameOJ.staticValues.scoreLayerNumber).numChildren>0){
var t=gameOJ.stage2.getChildAt(gameOJ.staticValues.scoreLayerNumber).getChildAt(0)
;t.visible=null!==e?e:!t.visible}},buildTimeText:function(){
var e=("00"+~~(gameOJ.gameTime/1e3/60)).slice(-2),t=("00"+~~(gameOJ.gameTime/1e3%60)).slice(-2)
;t=e+":"+t;for(var a=new createjs.Container,i=0;i<t.length;i++){
let e=new createjs.Sprite(gameOJ.SpriteSheetList.font_whi);e.gotoAndStop("c"+t.charAt(i)),e.x=10*i,
a.addChild(e)}
a.regX=20,a.x=gameOJ.gameW/2,a.y=5,gameOJ.stage2.getChildAt(gameOJ.staticValues.alertLayerNumer).addChild(a)
},updateTimeText:function(e){if(0!==gameOJ.gameTime){var t=gameOJ.gameTime;gameOJ.gameTime-=e
;var a=("00"+~~(gameOJ.gameTime/1e3/60)).slice(-2),i=("00"+~~(gameOJ.gameTime/1e3%60)).slice(-2)
;i=a+":"+i
;var n=gameOJ.stage2.getChildAt(gameOJ.staticValues.alertLayerNumer).getChildAt(gameOJ.stage2.getChildAt(gameOJ.staticValues.alertLayerNumer).numChildren-1)
;t>15e3&&gameOJ.gameTime<15e3&&gameOJ.playSound("bell",0,0),
gameOJ.gameTime<6e3&&~~(t/1e3)-~~(gameOJ.gameTime/1e3)==1&&(gameOJ.playSound("ticking",0,0),
n.scaleX=n.scaleY+=.3);for(var l=0;l<i.length;l++)n.getChildAt(l).gotoAndStop("c"+i.charAt(l))}},
blockGame:function(){2===gameOJ.gameTT&&gameOJ.playerControl.clearMove()},findPlayer:function(e){
return gameOJ.playerList.findIndex(t=>t.playerID===e)},findEnemy:function(e){
return gameOJ.enemyList.findIndex(t=>t.playerID===e)},findBullet:function(e){
return gameOJ.bulletList.findIndex(t=>t.bulletID===e)},addPlayer:function(e,t,a,i){
var n=new gameOJ.Player(e,t,a,i)
;gameOJ.playerList.push(n),gameOJ.stage2.getChildAt(gameOJ.staticValues.tankLayerNumber).addChild(n.tankGraphic)
},addEnemy:function(e,t,a,i,n){var l=new gameOJ.Enemy(e,t,a,i,n);gameOJ.enemyList.push(l),
gameOJ.stage2.getChildAt(gameOJ.staticValues.enemyLayerNumber).addChild(l.tankGraphic)},
addBullet:function(e,t,a,i,n,l,r=!1){var s=new gameOJ.Bullet(e,t,a,i,n,l,r)
;gameOJ.bulletList.push(s),
gameOJ.stage2.getChildAt(gameOJ.staticValues.bulletLayerNumber).addChild(s.bulletGraphic)},
addEffect:function(e,t,a,i,n=!1,l=null){
var r=new gameOJ.Effect(e,t,a,i,gameOJ.effectList.length,n,l);gameOJ.effectList.push(r),
gameOJ.stage2.getChildAt(gameOJ.staticValues.effectLayerNumber).addChild(r.effectGraphic)},
removePlayer:function(e,t=-1){var a=-1!==t?t:gameOJ.findPlayer(e)
;gameOJ.stage2.getChildAt(gameOJ.staticValues.tankLayerNumber).removeChild(gameOJ.playerList[a].tankGraphic),
gameOJ.playerList.splice(a,1);var i=gameOJ.scoreList.value.findIndex(t=>t.playerID===e)
;-1!==i&&(gameOJ.scoreList.value.splice(i,1),gameOJ.scoreList.redraw=!0)},
removeEnemy:function(e,t=-1){let a=-1!==t?t:gameOJ.findEnemy(e),i=gameOJ.enemyList[a]
;gameOJ.stage2.getChildAt(gameOJ.staticValues.enemyLayerNumber).removeChild(i.tankGraphic),
gameOJ.enemyList.splice(a,1)},removeBullet:function(e){var t=gameOJ.findBullet(e)
;gameOJ.stage2.getChildAt(gameOJ.staticValues.bulletLayerNumber).removeChild(gameOJ.bulletList[t].bulletGraphic),
gameOJ.bulletList.splice(t,1)},removeEffect:function(e){
gameOJ.stage2.getChildAt(gameOJ.staticValues.effectLayerNumber).removeChildAt(e),
gameOJ.effectList.splice(e,1)},updateScoreListData:function(){
for(var e=0,t=gameOJ.unknownData.scoreListValue.length;e<t;e++){
let a=gameOJ.unknownData.scoreListValue[e],i=gameOJ.findPlayer(a.playerID)
;-1!==i&&(a.player=gameOJ.playerList[i],
a.player.killPoint=a.draftPoint,a.player.deadPoint=a.draftDead,
gameOJ.unknownData.scoreListValue.splice(e,1),gameOJ.scoreList.redraw=!0,e--,t--)}},
stopAllPlayer:function(){for(var e=0;e<gameOJ.playerList.length;e++){var t=gameOJ.playerList[e]
;t.addNewPosition(t.tankPoint.x+1,t.tankPoint.y+1,-1)}},displayKillIcon:function(e){e>5&&(e=5)
;var t=gameOJ.stage2.getChildAt(gameOJ.staticValues.alertLayerNumer).getChildAt(3);t.visible=!0,
t.displayScore=1e3,gameOJ.playSound("kill",300-60*e,300-60*e),t.gotoAndPlay("kill"+e)},
createInGameMenu:function(){
let e=new createjs.Shape((new createjs.Graphics).beginFill("#000000").drawRect(15,15,20,20)),t=new createjs.Sprite(gameOJ.SpriteSheetList.icon,"board")
;t.hitArea=e,t.on("mousedown",()=>{gameOJ.showAndHideBoard(null)})
;let a=new createjs.Container,i=new createjs.Sprite(gameOJ.SpriteSheetList.skill,"skill1_1"),n=new createjs.Sprite(gameOJ.SpriteSheetList.skill,"back"),l=new createjs.Container
;l.x=12,l.y=12,a.addChild(n,i,l),a.alpha=.8,a.regX=a.regY=20,a.x=gameOJ.gameW/2,a.y=gameOJ.gameH-20,
l.scaleX=l.scaleY=2;let r=new createjs.Container;r.scaleX=r.scaleY=5,r.x=gameOJ.gameW/2-25,
r.y=gameOJ.gameH/2-100,r.countdown=0;let s=new createjs.Sprite(gameOJ.SpriteSheetList.icon,"kill1")
;s.x=gameOJ.gameW/2-25,s.y=gameOJ.gameH/2-120,s.visible=!1,s.displayScore=0,s.on("tick",()=>{
s.displayScore>0&&(s.displayScore-=17,s.displayScore<=0&&(s.visible=!1))})
;let o=new createjs.Container,m=new createjs.Container,g=gameOJ.buildBoard(400,250,gameOJ.SpriteSheetList.icon.getFrame(18).rect)
;g.alpha=.8;let c=new createjs.Container;c.y=200;let d=new createjs.Container;d.y=200,
m.addChild(g,c);let h=new createjs.Container;for(let e=0;e<5;e++){
let t=new createjs.Sprite(gameOJ.SpriteSheetList.icon,"emptySlot");t.x=26*e,c.addChild(t)
;let a=new createjs.Sprite(gameOJ.SpriteSheetList.item,"slot1");a.x=26*e,a.visible=!1,d.addChild(a)}
let u=new createjs.Container;u.y=150;for(let e=0;e<3;e++){
let t=new createjs.Sprite(gameOJ.SpriteSheetList.icon,"emptySlot");t.x=26*e,t.y=-24,c.addChild(t)
;let a=new createjs.Sprite(gameOJ.SpriteSheetList.item,"slot"+(e+1));a.x=26*e,a.y=-24
;let i=gameOJ.buildText("0",30);i.x=26*e+25-10,i.y=50,c.addChild(a),u.addChild(i)}let p={x:0,y:0
},O=new createjs.Container,J=new createjs.Container;J.y=40,J.x=30,J.saveChild=[]
;for(let t=0;t<gameOJ.slotInfor.length;t++){let a=gameOJ.slotInfor[t];if(a.build.length>0){
let t=new createjs.Container,i=new createjs.Sprite(gameOJ.SpriteSheetList.icon,"buildBack"),n=new createjs.Sprite(gameOJ.SpriteSheetList.item,"slot"+a.id)
;i.alpha=.8,t.addChild(i,n),t.cache(0,0,50,50),t.hitArea=e,t.removeAllChildren(),t.x=50*p.x++,
100===t.x?(t.y=50*p.y++,p.x=0):t.y=50*p.y,t.scaleX=t.scaleY=2,O.addChild(t)
;let l=new createjs.Container;l.x=200,l.scaleY=l.scaleX=1.5
;let r=new createjs.Container,s=new createjs.Sprite(gameOJ.SpriteSheetList.icon,"buildBack"),m=new createjs.Sprite(gameOJ.SpriteSheetList.item,"slot"+a.id)
;r.x=25,r.y=10,r.addChild(s,m);let g=gameOJ.buildText(a.name,10*a.name.length);g.scaleY=2,
g.x=50-5*a.name.length;let c=gameOJ.buildText(a.dic,240);c.y=100,c.scaleX=.5,c.scaleY=1.2
;let d=new createjs.Container;if(d.y=50,a.buildNum>0){
let e=(new createjs.Graphics).beginFill("#bff0ff").drawRect(r.x+25-~~(25*(a.buildNum-1)/2),5,25*(a.buildNum-1),3).drawRect(r.x+25-2,0,4,6),t=new createjs.Shape(e),i=a.buildNum%2==0?11:0,n=r.x+i-25*~~(a.buildNum/2),l=1,s=0
;for(let t=0;t<a.buildNum;t++){
let t=new createjs.Sprite(gameOJ.SpriteSheetList.icon,"buildBack"),r=new createjs.Sprite(gameOJ.SpriteSheetList.item,"slot"+a.build[s].id)
;r.x=t.x=n,n+=25,e.drawRect(r.x+25+(i>0?2:0)-2,5,4,6),d.addChild(t,r),l<a.build[s].cost?l++:(l=1,
s++)}d.addChild(t),t.cache(0,-5,25*(a.buildNum-1)+100,108)
;let o=new createjs.Container,m=new createjs.Sprite(gameOJ.SpriteSheetList.item,"slot"+a.id),g=new createjs.Sprite(gameOJ.SpriteSheetList.icon,"buildBack")
;g.alpha=.5,o.addChild(g,m),o.on("mousedown",()=>{gameOJ.buildItem([a.id])}),J.saveChild.push(o)}
let u=new createjs.Sprite(gameOJ.SpriteSheetList.icon,"install");u.x=r.x+50,u.y=5,
u.on("mousedown",()=>{"install"===u.currentAnimation&&(gameOJ.buildItem([a.id]),o.visible=!1)}),
l.addChild(r,g,c,d,u),t.buildCon=l,t.on("mousedown",()=>{h.removeAllChildren(),h.addChild(l)})}}
m.cache(0,0,400,300),m.removeAllChildren()
;let f=new createjs.Container,y=new createjs.Sprite(gameOJ.SpriteSheetList.icon,"buildBack")
;y.alpha=.5,f.addChild(y,new createjs.Sprite(gameOJ.SpriteSheetList.icon,"closeIcon")),
f.cache(0,0,50,50),f.removeAllChildren(),f.x=400,f.hitArea=e,f.on("mousedown",()=>{o.visible=!1}),
o.regX=200,o.regY=125,o.x=gameOJ.gameW/2,o.y=gameOJ.gameH/2,o.addChild(m,d,u,O,h,f),o.visible=!1
;let S=new createjs.Sprite(gameOJ.SpriteSheetList.icon,"buildItem");S.hitArea=e,S.y=40,
S.on("mousedown",()=>{o.visible=!o.visible
}),gameOJ.stage2.getChildAt(gameOJ.staticValues.alertLayerNumer).addChild(t,a,r,s,S,o,J)},
tick:function(e){1==gameOJ.gameTT?gameOJ.tickMenu():2==gameOJ.gameTT&&gameOJ.tickPlay(e),
gameOJ.gameNN++,gameOJ.stage.update()},tickMenu:function(){if(0===gameOJ.gameNN){gameOJ.resetGame()
;var e=new createjs.Bitmap(gameOJ.loadMC.getAsset("menuImage")),t=new createjs.Bitmap(gameOJ.loadMC.getAsset("uiList"))
;t.sourceRect=new createjs.Rectangle(168,293,45,45),t.x=gameOJ.gameW/2-35-45,t.y=120
;var a=new createjs.Bitmap(gameOJ.loadMC.getAsset("uiList"))
;a.sourceRect=new createjs.Rectangle(216,293,46,46),a.x=gameOJ.gameW/2+32,a.y=120
;for(var i=new createjs.Container,n=1;n<4;n++){
let e=new createjs.Sprite(gameOJ.SpriteSheetList.TankBigSize,"tank"+n)
;e.visible=n===gameOJ.pickedTank,i.addChild(e)}i.scaleX=i.scaleY=2,i.regX=i.regY=16,
i.y=gameOJ.gameH/2-25,i.x=gameOJ.gameW/2-15
;var l=new createjs.Bitmap(gameOJ.loadMC.getAsset("uiList"))
;l.sourceRect=new createjs.Rectangle(30,295,110,110),l.regX=l.regY=55,l.x=gameOJ.gameW/2,
l.y=gameOJ.gameH/2+80+50
;var r=new createjs.Container,s=new createjs.Text(document.getElementById("userJoinGameName").value,"15px Arial","#FFFFFF"),o=new createjs.Shape((new createjs.Graphics).beginStroke("white").f("#999999").drawRect(0,0,200,30))
;s.maxWidth=200,s.maxHeight=30,s.textAlign="center",s.x=100,s.y=7,r.addChild(o,s),
r.cache(0,0,200,30),r.regX=100,r.regY=15,r.x=gameOJ.gameW/2,r.y=gameOJ.gameH/2+50
;var m=new createjs.Bitmap(gameOJ.loadMC.getAsset("logo"))
;m.sourceRect=new createjs.Rectangle(0,0,200,64),m.x=gameOJ.gameW/2,m.y=gameOJ.gameH/2-80,
m.regX=100,m.regY=32
;var g=new createjs.Shape((new createjs.Graphics).f("#000000").drawRect(0,0,250,270))
;g.x=gameOJ.gameW/2,g.y=gameOJ.gameH/2,g.regX=125,g.regY=125,g.alpha=.5,g.cache(0,0,250,270)
;var c=new createjs.Container,d=new createjs.Sprite(this.SpriteSheetList.icon)
;d.gotoAndStop(gameOJ.gameSetting.fullScreen?"fullScreenExit":"fullScreenGo"),d.x=gameOJ.gameW-50,
d.y=-10;var h=new createjs.Sprite(this.SpriteSheetList.icon)
;return h.gotoAndStop(gameOJ.gameSetting.allowSound?"soundAllow":"soundNotAllow"),
h.x=gameOJ.gameW-100,h.y=-10,c.addChild(d,h),gameOJ.stage1.addChild(e,g,t,a,i,l,m,r,c),
t.on("mousedown",()=>{1===gameOJ.pickedTank?(i.getChildAt(gameOJ.pickedTank-1).visible=!1,
gameOJ.pickedTank=i.numChildren,
i.getChildAt(gameOJ.pickedTank-1).visible=!0):(i.getChildAt(gameOJ.pickedTank-1).visible=!1,
gameOJ.pickedTank--,i.getChildAt(gameOJ.pickedTank-1).visible=!0)}),a.on("mousedown",()=>{
gameOJ.pickedTank===i.numChildren?(i.getChildAt(gameOJ.pickedTank-1).visible=!1,gameOJ.pickedTank=1,
i.getChildAt(gameOJ.pickedTank-1).visible=!0):(i.getChildAt(gameOJ.pickedTank-1).visible=!1,
gameOJ.pickedTank++,i.getChildAt(gameOJ.pickedTank-1).visible=!0)}),l.on("mousedown",()=>{
gameOJ.changeTT(2),gameOJ.joinGame(document.getElementById("userJoinGameName").value)}),
r.on("mousedown",()=>{gameOJ.userNameInput.style.display="block"
;let e=document.getElementById("userJoinGameName");e.focus(),e.value=e.value
}),d.on("mousedown",()=>{"fullScreenGo"===d.currentAnimation?(d.gotoAndStop("fullScreenExit"),
gameOJ.openFullscreen()):(d.gotoAndStop("fullScreenGo"),gameOJ.exitFullscreen())}),
void h.on("mousedown",()=>{"soundAllow"===h.currentAnimation?(h.gotoAndStop("soundNotAllow"),
gameOJ.changeSoundGame(0)):(h.gotoAndStop("soundAllow"),gameOJ.changeSoundGame(1))})}},
tickPlay:function(e){if(0===gameOJ.gameNN){gameOJ.createControl()
;var t=new createjs.Bitmap(gameOJ.loadMC.getAsset("menuImage")),a=new createjs.Bitmap(gameOJ.loadMC.getAsset("uiList")),i=new createjs.Container
;a.sourceRect=new createjs.Rectangle(32,160,279,64),a.regX=a.sourceRect.width/2,
a.regY=a.sourceRect.height/2,a.x=gameOJ.gameW/2,a.y=gameOJ.gameH/2-100,i.addChild(t,a),
gameOJ.stage2.addChild(i)}else if(gameOJ.playerList.length>0){gameOJ.updateTimeText(e.delta),
gameOJ.updateSkillCountdown(gameOJ.skillValue.k1.countdown-e.delta),
gameOJ.updateDeadCountdown(e.delta)
;for(var n=0,l=0;Boolean(gameOJ.playerList[l])&&gameOJ.player;)Boolean(gameOJ.playerList[l].removed)&&gameOJ.playerList[l].removed===gameOJ.pingtime?(gameOJ.playerList[l].updateShootTime(Math.round(e.delta)),
gameOJ.playerList[l].Tick(e.delta),
l++):Boolean(gameOJ.playerList[l].removed)&&gameOJ.playerList[l].removed!==gameOJ.pingtime?(gameOJ.playerList[l].updateShootTime(Math.round(e.delta)),
gameOJ.playerList[l].Tick(e.delta),
l++):(gameOJ.addEffect(gameOJ.playerList[l].tankPoint.x,gameOJ.playerList[l].tankPoint.y,gameOJ.playerList[l].tankBaseSprite.rotation,"5"),
gameOJ.addEffect(gameOJ.playerList[l].tankPoint.x,gameOJ.playerList[l].tankPoint.y,gameOJ.playerList[l].tankBaseSprite.rotation,"2"),
gameOJ.removePlayer(gameOJ.playerList[l].playerID),n++)
;gameOJ.scoreList.redraw&&(gameOJ.updateScoreList(),gameOJ.scoreList.redraw=!1),n=0
;for(var r=0;Boolean(gameOJ.enemyList[r])&&gameOJ.player;)Boolean(gameOJ.enemyList[r].removed)&&gameOJ.enemyList[r].removed===gameOJ.pingtime?(gameOJ.enemyList[r].updateShootTime(Math.round(e.delta)),
gameOJ.enemyList[r].Tick(e.delta),
r++):Boolean(gameOJ.enemyList[r].removed)&&gameOJ.enemyList[r].removed!==gameOJ.pingtime?(gameOJ.enemyList[r].updateShootTime(Math.round(e.delta)),
gameOJ.enemyList[r].Tick(e.delta),r++):(gameOJ.removeEnemy(gameOJ.enemyList[r].playerID,r),n++);n=0
;for(var s=0;Boolean(gameOJ.bulletList[s]);)if(Boolean(gameOJ.bulletList[s].removed)&&gameOJ.bulletList[s].removed===gameOJ.pingtime)gameOJ.bulletList[s].Tick(),
s++;else if(Boolean(gameOJ.bulletList[s].removed)&&gameOJ.bulletList[s].removed!==gameOJ.pingtime)gameOJ.bulletList[s].Tick(),
s++;else{var o=gameOJ.bulletList[s]
;if(!o.fake)for(var m,g=gameOJ.bulletInfor[o.bulletStyle].effect,c=0;Boolean(m=g[c]);)gameOJ.addEffect(o.bulletPoint.x,o.bulletPoint.y,o.bulletRotation+90,""+m),
c++;gameOJ.removeBullet(o.bulletID),n++}n=0
;for(var d=0;Boolean(gameOJ.effectList[d]);)gameOJ.effectList[d].sortID-=n,
gameOJ.effectList[d].live>0?(gameOJ.effectList[d].Tick(),
d++):(gameOJ.removeEffect(gameOJ.effectList[d].sortID),n++)
;if("key"===gameOJ.playerControl.controlType){
if(gameOJ.playerControl.mouseMoveEvent(gameOJ.stage.mouseX,gameOJ.stage.mouseY),gameOJ.player){
let e=gameOJ.player.tankAimStore[gameOJ.playerControl.aimSpriteIndex]
;gameOJ.player.tankAimSprite.getChildAt(0)!==e&&(gameOJ.player.tankAimSprite.removeAllChildren(),
gameOJ.player.tankAimSprite.addChild(e)),
gameOJ.player.tankAimSprite.visible=gameOJ.playerControl.touchAim}
2===gameOJ.playerControl.spaceSkill.a&&gameOJ.shootSkill()
}else if("touch"===gameOJ.playerControl.controlType){
if(gameOJ.playerControl.fakeMouseMoveEvent(gameOJ.player.tankPoint.x+gameOJ.playerControl.fakeMouse.x,gameOJ.player.tankPoint.y+gameOJ.playerControl.fakeMouse.y),
gameOJ.playerControl.touchShoot&&gameOJ.player.lastShootTime<1?(gameOJ.shootBullet(),
gameOJ.player&&(gameOJ.player.updateShootTime(Math.round(e.delta)),
gameOJ.playerControl.touchShoot=!1)):gameOJ.playerControl.touchShoot=!1,gameOJ.player){
let e=gameOJ.player.tankAimStore[gameOJ.playerControl.aimSpriteIndex]
;gameOJ.player.tankAimSprite.getChildAt(0)!==e&&(gameOJ.player.tankAimSprite.removeAllChildren(),
gameOJ.player.tankAimSprite.addChild(e)),
gameOJ.player.tankAimSprite.visible=gameOJ.playerControl.touchAim}
2===gameOJ.playerControl.spaceSkill.a&&gameOJ.shootSkill()}if(gameOJ.player){let e
;gameOJ.stage2.getChildAt(gameOJ.staticValues.alertLayerNumer).getChildAt(2);e=gameOJ.player,
gameOJ.moveCamera(e.tankPoint.x,e.tankPoint.y)}null!==gameOJ.player&&gameOJ.moveTurret()}
0!==gameOJ.gameEnd.endCode&&(gameOJ.createFinishMenu(),gameOJ.gameEnd.endCode=0,
gameOJ.gameEnd.winTeam=null,gameOJ.gameEnd.reward=null,gameOJ.gameEnd.isEnd=!1,gameOJ.gameTime=0,
gameOJ.skillValue.k1.countdown=0)},updateData:function(e){
if(2===gameOJ.gameTT&&gameOJ.gameNN>0&&null!==gameOJ.currentMap){var t=Date.now();if(null!==e.Y){
for(var a=0;a<e.Y.length;a++){update_player=e.Y[a];var i,n=gameOJ.findPlayer(update_player.p)
;if(-1===n){gameOJ.addPlayer(update_player.x,update_player.y,update_player.p)
;let e=gameOJ.playerList[gameOJ.playerList.length-1];e.removed=t,e.moveSpeed=update_player.s,
e.updateVisible(!0),n=gameOJ.playerList.length-1,i=e}else i=gameOJ.playerList[n],
i.updateVisible(!0)&&i.tankVisible&&(i.changePosition(update_player.x,update_player.y),
i.showTank()),
i.addNewPosition(update_player.x,update_player.y,update_player.m,update_player.moveAngle),
gameOJ.player===i&&i.tankAimSprite.visible||i.moveTurret(update_player.g),
i.updateEffects(update_player.e),i.lastShootTime=update_player.reload,i.tankHP=update_player.t,
i.moveSpeed=update_player.s,i.removed=t
;null===gameOJ.player&&Boolean(gameOJ.playerID)&&gameOJ.playerList[n].playerID===gameOJ.playerID&&(gameOJ.player=gameOJ.playerList[n],
gameOJ.player.tankHpBar.getChildAt(2).sourceRect.y-=10,
gameOJ.player.tankReloadBar.getChildAt(0).sourceRect.y=40,
gameOJ.player.tankReloadBar.getChildAt(1).sourceRect.y=50,
gameOJ.stage2.removeChildAt(gameOJ.stage2.numChildren-1),gameOJ.createInGameMenu(),
gameOJ.buildTimeText())}
null!==gameOJ.userNameUpdateList&&(gameOJ.userNameUpdateList=gameOJ.updateUsername(gameOJ.userNameUpdateList)),
null!==gameOJ.dataTeam&&(gameOJ.updateTeam(gameOJ.dataTeam),gameOJ.dataTeam=null),
null!==gameOJ.tankStyleUpdateList&&(gameOJ.tankStyleUpdateList=gameOJ.updateNewTankStyle(gameOJ.tankStyleUpdateList)),
gameOJ.unknownData.scoreListValue.length>0&&gameOJ.updateScoreListData()}
if(null!==e.E)for(a=0;a<e.E.length;a++){var l;update_enemy=e.E[a]
;var r=gameOJ.findEnemy(update_enemy.p);if(-1===r){
gameOJ.addEnemy(update_enemy.x,update_enemy.y,update_enemy.p,"bot",update_enemy.style)
;let e=gameOJ.enemyList[gameOJ.enemyList.length-1];e.removed=t,e.moveSpeed=update_enemy.s,
e.tankHP=update_enemy.t,
e.updateVisible(!0),update_enemy.team===gameOJ.playerTeam?(e.team=update_enemy.team,
e.tankHpBar.getChildAt(2).sourceRect.y=80,e.tankReloadBar.getChildAt(0).sourceRect.y=40,
e.tankReloadBar.getChildAt(1).sourceRect.y=50):e.team=update_enemy.team,
"2"===e.tankStyle&&e.tankBaseSprite.gotoAndPlay("item"+e.tankHP),l=e}else l=gameOJ.enemyList[r],
l.updateVisible(!0)&&l.tankVisible&&(l.changePosition(update_enemy.x,update_enemy.y),l.showTank())
;l.addNewPosition(update_enemy.x,update_enemy.y,update_enemy.m,update_enemy.moveAngle),
l.moveTurret(update_enemy.g),l.updateEffects(update_enemy.e),l.lastShootTime=update_enemy.reload,
l.countdown=update_enemy.reload>l.countdown?update_enemy.reload:l.countdown,
l.tankMaxHP=update_enemy.t>l.tankMaxHP?update_enemy.t:l.tankMaxHP,l.tankHP=update_enemy.t,
l.moveSpeed=update_enemy.s,l.removed=t}if(null!==e.HE)for(a=0;a<e.HE.length;a++){
r=gameOJ.findEnemy(e.HE[a]);-1!==r&&(gameOJ.enemyList[r].removed=0)}
if(null!==e.B)for(a=0;a<e.B.length;a++){var s=e.B[a],o=gameOJ.findBullet(s.i);if(-1===o){
var m=gameOJ.player||{tankPoint:{x:0,y:0}};if(gameOJ.addBullet(s.x,s.y,s.r,s.p,s.i,s.s),
gameOJ.bulletList[gameOJ.bulletList.length-1].removed=t,
gameOJ.playSound(gameOJ.bulletInfor[s.s].sound,Math.abs(m.tankPoint.x-s.x),Math.abs((m.tankPoint.y||0)-s.y),gameOJ.gameNN+s.p),
gameOJ.addEffect(s.x,s.y,s.r+90,"17"),s.n&&"3_1"!=s.s){if("e"!==s.p.charAt(s.p.length-1)){
n=gameOJ.findPlayer(s.p);var g=gameOJ.playerList}else n=gameOJ.findEnemy(s.p),g=gameOJ.enemyList
;if(-1!==n){let e=g[n];e.tankTurretSprite.gotoAndPlay(e.objectType+e.tankStyle+"s")}}
}else gameOJ.bulletList[o].removed=t}if(null!==e.H)for(a=0;a<e.H.length;a++){
n=gameOJ.findPlayer(e.H[a]);-1!==n&&gameOJ.playerList[n].updateVisible(!1)}
Boolean(e.e)&&gameOJ.applyEffect(e.e),null!==gameOJ.dataDead&&(gameOJ.updateDead(gameOJ.dataDead),
gameOJ.dataDead=null),gameOJ.pingtime=t,gameOJ.moveTankData.Y=null,gameOJ.moveTankData.B=null,
gameOJ.moveTankData.H=null,gameOJ.moveTankData.E=null,gameOJ.moveTankData.HE=null}},
applyEffect:function(e,t=!0){if(2===gameOJ.gameTT&&null!==gameOJ.currentMap){
var a,i=e.split(";"),n=0;for(i.length--;Boolean(a=i[n]);){let e=a.split(",")
;"I"===e[0]?gameOJ.addItem(parseInt(e[1]),parseInt(e[2]),parseInt(e[3]),e[4]):"RI"===e[0]?gameOJ.removeItem(e[1]):"E"===e[0]&&t?gameOJ.addEffect(parseInt(e[1]),parseInt(e[2]),parseInt(e[3]),e[4]):"E"!==e[0]&&gameOJ.changeMapCanvas("map"+e[0]+"Layer",parseInt(e[1]),parseInt(e[2]),parseInt(e[3]),parseInt(e[4])),
n++}}},saveTankData:function(e){gameOJ.moveTankData.Y=e,gameOJ.updateData(gameOJ.moveTankData)},
saveBulletData:function(e){gameOJ.moveTankData.B=e,gameOJ.updateData(gameOJ.moveTankData)},
saveEnemyData:function(e){gameOJ.moveTankData.E=e,gameOJ.updateData(gameOJ.moveTankData)},
saveHideTankData:function(e){gameOJ.moveTankData.H=e,gameOJ.updateData(gameOJ.moveTankData)},
saveHideEnemyData:function(e){gameOJ.moveTankData.HE=e,gameOJ.updateData(gameOJ.moveTankData)},
saveUpdateUserName:function(e){2===gameOJ.gameTT&&(gameOJ.userNameUpdateList=e)},
saveUpdateTankStyle:function(e){2===gameOJ.gameTT&&(gameOJ.tankStyleUpdateList=e)},
savePlayerID:function(e){2===gameOJ.gameTT&&(gameOJ.playerID=e)},saveDataTeam:function(e){
null!==gameOJ.dataTeam?(gameOJ.dataTeam.data=gameOJ.dataTeam.data.concat(e.data),
gameOJ.dataTeam.isFull=gameOJ.dataTeam.isFull||e.isFull):gameOJ.dataTeam=e},
saveDeadData:function(e){gameOJ.dataDead=e},saveDetroyedBullet:function(e){
for(var t=0;t<e.length;t++){var a=gameOJ.findBullet(e[t]);-1!==a&&(gameOJ.bulletList[a].removed=0)}
},saveLogoutPlayer:function(e){for(var t=0;t<e.length;t++){var a=gameOJ.findPlayer(e[t])
;-1!==a&&(gameOJ.playerList[a].removed=0)}},updateTeam:function(e){let t=e.data
;e.isFull&&(gameOJ.teamSort.length=0);for(var a=0;a<t.length;a++){
var i=t[a],n=gameOJ.findPlayer(i.playerID);if(-1!==n){let e=gameOJ.playerList[n]
;i.teamID===gameOJ.playerTeam&&e!==gameOJ.player?(e.team=i.teamID,
e.tankHpBar.getChildAt(2).sourceRect.y=80,e.tankReloadBar.getChildAt(0).sourceRect.y=40,
e.tankReloadBar.getChildAt(1).sourceRect.y=50):e.team=i.teamID
;let t=-1===gameOJ.teamSort.indexOf(i.teamID);t&&gameOJ.teamSort.push(i.teamID)}}},
updateDead:function(e){for(var t=0;t<e.length;t++){var a=e[t],i=gameOJ.findPlayer(a.playerId)
;if(-1!==i){let e=gameOJ.playerList[i];e.updateVisible(!1),e.movePointList=[],e.targetMove={
baseRotaion:null,tankPosition:null,turretRotation:null
},e===gameOJ.player&&(gameOJ.player.comboKill=0,
gameOJ.stage2.getChildAt(gameOJ.staticValues.alertLayerNumer).getChildAt(2).countdown=parseInt(a.time))
}}},updateStatus:function(e){2===gameOJ.gameTT&&(gameOJ.gameEnd.endCode=e.endCode,
gameOJ.gameEnd.winTeam=e.winTeam,gameOJ.gameEnd.reward=e.reward)},updateSkillIcon:function(e){
gameOJ.stage2.getChildAt(gameOJ.staticValues.alertLayerNumer).getChildAt(1).getChildAt(1).gotoAndStop("skill"+e)
},updateSkill:function(e){for(var t=0;t<e.length;t++){var a=e[t];a.index
;gameOJ.updateSkillCountdown(a.countDown)}},updateSlot:function(e){for(let t=0;t<e.length;t++){
let a=gameOJ.findPlayer(e[t].playerID);if(-1!==a){let i=gameOJ.playerList[a]
;if(i.slot=0===e[t].slotList[0]?[]:e[t].slotList,i===gameOJ.player){
let a=gameOJ.stage2.getChildAt(gameOJ.staticValues.alertLayerNumer).getChildAt(5).getChildAt(1),n=gameOJ.stage2.getChildAt(gameOJ.staticValues.alertLayerNumer).getChildAt(6)
;for(let e=0,t=a.numChildren;e<t;e++)e<i.slot.length?(a.getChildAt(e).gotoAndPlay("slot"+i.slot[e]),
a.getChildAt(e).visible=!0):a.getChildAt(e).visible=!1
;let l=gameOJ.stage2.getChildAt(gameOJ.staticValues.alertLayerNumer).getChildAt(5).getChildAt(2)
;for(let a=0,n=i.unlimitSlot.length,r=e[t].unlimitSlot;a<n;a++){let e=l.getChildAt(a)
;i.unlimitSlot[a]=r[a]||0,e.text!==i.unlimitSlot[a]+""&&gameOJ.buildText(i.unlimitSlot[a]+"",5,e)}
n.removeAllChildren()
;let r=-40,s=i.slot.length>=5,o=gameOJ.stage2.getChildAt(gameOJ.staticValues.alertLayerNumer).getChildAt(5).getChildAt(3)
;for(let e=3;e<gameOJ.slotInfor.length;e++){let t=gameOJ.slotInfor[e]
;if(!i.canBuildSlot(t.id)||s&&0===t.giveSlot)o.getChildAt(t.id-4).buildCon.getChildAt(4).gotoAndPlay("installOff");else{
let e=n.saveChild[t.id-4]
;e.y=r+=30,n.addChild(e),o.getChildAt(t.id-4).buildCon.getChildAt(4).gotoAndPlay("install")}}
if(n.numChildren>0){
let e=new createjs.Container,t=new createjs.Sprite(gameOJ.SpriteSheetList.icon,"buildBack")
;t.alpha=.5,e.addChild(t,new createjs.Sprite(gameOJ.SpriteSheetList.icon,"closeIcon")),
e.x=n.getChildAt(0).x+30,e.y=n.getChildAt(0).y,n.addChild(e),e.on("mousedown",()=>{
n.removeAllChildren()})}}if(!0===i.tankVisible){let a=e[t].updateItem
;if(0!==a[0])for(let e=0,t=a.length;e<t;e++)gameOJ.addEffect(i.tankPoint.x,i.tankPoint.y,0,"item",!1,new createjs.Sprite(gameOJ.SpriteSheetList.item,"slot"+a[e]))
}i.tankSlotBar.removeAllChildren(),i.tankSlotBar.x=-i.tankSlotBar.scaleX*(13*(i.slot.length-1)+25)
;for(let e=0,t=i.slot.length;e<t;e++){
let t=i.slot[e],a=new createjs.Sprite(gameOJ.SpriteSheetList.item,"slot"+t);a.x=22*e,
i.tankSlotBar.addChild(a)}}}},updateDeadCountdown:function(e){if(0===gameOJ.gameTime)return
;var t=gameOJ.stage2.getChildAt(gameOJ.staticValues.alertLayerNumer).getChildAt(2)
;if(t.countdown-=e,t.countdown<0)return t.countdown=0,void(t.visible=!1);t.visible=!0
;let a=~~(t.countdown/1e3)+"",i=Math.max(t.numChildren,a.length)
;for(var n=0;n<i;n++)if(n<t.numChildren&&n<a.length)t.getChildAt(n).gotoAndStop("c"+a.charAt(n));else if(n>=t.numChildren){
let e=new createjs.Sprite(gameOJ.SpriteSheetList.font_whi,"c"+a.charAt(n));t.addChild(e)
}else n>=a.length&&t.removeChildAt(n)},updateSkillCountdown:function(e){if(0!==gameOJ.gameTime){
e<=0&&(e=0),gameOJ.skillValue.k1.countdown=e
;var t=~~(parseInt(e)/1e3)+"",a=gameOJ.stage2.getChildAt(gameOJ.staticValues.alertLayerNumer).getChildAt(1).getChildAt(2),i=Math.max(t.length,a.numChildren)
;a.visible=e>0
;for(var n=0;n<i;n++)if(n<a.numChildren)a.getChildAt(n).gotoAndStop("c"+t.charAt(n));else if(n>=a.numChildren){
let e=new createjs.Sprite(gameOJ.SpriteSheetList.font_whi);e.gotoAndStop("c"+t.charAt(n)),e.x=10*n,
a.addChild(e)}else n>=t.length&&a.removeChildAt(n)}},saveScore:function(e){if(2===gameOJ.gameTT){
var t,a=0;for(gameOJ.scoreList.teamPoint=e.teamPoint;t=e.scoreList[a];){
var i=gameOJ.scoreList.value.findIndex(e=>e.playerID===t.playerID);if(-1!==i){
let e=gameOJ.scoreList.value[i].player
;e!==gameOJ.player?e.killPoint=t.point:gameOJ.player.updateKillPoint(t.point),e.deadPoint=t.d,
gameOJ.scoreList.updated=!0,gameOJ.scoreList.redraw=!0}else{let e=gameOJ.findPlayer(t.playerID)
;i=gameOJ.scoreList.value.push({playerID:t.playerID,player:-1===e?null:gameOJ.playerList[e],
draftPoint:t.point,draftDead:t.d})-1,gameOJ.scoreList.updated=!0,gameOJ.scoreList.redraw=!0,
-1===e&&gameOJ.unknownData.scoreListValue.push(gameOJ.scoreList.value[i])}for(;i>0;){
let e=gameOJ.scoreList.value[i-1],a=null!==e.player?e.player.killPoint:e.draftPoint
;if(t.point<=a)break
;gameOJ.scoreList.value[i-1]=gameOJ.scoreList.value[i],gameOJ.scoreList.value[i]=e,i-=1}a++}}},
updateUsername:function(e){if(2===gameOJ.gameTT){for(var t=[],a=0;a<e.length;a++){
var i=e[a],n=gameOJ.findPlayer(i.playerID)
;-1!==n?gameOJ.playerList[n].updateNickName(i.playerName):t.push(i)}return t.length>0?t:null}
return null},updateNewTankStyle:function(e){if(2===gameOJ.gameTT){for(var t=[],a=0;a<e.length;a++){
var i=e[a],n=gameOJ.findPlayer(i.p);if(-1!==n){var l=gameOJ.playerList[n];l.updateTankStyle(i.s),
gameOJ.player===l&&(l.setTankAim(l.tankStyle),gameOJ.updateSkillIcon(l.tankStyle+"_1"))
}else t.push(i)}return t.length>0?t:null}return null},getAndBuildMap:function(e){
2===gameOJ.gameTT&&gameOJ.createMap(e.mapName)},joinGame:function(e){
gameOJ.Socket.emit("join-game",{userName:e,tankStyle:""+gameOJ.pickedTank})},movePlayer:function(e){
null!==gameOJ.player&&gameOJ.Socket.emit(gameOJ.socketName.moveTank,e)},moveTurret:function(){
gameOJ.gameNN},shootBullet:function(){if(null!==gameOJ.player){var e=gameOJ.player.shoot()
;gameOJ.Socket.emit(gameOJ.socketName.shootBullet,Math.round(e))}},shootSkill:function(){
null!==gameOJ.player&&(gameOJ.Socket.emit(gameOJ.socketName.shootSkill,{
t:gameOJ.playerControl.spaceSkill.t,r:Math.round(gameOJ.playerControl.spaceSkill.r),
p:gameOJ.playerControl.spaceSkill.p}),gameOJ.playerControl.spaceSkill.a=0)},buildItem:function(e){
null!==gameOJ.player&&gameOJ.Socket.emit(gameOJ.socketName.buildItem,e)},leaveMatch:function(){
gameOJ.Socket.emit("leave-match","ok")},createControl:function(){
gameOJ.playerControl=new gameOJ.GameControl}};(function(){function e(e,t,a,i="@",n="tank"){
this.tankMaxHP=500,this.countdown=300,this.timeNowServer=0,this.nextBullet="1",this.tankRSize=15,
this.killPoint=0,this.comboKill=0,this.deadPoint=0,this.slot=[],this.unlimitSlot=[0,0,0],
this.canUpSlot=[],this.lastShootTime=0,this.tankPoint=new KhoiTest._Point(e,t),this.tankVisible=!0,
this.gunAngle=0,this.tankHP=500,this.moveSpeed=1.5,this.playerName=i,this.tankStyle="1",
this.playerID=a,this.removed=1,this.movePointList=[],this.team="",this.objectType=n,
this.targetMove={baseRotaion:null,tankPosition:null,turretRotation:null
},this.tankAimSprite=new createjs.Container,this.tankEffectSprite=new createjs.Container,
this.tankNickSprite=gameOJ.buildText(this.playerName,10*this.playerName.length),
this.tankBaseSprite=new createjs.Sprite(gameOJ.SpriteSheetList.TankBase,"tank"+this.tankStyle),
this.tankTurretSprite=new createjs.Sprite(gameOJ.SpriteSheetList.TankTurret,"tank"+this.tankStyle),
this.tankHpBar=new createjs.Container,this.tankReloadBar=new createjs.Container,
this.tankSlotBar=new createjs.Container,this.tankGraphic=new createjs.Container,
this.tankGraphic.addChild(this.tankBaseSprite,this.tankTurretSprite,this.tankAimSprite,this.tankEffectSprite,this.tankNickSprite,this.tankHpBar,this.tankReloadBar,this.tankSlotBar),
this.tankBaseSprite.regX=this.tankBaseSprite.regY=16,
this.tankTurretSprite.regX=this.tankTurretSprite.regY=16;var l=10*this.playerName.length
;this.tankNickSprite.regX=l/2,this.tankNickSprite.regY=15
;var r=new createjs.Bitmap(gameOJ.loadMC.getAsset("hpbar")),s=new createjs.Bitmap(gameOJ.loadMC.getAsset("hpbar")),o=new createjs.Bitmap(gameOJ.loadMC.getAsset("hpbar"))
;s.x=1,
o.x=1,r.sourceRect=new createjs.Rectangle(0,0,30,10),s.sourceRect=new createjs.Rectangle(0,30,30,10),
o.sourceRect=new createjs.Rectangle(0,10,30,10),
this.tankHpBar.addChild(r,o,s),this.tankHpBar.regX=15,this.tankHpBar.regY=30
;var m=new createjs.Bitmap(gameOJ.loadMC.getAsset("hpbar")),g=new createjs.Bitmap(gameOJ.loadMC.getAsset("hpbar"))
;g.x=1,
m.sourceRect=new createjs.Rectangle(0,60,30,10),g.sourceRect=new createjs.Rectangle(0,70,30,10),
this.tankReloadBar.addChild(m,g),this.tankReloadBar.regX=15,this.tankReloadBar.regY=5,
this.tankReloadBar.y=-31,this.tankReloadBar.visible=!1,this.tankAimSprite.visible=!1,
this.tankAimStore=[];let c=new createjs.Sprite(gameOJ.SpriteSheetList.effect_p,"effect1")
;c.visible=!1,c.regX=c.regY=25,c.effectType=1
;let d=new createjs.Sprite(gameOJ.SpriteSheetList.effect_p,"effect2");d.visible=!1,d.regX=d.regY=25,
d.alpha=.5,d.effectType=2;let h=new createjs.Container;h.visible=!1,h.effectType=3
;let u=new createjs.Sprite(gameOJ.SpriteSheetList.effect_p,"effect3");u.visible=!1,u.regX=u.regY=25,
u.effectType=4;let p=new createjs.Sprite(gameOJ.SpriteSheetList.effect_p,"effect4");p.visible=!1,
p.regX=p.regY=25,p.alpha=.5,p.effectType=5;let O=new createjs.Container;O.visible=!1,O.effectType=6
;let J=new createjs.Sprite(gameOJ.SpriteSheetList.effect_p,"effect5");J.visible=!1,J.regX=J.regY=25,
J.alpha=.5,J.effectType=7;let f=new createjs.Sprite(gameOJ.SpriteSheetList.effect_p,"effect6")
;f.visible=!1,f.regX=f.regY=25,f.alpha=1,f.effectType=8;let y=new createjs.Container;y.effectType=9
;let S=new createjs.Sprite(gameOJ.SpriteSheetList.effect_p,"effect10");S.visible=!1,
S.regX=S.regY=25,S.alpha=.5,S.effectType=10
;let k=new createjs.Sprite(gameOJ.SpriteSheetList.effect_p,"effect11");k.visible=!1,
k.regX=k.regY=25,
k.alpha=.6,k.effectType=11,this.effectSpriteStore=[],this.effectSpriteStore.push(c,d,h,u,p,O,J,f,y,S,k),
this.tankSlotBar.y=-58,
this.tankSlotBar.scaleX=this.tankSlotBar.scaleY=.7,this.changePosition(e,t,l,15),
this.changeTurretRotation(this.gunAngle)}var t=e.prototype;t.moveTo=function(e,t,a,i=-1){
var n=new KhoiTest._Point(e,t)
;if(i<0)var l=Math.max(this.moveSpeed,this.tankPoint.lengP(n)/5);else l=i
;var r=this.tankPoint.angleP(n);this.updateHistoryMove(a),this.targetMove.tankPosition={
targetPoint:n,stepValue:l,angle:r}},t.updateEffects=function(e){
if("enemy"!==this.objectType||"2"!==this.tankStyle){for(var t=[],a=0;a<e.length;a++){
var i=e[a],n=this.effectSpriteStore[i-1];t[i]=!0,6===i&&(this.tankGraphic.alpha=.6),
n.visible||(this.tankEffectSprite.addChild(n),
n.visible=!0,Boolean(gameOJ.Sound["peffect"+i])&&gameOJ.playSound("peffect"+ +i,Math.abs(this.tankPoint.x-gameOJ.player.tankPoint.x),Math.abs(this.tankPoint.y-gameOJ.player.tankPoint.y)))
}for(var l=0;l<this.tankEffectSprite.numChildren;l++){var r=this.tankEffectSprite.getChildAt(l)
;Boolean(t[r.effectType])||(r.visible=!1,
6===r.effectType?this.tankGraphic.alpha=1:8===r.effectType&&this===gameOJ.player&&(gameOJ.playerControl.touchCode=-1),
this.tankEffectSprite.removeChildAt(l),l--)}}},t.updateVisible=function(e){
if(e===this.tankVisible)return!1;if(this.tankVisible=e,!e){var t={x:0,y:0}
;0===this.movePointList.length?(t.x=this.tankPoint.x+1,
t.y=this.tankPoint.y+1):(t.x=this.movePointList[this.movePointList.length-1].x,
t.y=this.movePointList[this.movePointList.length-1].y),this.hideTank()}return!0},
t.updateKillPoint=function(e){var t=this,a=e-this.killPoint;this.killPoint=e,this.comboKill+=a,
a>0&&gameOJ.displayKillIcon(t.comboKill)},t.showTank=function(){this.tankGraphic.visible=!0},
t.hideTank=function(){this.tankGraphic.visible=!1,this.targetMove.tankPosition=null,
this.movePointList.length=0},t.addNewPosition=function(e,t,a,i=0){
1===this.movePointList.length&&this.movePointList[0].reuse&&(this.targetMove.tankPosition=null),
this.movePointList.push({x:e,y:t,moveCode:a,reuse:!1,moveAngle:i})
},t.updateNickName=function(e,t=null){if(this.playerName!==e){this.playerName=e,
gameOJ.buildText(e,10*e.length,this.tankNickSprite);var a=10*e.length;this.tankNickSprite.regX=a/2,
this.tankNickSprite.regY=40,this.tankNickSprite.scaleY=1.5}},t.updateTankStyle=function(e){
this.tankStyle=e,
this.tankBaseSprite.gotoAndPlay("tank"+e),this.tankTurretSprite.gotoAndPlay("tank"+e),
"1"===e?(this.countdown=750,this.nextBullet="1",this.tankHP=500-this.tankMaxHP+this.tankHP,
this.tankMaxHP=500,this.tankRSize=15):"2"===e?(this.countdown=1e3,this.nextBullet="2",
this.tankHP=700-this.tankMaxHP+this.tankHP,
this.tankMaxHP=700,this.tankRSize=15):"3"===e&&(this.countdown=1e3,this.nextBullet="3",
this.tankHP=500-this.tankMaxHP+this.tankHP,this.tankMaxHP=500,this.tankRSize=15)},
t.setTankAim=function(e){let t=new createjs.Shape
;if(t.graphics.beginFill("#EEEEEE").drawRect(0,0,20,280),t.regY=295,t.regX=10,t.alpha=.3,
t.cache(0,0,20,280),"1"===e){let e=new createjs.Shape
;e.graphics.beginFill("#2300f5").drawRect(0,0,20,280),e.regY=295,e.regX=10,e.alpha=.3,
e.cache(0,0,20,280),this.tankAimStore.push(t,e)}else if("2"===e){let e=new createjs.Shape
;e.graphics.s("#2300f5").drawCircle(0,0,30),e.regY=0,e.regX=0,e.alpha=.2,e.cache(-30,-30,60,60),
this.tankAimStore.push(t,e)}else if("3"===e){let e=new createjs.Shape
;e.graphics.beginFill("#2300f5").drawRect(0,0,20,280),e.regY=295,e.regX=10,e.alpha=.3,
e.cache(0,0,20,280),this.tankAimStore.push(t,e)}else if("4"===e){let e=new createjs.Shape
;e.graphics.sd([2,2]).setStrokeStyle(2).beginStroke("red").drawRect(0,0,3,gameOJ.gameW),
e.regY=gameOJ.gameW+15,e.regX=1,e.alpha=.5,e.cache(0,0,3,gameOJ.gameW),this.tankAimStore.push(t,e)}
},t.applyNewPosition=function(e){var t,a=-1
;if(this.movePointList.length>10&&(this.movePointList=[this.movePointList[this.movePointList.length-1],this.movePointList[this.movePointList.length-2]],
this.changePosition(this.movePointList[0].x,this.movePointList[0].y)),
0!==this.movePointList.length){
if(1===this.movePointList.length&&-1===this.movePointList[0].moveCode)return this.movePointList.shift(),
void(this.targetMove.tankPosition=null);if(1===this.movePointList.length){
if(t=this.movePointList[0],null!==this.targetMove.tankPosition){
let e=8!==t.moveCode?45*(t.moveCode-2):t.moveAngle
;newPoint=this.tankPoint.moveT(66*this.moveSpeed,e),t.x=newPoint.x,t.y=newPoint.y,a=this.moveSpeed,
t.reuse=!0}}else this.movePointList.length>1&&(this.movePointList.shift(),t=this.movePointList[0])
;this.moveTo(t.x,t.y,t.moveCode,a)}else this.targetMove.tankPosition=null
},t.shootFakeBullet=function(e){var t=this.timeNowServer;this.gunAngle=e
;var a=this.tankPoint.moveT(16,e-90);return gameOJ.addBullet(a.x,a.y,e,this.playerID,"1","fake",!0),
gameOJ.bulletList[gameOJ.bulletList.length-1].removed=gameOJ.pingtime,this.lastShootTime=t,!0},
t.changePosition=function(e,t){this.tankPoint.setV(e,t),this.tankGraphic.x=e,this.tankGraphic.y=t},
t.updateBloodBar=function(){
this.tankHpBar.getChildAt(2).sourceRect.x=30-this.tankHP/this.tankMaxHP*30,
this.tankHpBar.getChildAt(1).sourceRect.x<this.tankHpBar.getChildAt(2).sourceRect.x?this.tankHpBar.getChildAt(1).sourceRect.x+=1:this.tankHpBar.getChildAt(1).sourceRect.x=this.tankHpBar.getChildAt(2).sourceRect.x
},t.moveTurret=function(e){var t=e,a=this.tankTurretSprite.rotation,i=1
;if(Math.abs(a-t)<1e-4)this.tankTurretSprite.rotation=t;else{if(a<180)var n=a+180,l=a,r=1;else n=a,
l=a-180,r=-1
;t>=l&&t<n?i*=r:i=-i*r,i*=i>0&&t<a?Math.abs(360-a+t)/5:i<0&&t>a?Math.abs(360-t+a)/5:Math.abs(a-t)/5,
this.targetMove.turretRotation={value:t,stepValue:i}}},t.changeTurretRotation=function(e){
e<0?e+=360:e>360&&(e%=360),this.gunAngle=e,this.tankTurretSprite.rotation=e
},t.updateHistoryMove=function(e){if(-1!==e&&8!==e&&this.tankBaseSprite.rotation!==45*e){
var t=45*e,a=5,i=this.tankBaseSprite.rotation;if(i<180)var n=i+180,l=i,r=1;else n=i,l=i-180,r=-1
;t>=l&&t<n?a*=r:a=-a*r,this.targetMove.baseRotaion={value:t,stepValue:a}
}else this.targetMove.baseRotaion=null},t.shoot=function(){return this.gunAngle},
t.updateShootTime=function(e){
0!==this.lastShootTime&&(this.lastShootTime-=e,this.tankReloadBar.visible=!0,
this.tankReloadBar.getChildAt(1).sourceRect.width=30*(this.countdown-this.lastShootTime)/this.countdown,
this.lastShootTime<=0&&(this.lastShootTime=0,this.tankReloadBar.visible=!1))
},t.countSlot=function(e,t=100,a=[]){if(e<4)return Math.min(this.unlimitSlot[e-1],t);var i=0,n=0
;return this.slot.findIndex(l=>(l===e&&a.push(n)&&i++,n++,i===t)),i},t.canBuildSlot=function(e){
let t=gameOJ.getSlotInfor(e-1);if(null===t||0===t.build.length)return!1
;for(let e=0;e<t.build.length;e++){let a=t.build[e];if(this.countSlot(a.id,a.cost)<a.cost)return!1}
return!0},t.Tick=function(e){
if(this.updateBloodBar(),null!==this.targetMove.baseRotaion&&(this.tankBaseSprite.rotation+=this.targetMove.baseRotaion.stepValue,
this.tankBaseSprite.rotation<0?this.tankBaseSprite.rotation=360+this.tankBaseSprite.rotation:this.tankBaseSprite.rotation>=360&&(this.tankBaseSprite.rotation=this.tankBaseSprite.rotation%360),
Math.abs(this.tankBaseSprite.rotation+this.targetMove.baseRotaion.stepValue-this.targetMove.baseRotaion.value)<Math.abs(this.targetMove.baseRotaion.stepValue)?(this.tankBaseSprite.rotation=this.targetMove.baseRotaion.value,
this.targetMove.baseRotaion=null):this.tankBaseSprite.rotation===this.targetMove.baseRotaion.value&&(this.targetMove.baseRotaion=null)),
null!==this.targetMove.tankPosition){
var t=this.tankPoint.lengP(this.targetMove.tankPosition.targetPoint),a=e<16.7?e/16.7:1;a=1
;if(t>this.targetMove.tankPosition.stepValue*a){
var i=this.tankPoint.moveT(this.targetMove.tankPosition.stepValue*a,this.targetMove.tankPosition.angle)
;this.changePosition(i.x,i.y)
}else this.changePosition(this.targetMove.tankPosition.targetPoint.x,this.targetMove.tankPosition.targetPoint.y),
this.applyNewPosition(t)}else this.applyNewPosition();if(null!==this.targetMove.turretRotation){
var n=this.tankTurretSprite.rotation
;this.changeTurretRotation(this.tankTurretSprite.rotation+this.targetMove.turretRotation.stepValue)
;var l=1
;this.tankTurretSprite.rotation<0?(this.changeTurretRotation(360+this.tankTurretSprite.rotation),
l=-1):this.tankTurretSprite.rotation>=360&&(this.changeTurretRotation(this.tankTurretSprite.rotation%360),
l=-1),
(Math.abs(this.tankTurretSprite.rotation+this.targetMove.turretRotation.stepValue-this.targetMove.turretRotation.value)<Math.abs(this.targetMove.turretRotation.stepValue)||this.tankTurretSprite.rotation===this.targetMove.turretRotation.value||l*(this.tankTurretSprite.rotation-this.targetMove.turretRotation.value)*(n-this.targetMove.turretRotation.value)<0)&&(this.changeTurretRotation(this.targetMove.turretRotation.value),
this.targetMove.turretRotation=null)}
this.tankAimSprite.rotation=gameOJ.playerControl.getAimRotation(this)},gameOJ.addCon("Player",e)
})(),function(){function e(e,t,a,i="@",n="1"){gameOJ.Player.call(this,e,t,a,i,"enemy"),
this.updateTankStyle(n),this.tankNickSprite.visible=!1,this.master=""}
gameOJ.KetThua(gameOJ.Player,e);var t=e.prototype;t.updateTankStyle=function(e="1"){
this.tankStyle=e,
"1"===e?(this.countdown=750,this.nextBullet="1",this.tankHP=100-this.tankMaxHP+this.tankHP,
this.tankMaxHP=100,
this.tankRSize=15,this.tankGraphic.removeAllChildren(),this.tankBaseSprite=new createjs.Sprite(gameOJ.SpriteSheetList.Enemy,"enemy1"),
this.tankTurretSprite=new createjs.Sprite(gameOJ.SpriteSheetList.EnemyTurret,"enemy1"),
this.tankBaseSprite.regX=this.tankBaseSprite.regY=25,
this.tankTurretSprite.regX=this.tankTurretSprite.regY=25,this.tankBaseSprite.gotoAndPlay("tank"+e),
this.tankTurretSprite.gotoAndPlay("tank"+e),
this.tankGraphic.addChild(this.tankBaseSprite,this.tankTurretSprite,this.tankHpBar,this.tankReloadBar)):"2"===e&&(this.countdown=750,
this.nextBullet="1",this.tankHP=100-this.tankMaxHP+this.tankHP,this.tankMaxHP=100,this.tankRSize=15,
this.tankBaseSprite=new createjs.Sprite(gameOJ.SpriteSheetList.item,"item1"),
this.tankBaseSprite.regX=this.tankBaseSprite.regY=25,this.tankTurretSprite.visible=!1,
this.tankGraphic.removeAllChildren(),this.tankGraphic.addChild(this.tankBaseSprite),
this.tankHpBar.visible=!1,this.tankEffectSprite.visible=!1)},gameOJ.addCon("Enemy",e)}(),function(){
function e(e,t,a,i,n,l,r=!1){this.bulletPoint=new KhoiTest._Point(e,t),this.bulletRotation=a,
this.playerID=i,this.bulletID=n,this.live=1,this.speed=gameOJ.bulletInfor[l].speed,
this.bulletStyle=l,
this.fake=r,this.removed=1,this.bulletSprite=new createjs.Sprite(gameOJ.SpriteSheetList.bullet,l),
this.bulletGraphic=new createjs.Container,this.bulletSprite.regX=25,this.bulletSprite.regY=25,
this.bulletSprite.rotation=this.bulletRotation+90,this.bulletGraphic.addChild(this.bulletSprite),
this.bulletGraphic.x=e,this.bulletGraphic.y=t}var t=e.prototype;t.moveTo=function(e,t){
this.changePosition(e,t)},t.changePosition=function(e,t){this.bulletPoint.setV(e,t),
this.bulletGraphic.x=e,this.bulletGraphic.y=t},t.Tick=function(){if(this.live){
var e=this.bulletPoint.moveT(this.speed,this.bulletRotation);this.changePosition(e.x,e.y)}},
gameOJ.addCon("Bullet",e)}(),function(){function e(e,t,a,i,n,l=!1,r=null){
this.effectPoint=new KhoiTest._Point(e,t),this.effectRotation=a,this.live=100,this.sortID=n,
this.style=i,
this.fixed=l,this.fixedRoot=null,this.targetMove=null,this.effectSprite=r||new createjs.Sprite(gameOJ.SpriteSheetList.effect,"effect"+i),
this.effectGraphic=new createjs.Container,this.effectSprite.regX=25,this.effectSprite.regY=25,
this.effectSprite.rotation=this.effectRotation,this.effectGraphic.addChild(this.effectSprite),
this.effectGraphic.x=e,this.effectGraphic.y=t;let s=this;var o
;"5"!==i&&"10"!=this.style&&"item"!=this.style&&this.effectSprite.on("animationend",()=>{
s.effectGraphic.visible=!1
}),"item"===this.style&&(this.live=30),Boolean(o=gameOJ.effectSound["effect"+i])&&gameOJ.playSound(o,Math.abs((Boolean(gameOJ.player)?gameOJ.player.tankPoint.x:0)-e),Math.abs((Boolean(gameOJ.player)?gameOJ.player.tankPoint.y:0)-t))
}var t=e.prototype;t.moveTo=function(e,t){this.changePosition(e,t)},t.changePosition=function(e,t){
this.effectPoint.setV(e,t),this.effectGraphic.x=e,this.effectGraphic.y=t},t.Tick=function(){
if(this.live&&(this.live--,
"5"!==this.style&&"10"!==this.style&&"3"!==this.style||(this.effectGraphic.alpha-=.01,
this.effectGraphic.scaleX+=.03,
this.effectGraphic.scaleY+=.03),"item"===this.style&&(this.effectGraphic.y--,
this.effectSprite.scaleX=this.effectSprite.scaleY+=.1,this.effectSprite.alpha-=.02),this.fixed)){
if(null===this.fixedRoot){this.fixedRoot={xp:this.effectGraphic.parent.x,
yp:this.effectGraphic.parent.y,xe:this.effectGraphic.x,ye:this.effectGraphic.y}
;let e=new KhoiTest._Point(this.effectGraphic.x+this.effectGraphic.parent.x,this.effectGraphic.y+this.effectGraphic.parent.y),t=new KhoiTest._Point(25,65)
;this.targetMove=e.angleP(t);let a=e.lengP(t)/6;this.live=~~a}
if(this.effectGraphic.x=this.fixedRoot.xe+(this.fixedRoot.xp-this.effectGraphic.parent.x),
this.effectGraphic.y=this.fixedRoot.ye+(this.fixedRoot.yp-this.effectGraphic.parent.y),
"item"===this.style){
let e=new KhoiTest._Point(this.fixedRoot.xe,this.fixedRoot.ye).moveT(6,this.targetMove)
;this.fixedRoot.xe=e.x,this.fixedRoot.ye=e.y}}},gameOJ.addCon("Effect",e)}(),function(){
function e(){
this.moveMap=[],this.moveMap.KeyDKeyW=this.moveMap.KeyWKeyD=1,this.moveMap.KeyDKeyS=this.moveMap.KeySKeyD=3,
this.moveMap.KeyAKeyS=this.moveMap.KeySKeyA=5,this.moveMap.KeyAKeyW=this.moveMap.KeyWKeyA=7,
this.moveMap.KeyW=0,this.moveMap.KeyD=2,this.moveMap.KeyS=4,this.moveMap.KeyA=6,this.moveStack=[],
this.touchCode=-1,this.fakeMouse=new KhoiTest._Point(0,0),this.touchShoot=!1,this.turretAim=!1,
this.touchAim=!1,this.aimSpriteIndex=0,this.aimSpriteRotationType=0,this.spaceSkill={t:1,r:0,p:"",
a:0},this.controlType=null,this.buildKeyEvent()}var t=e.prototype;t.buildKeyEvent=function(){
var e=this;document.onkeydown=function(t){if(null===e.controlType&&(e.controlType="key",
gameOJ.stage2.getChildAt(gameOJ.staticValues.controlLayerNumber).alpha=0,
gameOJ.stage2.getChildAt(gameOJ.staticValues.controlLayerNumber).hitArea=new createjs.Shape((new createjs.Graphics).beginFill("#ff0000").drawRect(0,0,gameOJ.gameW,gameOJ.gameH)),
gameOJ.stage2.getChildAt(gameOJ.staticValues.controlLayerNumber).on("mousedown",function(){
0===e.spaceSkill.a&&gameOJ.shootBullet()})),!t)t=window.event;if(2===gameOJ.gameTT){
if("KeyS"===t.code||"KeyD"===t.code||"KeyA"===t.code||"KeyW"===t.code){
if(-1!==e.moveStack.indexOf(t.code))return
;e.moveStack.push(t.code),gameOJ.movePlayer(e.buildMoveCode())}
if("KeyG"===t.code&&gameOJ.showAndHideBoard(!0),"Space"===t.code){if(e.spaceSkill.a)return
;e.spaceSkill.a=1,e.touchAim=!0,null!==gameOJ.player&&(e.spaceSkill.r=gameOJ.player.gunAngle),
this.aimSpriteRotationType=1}}},document.onkeyup=function(t){if(2===gameOJ.gameTT){
if("KeyS"===t.code||"KeyD"===t.code||"KeyA"===t.code||"KeyW"===t.code){
var a=e.moveStack.indexOf(t.code);e.moveStack.splice(a,1),gameOJ.movePlayer(e.buildMoveCode())}
"KeyG"===t.code&&gameOJ.showAndHideBoard(!1),"Space"===t.code&&(e.spaceSkill.a=2,e.touchAim=!1)}}
;var t=new createjs.Shape((new createjs.Graphics).setStrokeStyle(2).beginStroke("#000000").drawCircle(0,0,30)),a=new createjs.Shape((new createjs.Graphics).beginFill("#000000").drawCircle(0,0,10))
;t.x=50,
t.y=gameOJ.gameH-50,t.cache(-35,-35,70,70),t.hitArea=new createjs.Shape((new createjs.Graphics).setStrokeStyle(2).beginStroke("#000000").beginFill("#000000").drawCircle(0,0,30)),
a.x=t.x,a.y=t.y,a.cache(-20,-20,40,40)
;var i=new createjs.Shape((new createjs.Graphics).setStrokeStyle(2).beginStroke("#000000").drawCircle(0,0,30)),n=new createjs.Shape((new createjs.Graphics).beginFill("#000000").drawCircle(0,0,10))
;i.x=gameOJ.gameW-60,
i.y=gameOJ.gameH-60,i.cache(-45,-45,90,90),i.hitArea=new createjs.Shape((new createjs.Graphics).setStrokeStyle(2).beginStroke("#000000").beginFill("#000000").drawCircle(0,0,30)),
n.x=i.x,n.y=i.y,n.cache(-20,-20,40,40)
;var l=new createjs.Shape((new createjs.Graphics).setStrokeStyle(2).beginStroke("#000000").drawCircle(0,0,20)),r=new KhoiTest._Point(i.x,i.y).moveT(60,-80)
;l.x=r.x,
l.y=r.y,l.cache(-45,-45,90,90),l.hitArea=new createjs.Shape((new createjs.Graphics).setStrokeStyle(2).beginStroke("#000000").beginFill("#000000").drawCircle(0,0,20)),
gameOJ.stage2.getChildAt(gameOJ.staticValues.controlLayerNumber).addChild(t,a,i,n,l),
gameOJ.stage2.getChildAt(gameOJ.staticValues.controlLayerNumber).alpha=.5;let s={x:i.x,y:i.y},o={
x:l.x,y:l.y};t.on("pressmove",t=>{e.touchMoveEvent(t,e)}),t.on("mousedown",t=>{e.touchMoveEvent(t,e)
}),t.on("pressup",function(){a.x=t.x,a.y=t.y,gameOJ.movePlayer(-1),e.touchCode=-1}),
i.on("pressmove",t=>{e.touchTurretEvent(t,e)}),i.on("mousedown",t=>{if(null===gameOJ.player)return
;let a=new KhoiTest._Point(i.x+t.localX,i.y+t.localY).moveT(10,gameOJ.player.gunAngle+90);i.x=a.x,
i.y=a.y,n.x+=i.x-s.x,n.y+=i.y-s.y,e.touchTurretEvent(t,e)}),i.on("pressup",function(){i.x=s.x,
i.y=s.y,n.x=i.x,n.y=i.y,e.touchShoot=!0,e.turretAim=!1,e.touchAim=!1}),l.on("mousedown",t=>{
let a=new KhoiTest._Point(l.x+t.localX,l.y+t.localY).moveT(10,gameOJ.player.gunAngle+90);l.x=a.x,
l.y=a.y,e.touchSkillEvent(t,e,1)}),l.on("pressmove",t=>{e.touchSkillEvent(t,e,1)}),
l.on("pressup",function(){l.x=o.x,l.y=o.y,e.spaceSkill.a=2,e.touchAim=!1})
},t.mouseMoveEvent=function(e,t){
var a=gameOJ.stage2.getChildAt(gameOJ.staticValues.mapL1LayerNumber).getChildAt(0).sourceRect,i=e/gameOJ.gameSW+a.x,n=t/gameOJ.gameSH+a.y
;if(null!==gameOJ.player&&gameOJ.gameNN%1==0){
var l=new KhoiTest._Point(i,n),r=gameOJ.player.tankPoint.angleP(l)+90
;1===this.spaceSkill.a?(this.spaceSkill.r=r,this.spaceSkill.a=1,this.touchAim=!0,
this.aimSpriteIndex=1,this.aimSpriteRotationType=1):gameOJ.player.changeTurretRotation(r)}},
t.fakeMouseMoveEvent=function(e,t){if(null!==gameOJ.player&&this.turretAim){
var a=new KhoiTest._Point(e,t),i=gameOJ.player.tankPoint.angleP(a)+90
;gameOJ.player.changeTurretRotation(i)}},t.buildMoveCode=function(){
if(1===this.moveStack.length)return this.moveMap[this.moveStack[0]];if(this.moveStack.length>1){
var e=this.moveStack.length,t=this.moveMap[this.moveStack[e-1]+this.moveStack[e-2]]
;return Boolean(t)?t:this.moveMap[this.moveStack[e-1]]}return-1},t.clearMove=function(){
2===gameOJ.gameTT&&(this.moveStack=[],gameOJ.movePlayer(-1))},t.touchMoveEvent=function(e,t){
null===t.controlType&&(t.controlType="touch")
;var a=new KhoiTest._Point(0,0),i=new KhoiTest._Point(0,0),n=gameOJ.stage2.getChildAt(gameOJ.staticValues.controlLayerNumber).getChildAt(0),l=gameOJ.stage2.getChildAt(gameOJ.staticValues.controlLayerNumber).getChildAt(1)
;i.x=e.localX,i.y=e.localY;let r=a.angleP(i),s=a.lengP(i);if(s<=30)l.x=n.x+i.x,l.y=n.y+i.y;else{
let e=new KhoiTest._Point(n.x,n.y).moveT(30,r);l.x=e.x,l.y=e.y}let o=t.findTouchMoveCode(r)
;o!==t.touchCode&&(t.touchCode=o,gameOJ.movePlayer(o))},t.touchTurretEvent=function(e,t,a=!0){
null===t.controlType&&(t.controlType="touch")
;var i=new KhoiTest._Point(0,0),n=new KhoiTest._Point(0,0),l=gameOJ.stage2.getChildAt(gameOJ.staticValues.controlLayerNumber).getChildAt(2),r=gameOJ.stage2.getChildAt(gameOJ.staticValues.controlLayerNumber).getChildAt(3)
;n.x=e.localX,n.y=e.localY;let s=i.angleP(n),o=i.lengP(n);if(o>30){
let e=new KhoiTest._Point(l.x,l.y).moveT(30,s);r.x=e.x,r.y=e.y}else r.x=l.x+n.x,r.y=l.y+n.y
;t.turretAim=!0,t.touchAim=!0,t.aimSpriteIndex=0,t.aimSpriteRotationType=0,this.fakeMouse.x=n.x,
this.fakeMouse.y=n.y},t.touchSkillEvent=function(e,t,a){
null===t.controlType&&(t.controlType="touch")
;var i=new KhoiTest._Point(0,0),n=new KhoiTest._Point(0,0);n.x=e.localX,n.y=e.localY
;let l=i.angleP(n);i.lengP(n);1===a&&(t.spaceSkill.r=l+90,t.spaceSkill.a=1,t.touchAim=!0,
t.aimSpriteIndex=1,t.aimSpriteRotationType=1)},t.getAimRotation=function(e){
switch(this.aimSpriteRotationType){case 0:return e.gunAngle;case 1:return this.spaceSkill.r}},
t.findTouchMoveCode=function(e){
return e>=-112.5&&e<-67.5?0:e>=-67.5&&e<-22.5?1:e>=-22.5&&e<22.5?2:e>=22.5&&e<67.5?3:e>=67.5&&e<112.5?4:e>=112.5&&e<157.5?5:e>=157.5||e<-157.5?6:e>=-157.5&&e<-112.5?7:void 0
},gameOJ.addCon("GameControl",e)}();