var gameOJ={stage:null,stage1:null,stage2:null,loadMC:null,asset:null,Socket:null,gameW:0,gameH:0,
gameSW:0,gameSH:0,gameTT:0,gameNN:0,Sound:[],SoundMark:[],bulletList:[],playerList:[],enemyList:[],
effectList:[],scoreList:{value:[],updated:!1,redraw:!1,enemyPoint:0,teamPoint:0},schema:[],
slotInfor:null,currentMap:null,currentTheme:null,player:null,SpriteSheetList:[],AniL1NameList:[],
playerControl:null,pingtime:0,userNameInput:null,pickedTank:1,playerID:null,playerTeam:null,
dataTeam:null,dataDead:null,userNameUpdateList:null,tankStyleUpdateList:null,moveTankData:{Y:null,
B:null,E:null,H:null,HE:null},gameTime:0,gameEnd:{endCode:0,point:0,lastEnemy:""},canvasOfLayer:{
mapL1Layer:null,mapL1_5Layer:null,mapL2Layer:null},staticValues:{mapL1LayerNumber:0,
aniL1LayerNumber:1,mapL1_5LayerNumber:2,mapItemLayerNumber:3,tankLayerNumber:4,enemyLayerNumber:5,
bulletLayerNumber:6,mapL2LayerNumber:7,effectLayerNumber:8,scoreLayerNumber:9,controlLayerNumber:10,
alertLayerNumer:11},socketName:{},gameSetting:{allowSound:1,fullScreen:0},bulletInfor:{tank1:{
speed:6,dame:50,effect:[1],sound:"shoot1"},tank2:{speed:5,dame:50,effect:[11],sound:"shoot1"},
tank3:{speed:5,dame:80,effect:[9,10],sound:"shoot3"},tank1_1:{speed:5,dame:150,effect:[15],
sound:"skill1_1"},tank3_1:{speed:5,dame:50,effect:[16],sound:"shoot3"},enemy1:{size:10,speed:3,
dame:180,effect:[18],sound:"shoote1"}},skillData:{tank1_1:{countdown_default:5e3,type:1,
sprite:"skill1_1"},tank2_1:{countdown_default:1e4,type:3,sprite:"skill2_1"},tank3_1:{
countdown_default:5e3,type:1,sprite:"skill3_1"}},skillValue:{k1:{countdown:0}},effectSound:{
effect2:"effect2",effect13:"effect3",effect14:"effect3",effect7:"effect4",effectitem:"effectitem"},
unknownData:{scoreListValue:[]},addCon:function(e,t){var a=this;a[e]=t},KetThua:function(e,t){
t.prototype=Object.create(e.prototype),t.prototype.constructor=t},setval:function(){
gameOJ.Socket=io("//tanknode.herokuapp.com",{parser:customParser}),gameOJ.buildSchema(),
gameOJ.Socket.on(gameOJ.socketName.tank,function(e){gameOJ.saveTankData(e)
}),gameOJ.Socket.on(gameOJ.socketName.bullet,function(e){gameOJ.saveBulletData(e)}),
gameOJ.Socket.on(gameOJ.socketName.enemy,function(e){gameOJ.saveEnemyData(e)
}),gameOJ.Socket.on(gameOJ.socketName.hideTank,function(e){gameOJ.saveHideTankData(e)}),
gameOJ.Socket.on(gameOJ.socketName.hideEnemy,function(e){gameOJ.saveHideEnemyData(e)}),
gameOJ.Socket.on(gameOJ.socketName.updateEffect,function(e){gameOJ.applyEffect(e)}),
gameOJ.Socket.on("map_infor",function(e){gameOJ.getAndBuildMap(e)
}),gameOJ.Socket.on(gameOJ.socketName.rebuildEffect,function(e){
""!==e.length&&gameOJ.applyEffect(e,!1)
}),gameOJ.Socket.on(gameOJ.socketName.updateUserName,function(e){gameOJ.saveUpdateUserName(e)}),
gameOJ.Socket.on(gameOJ.socketName.updateTankStyle,function(e){gameOJ.saveUpdateTankStyle(e)}),
gameOJ.Socket.on(gameOJ.socketName.updatePlayer,function(e){gameOJ.savePlayerID(e.playerID),
gameOJ.gameTime=e.currentTime,gameOJ.playerTeam=e.playerTeam
}),gameOJ.Socket.on(gameOJ.socketName.updateScore,function(e){gameOJ.saveScore(e)}),
gameOJ.Socket.on("update_status",function(e){gameOJ.updateStatus(e)
}),gameOJ.Socket.on(gameOJ.socketName.updateSkill,function(e){gameOJ.updateSkill(e)}),
gameOJ.Socket.on(gameOJ.socketName.updateSlot,function(e){gameOJ.updateSlot(e)}),
gameOJ.Socket.on(gameOJ.socketName.updateTeam,function(e){gameOJ.saveDataTeam(e)}),
gameOJ.Socket.on(gameOJ.socketName.updateDead,function(e){gameOJ.saveDeadData(e)}),
gameOJ.Socket.on(gameOJ.socketName.deadBullet,function(e){gameOJ.saveDetroyedBullet(e)}),
gameOJ.Socket.on("rp",function(e){gameOJ.saveLogoutPlayer(e)
}),gameOJ.userNameInput=document.getElementById("inputArea"),
gameOJ.userNameInput.addEventListener("submit",e=>{
var t=document.getElementById("userJoinGameName").value
;if(!gameOJ.checkUserName(t))return document.getElementById("namerule").style.display="block",
void e.preventDefault()
;if(gameOJ.userNameInput.style.display="none",document.getElementById("namerule").style.display="none",
0!==gameOJ.stage1.numChildren){let e=gameOJ.stage1.getChildAt(gameOJ.stage1.numChildren-2)
;e.getChildAt(e.numChildren-1).text=t,e.cache(0,0,200,30)}e.preventDefault()}),gameOJ.gameH=300,
gameOJ.gameW=500,gameOJ.gameSH=1,gameOJ.gameSW=1,gameOJ.stage=new createjs.StageGL("demoCanvas"),
gameOJ.stage1=new createjs.Container,
gameOJ.stage2=new createjs.Container,gameOJ.stage3=new createjs.Container,gameOJ.stage3.visible=!1,
gameOJ.stage.addChild(gameOJ.stage1,gameOJ.stage2,gameOJ.stage3),gameOJ.asset=[{
src:"./asset/boxy_bold_fat.png",id:"boxy_font"},{src:"./asset/resize.jpg",id:"resize"},{
src:"./asset/bullet_1.png",id:"bullet"},{src:"./asset/tankBase.png",id:"tankBase"},{
src:"./asset/tankTurret.png",id:"tankTurret"},{src:"./asset/enemy.png",id:"enemy"},{
src:"./asset/enemy_turret.png",id:"enemyTurret"},{src:"./asset/effect.png",id:"effect"},{
src:"./asset/map_1.png",id:"map_1"},{src:"./asset/hpbar.png",id:"hpbar"},{
src:"./asset/menuimage_r.png",id:"menuImage"},{src:"./asset/UIList.png",id:"uiList"},{
src:"./asset/effect_p.png",id:"effect_p"},{src:"./asset/dropItem.png",id:"dropItem"},{
src:"./asset/icon.png",id:"icon"},{src:"./asset/skill.png",id:"skill"},{src:"./asset/logo.png",
id:"logo"},{src:"./static/itemmap.json",id:"itemmap"},{src:"./map/map3.json",id:"map3"},{
src:"./sound/theme1.ogg",id:"theme1"},{src:"./sound/shoot1.ogg",id:"shoot1"},{
src:"./sound/shoot1.ogg",id:"shoot3"},{src:"./sound/skill1_1.ogg",id:"skill1_1"},{
src:"./sound/shoote1.ogg",id:"shoote1"},{src:"./sound/item.ogg",id:"effectitem"},{
src:"./sound/effect2.ogg",id:"effect2"},{src:"./sound/effect3.ogg",id:"effect3"},{
src:"./sound/effect4.ogg",id:"effect4"},{src:"./sound/win1.ogg",id:"win1"},{src:"./sound/bell.ogg",
id:"bell"},{src:"./sound/s1.ogg",id:"s1"},{src:"./sound/peffect1.ogg",id:"peffect1"},{
src:"./sound/peffect7.ogg",id:"peffect7"
}],gameOJ.loadMC=new LoadMi(gameOJ),createjs.Ticker.addEventListener("tick",gameOJ.tick),
createjs.Ticker.timingMode=createjs.Ticker.RAF,
createjs.Ticker.framerate=60,gameOJ.stage.enableMouseOver(20),gameOJ.stage.mouseEnabled=!0,
createjs.Touch.enable(gameOJ.stage),gameOJ.stage.snapToPixelEnabled=!0,this.AddSound(),
gameOJ.FixCanvas(),window.addEventListener("resize",gameOJ.FixCanvas)},AddSound:function(){
this.Sound.shoot1=new Howl({src:["sound/shoot1.ogg"],autoplay:!1,loop:!1,volume:.2}),
this.SoundMark.shoot1=-1,this.Sound.shoot3=new Howl({src:["sound/shoot3.ogg"],autoplay:!1,loop:!1,
volume:.2}),this.SoundMark.shoot3=-1,this.Sound.skill1_1=new Howl({src:["sound/skill1_1.ogg"],
autoplay:!1,loop:!1,volume:.2}),this.SoundMark.shoot3=-1,this.Sound.shoote1=new Howl({
src:["sound/shoote1.ogg"],autoplay:!1,loop:!1,volume:.2}),this.SoundMark.shoote1=-1,
this.Sound.effect2=new Howl({src:["sound/effect2.ogg"],autoplay:!1,loop:!1,volume:.2}),
this.SoundMark.effect2=-1,this.Sound.effect3=new Howl({src:["sound/effect3.ogg"],autoplay:!1,
loop:!1,volume:.2}),this.SoundMark.effect3=-1,this.Sound.effect4=new Howl({
src:["sound/effect4.ogg"],autoplay:!1,loop:!1,volume:.2}),this.SoundMark.effect4=-1,
this.Sound.effectitem=new Howl({src:["sound/item.ogg"],autoplay:!1,loop:!1,volume:.2}),
this.SoundMark.effectitem=-1,this.Sound.peffect1=new Howl({src:["sound/peffect1.ogg"],autoplay:!1,
loop:!1,volume:.2}),this.SoundMark.peffect1=-1,this.Sound.peffect7=new Howl({
src:["sound/peffect7.ogg"],autoplay:!1,loop:!1,volume:.2}),this.SoundMark.peffect7=-1,
this.Sound.win1=new Howl({src:["sound/win1.ogg"],autoplay:!1,loop:!1,volume:.2}),
this.SoundMark.win1=-1,this.Sound.bell=new Howl({src:["sound/bell.ogg"],autoplay:!1,loop:!1,
volume:.2}),this.SoundMark.bell=-1,this.Sound.s1=new Howl({src:["sound/s1.ogg"],autoplay:!1,loop:!1,
volume:.2}),this.SoundMark.s1=-1,this.Sound.theme1=new Howl({src:["sound/theme1.ogg"],autoplay:!1,
loop:!0,volume:.2}),this.SoundMark.theme1=-1},playSound:function(e,t,a,i=0){if(i){
if(gameOJ.SoundMark[e]===i)return;gameOJ.SoundMark[e]=i}let n=1,s=Math.max(a,t);n=1-.1*~~(s/50),
n<=0||(gameOJ.Sound[e].volume(n),gameOJ.Sound[e].play())},openFullscreen:function(){
if(!document.fullscreenElement){gameOJ.gameSetting.fullScreen=1;var e=gameOJ.stage.canvas
;e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen()
}},exitFullscreen:function(){document.fullscreenElement&&(gameOJ.gameSetting.fullScreen=0,
document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen())
},changeSoundGame:function(e){gameOJ.gameSetting.allowSound=e,Howler.volume(e)},
buildSchema:function(e=customParser.PacketBuilder){var t=0;gameOJ.socketName.moveTank=++t,
e.build(t,"int8"),
gameOJ.socketName.shootBullet=++t,e.build(t,"float32"),gameOJ.socketName.shootSkill=++t,e.build(t,{
t:"uint8",r:"float32",p:"string"}),gameOJ.socketName.buildItem=++t,e.build(t,["uint8"]),
gameOJ.socketName.tank=++t,e.build(t,[{p:"string",x:"int16",y:"int16",g:"float32",m:"int16",
t:"int16",e:["uint8"],s:"float32",reload:"uint16",moveAngle:"float32"
}]),gameOJ.socketName.bullet=++t,e.build(t,[{i:"string",p:"string",x:"int16",y:"int16",r:"float32",
n:"int8",s:"string"
}]),gameOJ.socketName.updateEffect=++t,e.build(t,"string"),gameOJ.socketName.rebuildEffect=++t,
e.build(t,"string"),
gameOJ.socketName.deadBullet=++t,e.build(t,["string"]),gameOJ.socketName.updateDead=++t,e.build(t,[{
playerId:"string",time:"uint32"}]),gameOJ.socketName.updateScore=++t,e.build(t,[{playerID:"string",
d:"int8",point:"int8"
}]),gameOJ.socketName.hideTank=++t,e.build(t,["string"]),gameOJ.socketName.enemy=++t,e.build(t,[{
p:"string",x:"int16",y:"int16",g:"float32",m:"int16",t:"int16",e:["uint8"],s:"float32",
reload:"uint16",team:"string",style:"string",moveAngle:"float32"}]),gameOJ.socketName.hideEnemy=++t,
e.build(t,["string"]),gameOJ.socketName.deadEnemy=++t,e.build(t,[{playerId:"string",time:"uint32"
}]),gameOJ.socketName.updatePlayer=++t,e.build(t,{playerID:"string",currentTime:"uint32",
playerTeam:"string"}),gameOJ.socketName.updateUserName=++t,e.build(t,[{playerName:"string",
playerID:"string"}]),gameOJ.socketName.updateTankStyle=++t,e.build(t,[{p:"string",s:"string"}]),
gameOJ.socketName.updateSkill=++t,e.build(t,[{index:"int8",countDown:"uint32"}]),
gameOJ.socketName.updateTeam=++t,e.build(t,[{playerID:"string",teamID:"string"}]),
gameOJ.socketName.updateSlot=++t,e.build(t,[{playerID:"string",slotList:["int8"],
unlimitSlot:["int8"],updateItem:["int8"]}])},checkUserName:function(e){var t=/^[0-9a-zA-Z_]{4,15}$/
;return!!e.match(t)},buildAfterLoad:function(){this.saveItemInfor(),this.CreateAnimation()},
saveItemInfor:function(){gameOJ.slotInfor=gameOJ.loadMC.getAsset("itemmap")},
getSlotInfor:function(e){return e>=gameOJ.slotInfor.length?null:gameOJ.slotInfor[e]},
CreateAnimation:function(){var e={images:[gameOJ.loadMC.getAsset("resize")],frames:{width:170,
height:180},animations:{main:[0,38,!0,.5]}};this.SpriteSheetList.resize=new createjs.SpriteSheet(e)
;var t=new createjs.Sprite(this.SpriteSheetList.resize)
;t.gotoAndPlay("main"),t.scaleX=gameOJ.gameW/170,t.scaleY=gameOJ.gameH/180,gameOJ.stage3.addChild(t)
;var a={images:[gameOJ.loadMC.getAsset("tankBase")],frames:{width:32,height:32},animations:{tank1:0,
tank2:1,tank3:2}};this.SpriteSheetList.TankBase=new createjs.SpriteSheet(a);var i={
images:[gameOJ.loadMC.getAsset("tankTurret")],frames:{width:32,height:32},animations:{tank1:0,
tank1s:[1,3,"tank1",.5],tank2:4,tank2s:[5,7,"tank2",.5],tank3:8,tank3s:[9,10,"tank3",.5]}}
;this.SpriteSheetList.TankTurret=new createjs.SpriteSheet(i);var n={
images:[gameOJ.loadMC.getAsset("enemy")],frames:{width:50,height:50},animations:{enemy1:0}}
;this.SpriteSheetList.Enemy=new createjs.SpriteSheet(n);var s={
images:[gameOJ.loadMC.getAsset("enemyTurret")],frames:{width:50,height:50},animations:{enemy1:0,
enemy1s:[1,3,"enemy1",.5]}};this.SpriteSheetList.EnemyTurret=new createjs.SpriteSheet(s);var r={
images:[gameOJ.loadMC.getAsset("bullet")],frames:{width:50,height:50},animations:{tank1:0,tank2:1,
tank3:2,tank1_1:[3,6,!0,.5],tank3_1:[7],enemy1:[8,11,!0,.5]}}
;this.SpriteSheetList.bullet=new createjs.SpriteSheet(r);var l={
images:[gameOJ.loadMC.getAsset("effect")],frames:{width:50,height:50},animations:{
effect1:[0,6,!1,.5],effect2:[7,16,!1,.3],effect3:[17,21,!1,.3],effect4:[22,26,!1,.3],effect5:[27],
effect6:[28,36,!1,.3],effect7:[37,43,!1,.2],effect8:[44,52,!1,.2],effect9:[53,58,!1,.5],
effect10:[59],effect11:[60,65,!1,.5],effect12:[66,71,!1,.1],effect13:[72,73,!1,.1],
effect14:[74,75,!1,.1],effect15:[76,83,!1,.3],effect16:[84,93,!1,.2],effect17:[94,100,!1,.3],
effect18:[101,108,!1,.3]}};this.SpriteSheetList.effect=new createjs.SpriteSheet(l);var o={
images:[gameOJ.loadMC.getAsset("effect_p")],frames:{width:50,height:50},animations:{
effect1:[0,2,!0,.5],effect2:[3,5,!0,.5],effect3:[6,9,!0,.5],effect4:[10,14,!0,.2],effect5:[15],
effect6:[16,19,!0,.3],effect10:[20],effect11:[21,24,!0,.3]}}
;this.SpriteSheetList.effect_p=new createjs.SpriteSheet(o);var m={
images:[gameOJ.loadMC.getAsset("dropItem")],frames:{width:50,height:50},animations:{item1:0,
item2:[1,2,!0,.1],item3:[4,8,!0,.1],item4:[10,14,!0,.1],item5:[16,20,!0,.1],slot1:3,slot2:9,
slot3:15,slot4:21,slot5:22,slot6:23,slot7:24,slot8:25,slot9:26}}
;this.SpriteSheetList.item=new createjs.SpriteSheet(m);var g={
images:[gameOJ.loadMC.getAsset("icon")],frames:{width:50,height:50},animations:{board:0,kill1:1,
kill2:2,kill3:3,kill4:7,kill5:[4,7,!1,.8],fullScreenGo:8,fullScreenExit:9,soundAllow:10,
soundNotAllow:11,emptySlot:12,buildItem:13,buildBack:14,install:15,installOff:16,closeIcon:17}}
;this.SpriteSheetList.icon=new createjs.SpriteSheet(g);var c={
images:[gameOJ.loadMC.getAsset("logo")],frames:{width:200,height:64},animations:{
victory:[1,3,!0,.1],defeat:[4]}};this.SpriteSheetList.logo=new createjs.SpriteSheet(c);var h={
images:[gameOJ.loadMC.getAsset("skill")],frames:{width:40,height:40},animations:{back:[0],
skill1_1:[1],skill2_1:[2],skill3_1:[3]}};this.SpriteSheetList.skill=new createjs.SpriteSheet(h)
;var d={images:[gameOJ.loadMC.getAsset("boxy_font")],frames:{width:9,height:8},animations:{c0:0,
c1:1,c2:2,c3:3,c4:4,c5:5,c6:6,c7:7,c8:8,c9:9,"c:":82,c_:79,"c+":65,"c.":68,"c?":35,"c!":69,A:10,
B:11,C:12,D:13,E:14,F:15,G:16,H:17,I:18,J:19,K:20,L:21,M:22,N:23,O:24,P:25,Q:26,R:27,S:28,T:29,U:30,
V:31,W:32,X:33,Y:34,Z:35,a:39,b:40,c:41,d:42,e:43,f:44,g:45,h:46,i:47,j:48,k:49,l:50,m:51,n:52,o:53,
p:54,q:55,r:56,s:57,t:58,u:59,v:60,w:61,x:62,y:63,z:64}}
;this.SpriteSheetList.font=new createjs.SpriteSheet(d);var u={
images:[gameOJ.loadMC.getAsset("map_1")],frames:{width:16,height:16},animations:{a123:{
frames:[123,124,125,163,164,165],next:!0,speed:.1},a16:{frames:[16,18,20,96,98,100],next:!0,speed:.1
},a17:{frames:[17,19,21,97,99,101],next:!0,speed:.1},a56:{frames:[56,58,60,136,138,140],next:!0,
speed:.1},a57:{frames:[57,59,61,137,139,141],next:!0,speed:.1}}}
;this.SpriteSheetList.map_1=new createjs.SpriteSheet(u),this.AniL1NameList.push(123,16,17,56,57)
;var p={images:[gameOJ.loadMC.getAsset("hpbar")],frames:{width:60,height:20}}
;this.SpriteSheetList.hpbar=new createjs.SpriteSheet(p)},resetGame:function(){gameOJ.bulletList=[],
gameOJ.playerList=[],gameOJ.enemyList=[],gameOJ.effectList=[],gameOJ.scoreList={value:[],updated:!1,
redraw:!1},gameOJ.currentMap=null,gameOJ.player=null,gameOJ.pingtime=0},createMap:function(e){
mapData=gameOJ.loadMC.getAsset(e),gameOJ.currentMap=mapData
;for(var t=new createjs.Container,a=0;a<mapData.layers[0].data.length;a++){
var i=mapData.layers[0].data[a]-1,n=a%mapData.width,s=Math.floor(a/mapData.width);if(-1!==i){
var r=new createjs.Sprite(this.SpriteSheetList.map_1)
;-1===this.AniL1NameList.indexOf(i)?(r.gotoAndStop(i),
r.x=n*mapData.tilewidth,r.y=s*mapData.tileheight,t.addChild(r)):(r.gotoAndPlay("a"+i),
r.x=n*mapData.tilewidth,
r.y=s*mapData.tileheight,gameOJ.stage2.getChildAt(gameOJ.staticValues.aniL1LayerNumber).addChild(r)),
n++,n>=mapData.width&&(s++,n=0)}}for(var l=0;l<mapData.layers[5].objects.length;l++){
let e=mapData.layers[5].objects[l],a=new createjs.Bitmap(gameOJ.loadMC.getAsset("map_1"))
;a.sourceRect=new createjs.Rectangle(496,368,32,32),a.x=e.x-8,a.y=e.y-8,t.addChild(a)}
t.cache(0,0,mapData.width*mapData.tilewidth,mapData.height*mapData.tileheight)
;var o=new createjs.Bitmap(t.cacheCanvas)
;o.sourceRect=new createjs.Rectangle(0,0,gameOJ.gameW,gameOJ.gameH),
gameOJ.stage2.getChildAt(gameOJ.staticValues.mapL1LayerNumber).addChild(o),t.removeAllChildren(),
gameOJ.canvasOfLayer.mapL1Layer=t;var m=new createjs.Container
;for(a=0;a<mapData.layers[1].data.length;a++){i=mapData.layers[1].data[a]-1,n=a%mapData.width,
s=Math.floor(a/mapData.width);if(-1!==i){r=new createjs.Sprite(this.SpriteSheetList.map_1)
;r.gotoAndStop(i),r.x=n*mapData.tilewidth,r.y=s*mapData.tileheight,m.addChild(r),n++,
n>=mapData.width&&(s++,n=0)}}
m.cache(0,0,mapData.width*mapData.tilewidth,mapData.height*mapData.tileheight)
;var g=new createjs.Bitmap(m.cacheCanvas)
;g.sourceRect=new createjs.Rectangle(0,0,gameOJ.gameW,gameOJ.gameH),
gameOJ.stage2.getChildAt(gameOJ.staticValues.mapL1_5LayerNumber).addChild(g),m.removeAllChildren(),
gameOJ.canvasOfLayer.mapL1_5Layer=m;var c=new createjs.Container
;for(a=0;a<mapData.layers[2].data.length;a++){i=mapData.layers[2].data[a]-1,n=a%mapData.width,
s=Math.floor(a/mapData.width);if(-1!==i){r=new createjs.Sprite(this.SpriteSheetList.map_1)
;r.gotoAndStop(i),r.x=n*mapData.tilewidth,r.y=s*mapData.tileheight,c.addChild(r),n++,
n>=mapData.width&&(s++,n=0)}}
c.cache(0,0,mapData.width*mapData.tilewidth,mapData.height*mapData.tileheight)
;var h=new createjs.Bitmap(c.cacheCanvas)
;h.sourceRect=new createjs.Rectangle(0,0,gameOJ.gameW,gameOJ.gameH),
gameOJ.stage2.getChildAt(gameOJ.staticValues.mapL2LayerNumber).addChild(h),c.removeAllChildren(),
gameOJ.canvasOfLayer.mapL2Layer=c,Boolean(mapData.theme)?(gameOJ.playSound(mapData.theme,300,300),
gameOJ.currentTheme=mapData.theme):(gameOJ.playSound("theme1",300,300),gameOJ.currentTheme="theme1")
},FixCanvas:function(){
gameOJ.stage.canvas.width=window.innerWidth,gameOJ.stage.canvas.height=window.innerHeight,
gameOJ.gameSH=gameOJ.stage.canvas.height/gameOJ.gameH,
gameOJ.gameSW=gameOJ.stage.canvas.width/gameOJ.gameW,gameOJ.stage.scaleX=gameOJ.gameSW,
gameOJ.stage.scaleY=gameOJ.gameSH,
gameOJ.stage.updateViewport(gameOJ.stage.canvas.width,gameOJ.stage.canvas.height),
window.innerHeight>window.innerWidth?gameOJ.stage3.visible=!0:gameOJ.stage3.visible=!1},
Fitcon:function(){var e=new createjs.Container;return e.scaleX=gameOJ.gameSW,e.scaleY=gameOJ.gameSH,
e},buildText:function(e,t,a=null,i=null){
let n=a||new createjs.Container,s=0,r=0,l=e.split(/[\s\/]/),o=0,m=0;for(let a=0;a<e.length;a++){
let i=e.charAt(a);if(" "===i)s+=10,o++,m=1;else if("/"===i)s=0,r+=11,o++,m=1;else{
m&&s+10*l[o].length>t&&(s=0,r+=11)
;let e=i.match(/[a-z]/i)?"":"c",a=new createjs.Sprite(gameOJ.SpriteSheetList.font,e+i);a.x=s,a.y=r,
n.addChild(a),s+=10,m=0}}return n.cache(0,0,t+10,r+11),n.removeAllChildren(),n.text=e,n},
clearCanvas:function(){gameOJ.stage.removeAllChildren(),gameOJ.stage1.removeAllChildren(),
gameOJ.stage2.removeAllChildren()
;var e=new createjs.Container,t=new createjs.Container,a=new createjs.Container,i=new createjs.Container,n=new createjs.Container,s=new createjs.Container,r=new createjs.Container,l=new createjs.Container,o=new createjs.Container,m=new createjs.Container,g=new createjs.Container,c=new createjs.Container
;gameOJ.stage2.addChild(n,s,r,l,e,t,a,i,o,m,c,g),
gameOJ.stage.addChild(gameOJ.stage1,gameOJ.stage2,gameOJ.stage3)},changeTT:function(e){
gameOJ.gameTT=e,gameOJ.gameNN=0,gameOJ.playerID=null,gameOJ.playerTeam=null,gameOJ.clearCanvas()},
createFinishMenu:function(e){
null!==gameOJ.currentTheme&&gameOJ.Sound[gameOJ.currentTheme].volume(.2),
gameOJ.stage2.getChildAt(gameOJ.staticValues.controlLayerNumber).alpha=0
;var t=new createjs.Bitmap(gameOJ.loadMC.getAsset("uiList"))
;t.sourceRect=new createjs.Rectangle(18,24,302,45),
t.regX=t.sourceRect.width/2,t.regY=t.sourceRect.height/2,t.x=gameOJ.gameW/2,t.y=gameOJ.gameH/2-90
;var a=new createjs.Bitmap(gameOJ.loadMC.getAsset("uiList"))
;a.sourceRect=new createjs.Rectangle(26,230,302,60),a.regX=a.sourceRect.width/2,
a.regY=a.sourceRect.height/2,a.x=gameOJ.gameW/2,a.y=gameOJ.gameH/2-90
;var i=new createjs.Sprite(this.SpriteSheetList.logo,"victory");i.regX=100,i.regY=32,
i.x=gameOJ.gameW/2,i.y=gameOJ.gameH/2-90
;var n=new createjs.Sprite(this.SpriteSheetList.logo,"defeat");n.regX=100,n.regY=32,
n.x=gameOJ.gameW/2,n.y=gameOJ.gameH/2-90;let s=gameOJ.findPlayer(e.lastEnemy)
;if(1===e.endCode&&-1!==s)var r=gameOJ.playerList[s].playerName;else r="__"
;var l=new createjs.Container,o=new createjs.Shape((new createjs.Graphics).beginFill("#000000").drawRect(0,0,220,100)),m=new createjs.Text(e.point+"","20px Arial","#FFFFFF"),g=new createjs.Text(r,"20px Arial","#FFFFFF"),c=new createjs.Text("Point:","20px Arial","#FFFFFF"),h=new createjs.Text("Enemy:","20px Arial","#FFFFFF")
;c.maxWidth=100,c.x=20,c.y=20,m.maxWidth=100,m.x=100,m.y=20,g.maxWidth=100,g.x=100,g.y=40,
h.maxWidth=100,h.x=20,h.y=40,l.addChild(o,c,h,m,g),l.cache(0,0,220,150),l.regX=110,l.regY=75,
l.alpha=.8,l.x=gameOJ.gameW/2,l.y=gameOJ.gameH/2+30
;var d=new createjs.Bitmap(gameOJ.loadMC.getAsset("uiList"))
;d.sourceRect=new createjs.Rectangle(85,93,180,60),
d.regX=d.sourceRect.width/2,d.regY=d.sourceRect.height/2,d.x=gameOJ.gameW/2,d.y=gameOJ.gameH/2+100,
d.on("click",function(){null!==gameOJ.currentTheme&&(gameOJ.Sound[gameOJ.currentTheme].stop(),
gameOJ.currentTheme=null),gameOJ.leaveMatch(),gameOJ.changeTT(1)
}),2===e.endCode?(gameOJ.stage2.getChildAt(gameOJ.staticValues.alertLayerNumer).removeAllChildren(),
gameOJ.stage2.getChildAt(gameOJ.staticValues.alertLayerNumer).addChild(a,d,l)):1===e.endCode?(gameOJ.stage2.getChildAt(gameOJ.staticValues.alertLayerNumer).removeAllChildren(),
gameOJ.stage2.getChildAt(gameOJ.staticValues.alertLayerNumer).addChild(t,d,l)):3===e.endCode?(gameOJ.playSound("win1",0,0),
gameOJ.stage2.getChildAt(gameOJ.staticValues.alertLayerNumer).removeAllChildren(),
gameOJ.stage2.getChildAt(gameOJ.staticValues.alertLayerNumer).addChild(i,d,l)):4===e.endCode&&(gameOJ.playSound("shoot1",0,0),
gameOJ.stage2.getChildAt(gameOJ.staticValues.alertLayerNumer).removeAllChildren(),
gameOJ.stage2.getChildAt(gameOJ.staticValues.alertLayerNumer).addChild(n,d,l))},
updateScoreList:function(){
if(0!==gameOJ.stage2.getChildAt(gameOJ.staticValues.scoreLayerNumber).numChildren)var e=gameOJ.stage2.getChildAt(gameOJ.staticValues.scoreLayerNumber).getChildAt(0);else{
e=new createjs.Container;e.alpha=.8,e.x=gameOJ.gameW/2-120,e.y=gameOJ.gameH/2-100,e.visible=!1,
gameOJ.stage2.getChildAt(gameOJ.staticValues.scoreLayerNumber).addChild(e)}e.removeAllChildren(),
e.addChild(new createjs.Shape((new createjs.Graphics).beginFill("#000000").drawRect(0,0,480,400)))
;var t=new createjs.Text("Leaderboard [G]","36px Arial","#FFFFFF");t.maxWidth=240,t.x=120,t.y=10,
e.addChild(t);var a=[0,0],i=new createjs.Container;i.x=240,i.y=340
;for(var n=999999,s=0;s<gameOJ.scoreList.value.length;s++){var r=gameOJ.scoreList.value[s]
;if(Boolean(gameOJ.player)&&r.playerID===gameOJ.player.playerID){a[0]+=parseInt(r.point)
;var l="green";0===s&&r.point>gameOJ.player.killPoint&&(n=gameOJ.player.killPoint),
gameOJ.player.updateKillPoint(parseInt(r.point))}else if(""!==r.team&&r.team===gameOJ.player.team){
a[0]+=parseInt(r.point);l="#80b7ff"}else{a[1]+=parseInt(r.point);l="#ff665e"}
1===s&&parseInt(r.point)>=n&&gameOJ.playSound("s1",100,100)
;var o=new createjs.Text(r.nick,"30px Arial",l);o.maxWidth=240,o.x=20,o.y=2*(20*(s+1)+5)
;var m=new createjs.Text(r.point+"/"+r.dead,"30px Arial",l);m.x=360,m.y=2*(20*(s+1)+5),
m.maxWidth=240,e.addChild(o,m)}for(var g=0;g<a.length;g++){
m=new createjs.Text(a[g]+"","30px Arial",0===g?"#80b7ff":"#ff665e");if(m.lineWidth=60,m.maxWidth=60,
m.x=30*g*2,i.regX+=20,a.length-g>=2){var c=new createjs.Text("-","30px Arial","#EEEEEE")
;c.lineWidth=60,c.maxWidth=60,c.x=30*g*2+32,i.addChild(c)}i.addChild(m)}e.addChild(i),
e.cache(0,0,480,400),e.scaleX=e.scaleY=.5},changeMapCanvas:function(e,t,a,i,n){
var s=gameOJ.canvasOfLayer[e],r=new createjs.Sprite(this.SpriteSheetList.map_1)
;r.x=i*this.currentMap.tilewidth,r.y=n*this.currentMap.tileheight,-1!==t&&0!==t||(r.gotoAndStop(0),
s.addChild(r),
s.updateCache("destination-out")),0===t?(r.gotoAndStop(a),s.updateCache("source-over")):1===t&&(s.addChild(r),
r.gotoAndStop(a),s.updateCache("source-over")),s.removeAllChildren()},addItem:function(e,t,a,i){
let n=new createjs.Sprite(gameOJ.SpriteSheetList.item,"item"+a);n.itemID=i,n.regX=n.regY=16,n.x=e,
n.y=t,gameOJ.stage2.getChildAt(gameOJ.staticValues.mapItemLayerNumber).addChild(n)},
removeItem:function(e){var t=gameOJ.stage2.getChildAt(gameOJ.staticValues.mapItemLayerNumber)
;let a=t.children.findIndex(t=>t.itemID===e)
;-1!==a&&("item2"===t.getChildAt(a).currentAnimation&&gameOJ.addEffect(t.getChildAt(a).x+8,t.getChildAt(a).y+8,0,"7"),
t.removeChildAt(a))},moveCamera:function(e,t,a){var i=e-gameOJ.gameW/2,n=t-gameOJ.gameH/2
;i<0&&(i=0),
i>gameOJ.currentMap.width*gameOJ.currentMap.tilewidth-gameOJ.gameW&&(i=gameOJ.currentMap.width*gameOJ.currentMap.tilewidth-gameOJ.gameW),
n<0&&(n=0),
n>gameOJ.currentMap.height*gameOJ.currentMap.tileheight-gameOJ.gameH&&(n=gameOJ.currentMap.height*gameOJ.currentMap.tileheight-gameOJ.gameH),
gameOJ.stage2.getChildAt(gameOJ.staticValues.mapL1LayerNumber).getChildAt(0).sourceRect.x=i,
gameOJ.stage2.getChildAt(gameOJ.staticValues.mapL1LayerNumber).getChildAt(0).sourceRect.y=n,
gameOJ.stage2.getChildAt(gameOJ.staticValues.aniL1LayerNumber).x=-i,
gameOJ.stage2.getChildAt(gameOJ.staticValues.aniL1LayerNumber).y=-n,
gameOJ.stage2.getChildAt(gameOJ.staticValues.mapL1_5LayerNumber).getChildAt(0).sourceRect.x=i,
gameOJ.stage2.getChildAt(gameOJ.staticValues.mapL1_5LayerNumber).getChildAt(0).sourceRect.y=n,
gameOJ.stage2.getChildAt(gameOJ.staticValues.mapItemLayerNumber).x=-i,
gameOJ.stage2.getChildAt(gameOJ.staticValues.mapItemLayerNumber).y=-n,
gameOJ.stage2.getChildAt(gameOJ.staticValues.mapL2LayerNumber).getChildAt(0).sourceRect.x=i,
gameOJ.stage2.getChildAt(gameOJ.staticValues.mapL2LayerNumber).getChildAt(0).sourceRect.y=n,
gameOJ.stage2.getChildAt(gameOJ.staticValues.tankLayerNumber).x=-i,
gameOJ.stage2.getChildAt(gameOJ.staticValues.tankLayerNumber).y=-n,
gameOJ.stage2.getChildAt(gameOJ.staticValues.enemyLayerNumber).x=-i,
gameOJ.stage2.getChildAt(gameOJ.staticValues.enemyLayerNumber).y=-n,
gameOJ.stage2.getChildAt(gameOJ.staticValues.bulletLayerNumber).x=-i,
gameOJ.stage2.getChildAt(gameOJ.staticValues.bulletLayerNumber).y=-n,
gameOJ.stage2.getChildAt(gameOJ.staticValues.effectLayerNumber).x=-i,
gameOJ.stage2.getChildAt(gameOJ.staticValues.effectLayerNumber).y=-n},showAndHideBoard:function(e){
if(gameOJ.stage2.getChildAt(gameOJ.staticValues.scoreLayerNumber).numChildren>0){
var t=gameOJ.stage2.getChildAt(gameOJ.staticValues.scoreLayerNumber).getChildAt(0);t.visible=e}},
buildTimeText:function(){
var e=("00"+~~(gameOJ.gameTime/1e3/60)).slice(-2),t=("00"+~~(gameOJ.gameTime/1e3%60)).slice(-2)
;t=e+":"+t;for(var a=new createjs.Container,i=0;i<t.length;i++){
let e=new createjs.Sprite(gameOJ.SpriteSheetList.font);e.gotoAndStop("c"+t.charAt(i)),e.x=10*i,
a.addChild(e)}
a.regX=20,a.x=gameOJ.gameW/2,a.y=2,gameOJ.stage2.getChildAt(gameOJ.staticValues.alertLayerNumer).addChild(a)
},updateTimeText:function(e){if(0!==gameOJ.gameTime){var t=gameOJ.gameTime;gameOJ.gameTime-=e,
t>15e3&&gameOJ.gameTime<15e3&&gameOJ.playSound("bell",0,0)
;var a=("00"+~~(gameOJ.gameTime/1e3/60)).slice(-2),i=("00"+~~(gameOJ.gameTime/1e3%60)).slice(-2)
;i=a+":"+i
;for(var n=gameOJ.stage2.getChildAt(gameOJ.staticValues.alertLayerNumer).getChildAt(gameOJ.stage2.getChildAt(gameOJ.staticValues.alertLayerNumer).numChildren-1),s=0;s<i.length;s++)n.getChildAt(s).gotoAndStop("c"+i.charAt(s))
}},blockGame:function(){2===gameOJ.gameTT&&gameOJ.playerControl.clearMove()},findPlayer:function(e){
return gameOJ.playerList.findIndex(t=>t.playerID===e)},findEnemy:function(e){
return gameOJ.enemyList.findIndex(t=>t.playerID===e)},findBullet:function(e){
return gameOJ.bulletList.findIndex(t=>t.bulletID===e)},addPlayer:function(e,t,a,i){
var n=new gameOJ.Player(e,t,a,i)
;gameOJ.playerList.push(n),gameOJ.stage2.getChildAt(gameOJ.staticValues.tankLayerNumber).addChild(n.tankGraphic)
},addEnemy:function(e,t,a,i,n){var s=new gameOJ.Enemy(e,t,a,i,n);gameOJ.enemyList.push(s),
gameOJ.stage2.getChildAt(gameOJ.staticValues.enemyLayerNumber).addChild(s.tankGraphic)},
addBullet:function(e,t,a,i,n,s,r=!1){var l=new gameOJ.Bullet(e,t,a,i,n,s,r)
;gameOJ.bulletList.push(l),
gameOJ.stage2.getChildAt(gameOJ.staticValues.bulletLayerNumber).addChild(l.bulletGraphic)},
addEffect:function(e,t,a,i,n=!1,s=null){
var r=new gameOJ.Effect(e,t,a,i,gameOJ.effectList.length,n,s);gameOJ.effectList.push(r),
gameOJ.stage2.getChildAt(gameOJ.staticValues.effectLayerNumber).addChild(r.effectGraphic)},
removePlayer:function(e,t=-1){var a=-1!==t?t:gameOJ.findPlayer(e)
;gameOJ.stage2.getChildAt(gameOJ.staticValues.tankLayerNumber).removeChild(gameOJ.playerList[a].tankGraphic),
gameOJ.playerList.splice(a,1);var i=gameOJ.scoreList.value.findIndex(t=>t.playerID===e)
;-1!==i&&(gameOJ.scoreList.value.splice(i,1),gameOJ.scoreList.redraw=!0)},
removeEnemy:function(e,t=-1){var a=-1!==t?t:gameOJ.findEnemy(e)
;gameOJ.stage2.getChildAt(gameOJ.staticValues.enemyLayerNumber).removeChild(gameOJ.enemyList[a].tankGraphic),
gameOJ.enemyList.splice(a,1)},removeBullet:function(e){var t=gameOJ.findBullet(e)
;gameOJ.stage2.getChildAt(gameOJ.staticValues.bulletLayerNumber).removeChild(gameOJ.bulletList[t].bulletGraphic),
gameOJ.bulletList.splice(t,1)},removeEffect:function(e){
gameOJ.stage2.getChildAt(gameOJ.staticValues.effectLayerNumber).removeChildAt(e),
gameOJ.effectList.splice(e,1)},updateScoreListNick:function(){
for(var e=!1,t=0;t<gameOJ.scoreList.value.length;t++)if("@"===gameOJ.scoreList.value[t].nick){
var a=gameOJ.findPlayer(gameOJ.scoreList.value[t].playerID)
;-1!==a?(gameOJ.scoreList.value[t].nick=gameOJ.playerList[a].playerName,
gameOJ.scoreList.value[t].team=gameOJ.playerList[a].team):(gameOJ.scoreList.updated=!0,e=!0)}
return e},stopAllPlayer:function(){for(var e=0;e<gameOJ.playerList.length;e++){
var t=gameOJ.playerList[e];t.addNewPosition(t.tankPoint.x+1,t.tankPoint.y+1,-1)}},
displayKillIcon:function(e){e>5&&(e=5)
;var t=gameOJ.stage2.getChildAt(gameOJ.staticValues.alertLayerNumer).getChildAt(3);t.visible=!0,
t.displayScore=1e3,t.gotoAndPlay("kill"+e)},createInGameMenu:function(){
let e=new createjs.Shape((new createjs.Graphics).beginFill("#000000").drawRect(15,15,20,20)),t=new createjs.Sprite(gameOJ.SpriteSheetList.icon,"board")
;t.hitArea=e,t.on("mousedown",()=>{gameOJ.showAndHideBoard(!0)}),t.on("pressup",()=>{
gameOJ.showAndHideBoard(!1)})
;let a=new createjs.Container,i=new createjs.Sprite(gameOJ.SpriteSheetList.skill,"skill1_1"),n=new createjs.Sprite(gameOJ.SpriteSheetList.skill,"back"),s=new createjs.Container
;s.x=12,s.y=12,a.addChild(n,i,s),a.alpha=.8,a.regX=a.regY=20,a.x=gameOJ.gameW/2,a.y=gameOJ.gameH-20,
s.scaleX=s.scaleY=2;let r=new createjs.Container;r.scaleX=r.scaleY=5,r.x=gameOJ.gameW/2-25,
r.y=gameOJ.gameH/2-25,r.countdown=0;let l=new createjs.Sprite(gameOJ.SpriteSheetList.icon,"kill1")
;l.x=gameOJ.gameW/2-25,l.y=gameOJ.gameH/2-120,l.visible=!1,l.displayScore=0,l.on("tick",()=>{
l.displayScore>0&&(l.displayScore-=17,l.displayScore<=0&&(l.visible=!1))})
;let o=new createjs.Container,m=new createjs.Container,g=new createjs.Shape((new createjs.Graphics).beginFill("#000000").drawRect(0,0,400,250))
;g.alpha=.8;let c=new createjs.Container;c.y=200;let h=new createjs.Container;h.y=200,
m.addChild(g,c);let d=new createjs.Container;for(let e=0;e<5;e++){
let t=new createjs.Sprite(gameOJ.SpriteSheetList.icon,"emptySlot");t.x=26*e,c.addChild(t)
;let a=new createjs.Sprite(gameOJ.SpriteSheetList.item,"slot1");a.x=26*e,a.visible=!1,h.addChild(a)}
let u=new createjs.Container;u.y=150;for(let e=0;e<3;e++){
let t=new createjs.Sprite(gameOJ.SpriteSheetList.icon,"emptySlot");t.x=26*e,t.y=-24,c.addChild(t)
;let a=new createjs.Sprite(gameOJ.SpriteSheetList.item,"slot"+(e+1));a.x=26*e,a.y=-24
;let i=gameOJ.buildText("0",30);i.x=26*e+25-10,i.y=50,c.addChild(a),u.addChild(i)}let p={x:0,y:0
},O=new createjs.Container,J=new createjs.Container;J.y=40,J.x=30,J.saveChild=[]
;for(let t=0;t<gameOJ.slotInfor.length;t++){let a=gameOJ.slotInfor[t];if(a.build.length>0){
let t=new createjs.Container,i=new createjs.Sprite(gameOJ.SpriteSheetList.icon,"buildBack"),n=new createjs.Sprite(gameOJ.SpriteSheetList.item,"slot"+a.id)
;i.alpha=.8,t.addChild(i,n),t.cache(0,0,50,50),t.hitArea=e,t.removeAllChildren(),t.x=50*p.x++,
100===t.x?(t.y=50*p.y++,p.x=0):t.y=50*p.y,t.scaleX=t.scaleY=2,O.addChild(t)
;let s=new createjs.Container;s.x=200,s.scaleY=s.scaleX=1.5
;let r=new createjs.Container,l=new createjs.Sprite(gameOJ.SpriteSheetList.icon,"buildBack"),m=new createjs.Sprite(gameOJ.SpriteSheetList.item,"slot"+a.id)
;r.x=25,r.y=10,r.addChild(l,m);let g=gameOJ.buildText(a.name,10*a.name.length);g.scaleY=2,
g.x=50-5*a.name.length;let c=gameOJ.buildText(a.dic,120);c.y=100;let h=new createjs.Container
;if(h.y=50,a.buildNum>0){
let e=(new createjs.Graphics).beginFill("#bff0ff").drawRect(r.x+25-~~(25*(a.buildNum-1)/2),5,25*(a.buildNum-1),3).drawRect(r.x+25-2,0,4,6),t=new createjs.Shape(e),i=a.buildNum%2==0?11:0,n=r.x+i-25*~~(a.buildNum/2),s=1,l=0
;for(let t=0;t<a.buildNum;t++){
let t=new createjs.Sprite(gameOJ.SpriteSheetList.icon,"buildBack"),r=new createjs.Sprite(gameOJ.SpriteSheetList.item,"slot"+a.build[l].id)
;r.x=t.x=n,n+=25,e.drawRect(r.x+25+(i>0?2:0)-2,5,4,6),h.addChild(t,r),s<a.build[l].cost?s++:(s=1,
l++)}h.addChild(t),t.cache(0,-5,25*(a.buildNum-1)+100,108)
;let o=new createjs.Container,m=new createjs.Sprite(gameOJ.SpriteSheetList.item,"slot"+a.id),g=new createjs.Sprite(gameOJ.SpriteSheetList.icon,"buildBack")
;g.alpha=.5,o.addChild(g,m),o.on("mousedown",()=>{gameOJ.buildItem([a.id])}),J.saveChild.push(o)}
let u=new createjs.Sprite(gameOJ.SpriteSheetList.icon,"install");u.x=r.x+50,u.y=5,
u.on("mousedown",()=>{"install"===u.currentAnimation&&(gameOJ.buildItem([a.id]),o.visible=!1)}),
s.addChild(r,g,c,h,u),t.buildCon=s,t.on("mousedown",()=>{d.removeAllChildren(),d.addChild(s)})}}
m.cache(0,0,400,300),m.removeAllChildren()
;let f=new createjs.Container,y=new createjs.Sprite(gameOJ.SpriteSheetList.icon,"buildBack")
;y.alpha=.5,f.addChild(y,new createjs.Sprite(gameOJ.SpriteSheetList.icon,"closeIcon")),
f.cache(0,0,50,50),f.removeAllChildren(),f.x=400,f.hitArea=e,f.on("mousedown",()=>{o.visible=!1}),
o.regX=200,o.regY=125,o.x=gameOJ.gameW/2,o.y=gameOJ.gameH/2,o.addChild(m,h,u,O,d,f),o.visible=!1
;let S=new createjs.Sprite(gameOJ.SpriteSheetList.icon,"buildItem");S.hitArea=e,S.y=40,
S.on("mousedown",()=>{o.visible=!o.visible
}),gameOJ.stage2.getChildAt(gameOJ.staticValues.alertLayerNumer).addChild(t,a,r,l,S,o,J)},
tick:function(e){1==gameOJ.gameTT?gameOJ.tickMenu():2==gameOJ.gameTT&&gameOJ.tickPlay(e),
gameOJ.gameNN++,gameOJ.stage.update()},tickMenu:function(){if(0===gameOJ.gameNN){gameOJ.resetGame()
;var e=new createjs.Bitmap(gameOJ.loadMC.getAsset("menuImage")),t=new createjs.Bitmap(gameOJ.loadMC.getAsset("uiList"))
;t.sourceRect=new createjs.Rectangle(168,293,45,45),t.x=gameOJ.gameW/2-35-45,t.y=120
;var a=new createjs.Bitmap(gameOJ.loadMC.getAsset("uiList"))
;a.sourceRect=new createjs.Rectangle(216,293,46,46),a.x=gameOJ.gameW/2+32,a.y=120
;for(var i=new createjs.Container,n=1;n<4;n++){
let e=new createjs.Sprite(gameOJ.SpriteSheetList.TankBase,"tank"+n),t=new createjs.Sprite(gameOJ.SpriteSheetList.TankTurret,"tank"+n)
;e.x=32*(n-1),t.x=e.x,i.addChild(e,t)}i.cache(0,0,32*n-1,32)
;var s=new createjs.Bitmap(i.cacheCanvas)
;s.sourceRect=new createjs.Rectangle(32*(gameOJ.pickedTank-1),0,32,32),s.scaleX=s.scaleY=2,
s.regX=s.regY=16,s.y=gameOJ.gameH/2-64+50,s.x=gameOJ.gameW/2
;var r=new createjs.Bitmap(gameOJ.loadMC.getAsset("uiList"))
;r.sourceRect=new createjs.Rectangle(30,295,110,110),r.regX=r.regY=55,r.x=gameOJ.gameW/2,
r.y=gameOJ.gameH/2+80+50
;var l=new createjs.Container,o=new createjs.Text(document.getElementById("userJoinGameName").value,"15px Arial","#FFFFFF"),m=new createjs.Shape((new createjs.Graphics).beginStroke("white").f("#999999").drawRect(0,0,200,30))
;o.maxWidth=200,o.maxHeight=30,o.textAlign="center",o.x=100,o.y=7,l.addChild(m,o),
l.cache(0,0,200,30),l.regX=100,l.regY=15,l.x=gameOJ.gameW/2,l.y=gameOJ.gameH/2+50
;var g=new createjs.Bitmap(gameOJ.loadMC.getAsset("logo"))
;g.sourceRect=new createjs.Rectangle(0,0,200,64),g.x=gameOJ.gameW/2,g.y=gameOJ.gameH/2-80,
g.regX=100,g.regY=32
;var c=new createjs.Shape((new createjs.Graphics).f("#000000").drawRect(0,0,250,270))
;c.x=gameOJ.gameW/2,c.y=gameOJ.gameH/2,c.regX=125,c.regY=125,c.alpha=.5,c.cache(0,0,250,270)
;var h=new createjs.Container,d=new createjs.Sprite(this.SpriteSheetList.icon)
;d.gotoAndStop(gameOJ.gameSetting.fullScreen?"fullScreenExit":"fullScreenGo"),d.x=gameOJ.gameW-50,
d.y=-10;var u=new createjs.Sprite(this.SpriteSheetList.icon)
;return u.gotoAndStop(gameOJ.gameSetting.allowSound?"soundAllow":"soundNotAllow"),
u.x=gameOJ.gameW-100,u.y=-10,h.addChild(d,u),gameOJ.stage1.addChild(e,c,t,a,s,r,g,l,h),
t.on("mousedown",()=>{
0===s.sourceRect.x?(s.sourceRect.x=32*(n-2),gameOJ.pickedTank=n-1):(s.sourceRect.x-=32,
gameOJ.pickedTank--)}),a.on("mousedown",()=>{s.sourceRect.x===32*(n-2)?(s.sourceRect.x=0,
gameOJ.pickedTank=1):(s.sourceRect.x+=32,gameOJ.pickedTank++)}),r.on("mousedown",()=>{
gameOJ.changeTT(2),gameOJ.joinGame(document.getElementById("userJoinGameName").value)}),
l.on("mousedown",()=>{gameOJ.userNameInput.style.display="block"
;let e=document.getElementById("userJoinGameName");e.focus(),e.value=e.value
}),d.on("mousedown",()=>{"fullScreenGo"===d.currentAnimation?(d.gotoAndStop("fullScreenExit"),
gameOJ.openFullscreen()):(d.gotoAndStop("fullScreenGo"),gameOJ.exitFullscreen())}),
void u.on("mousedown",()=>{"soundAllow"===u.currentAnimation?(u.gotoAndStop("soundNotAllow"),
gameOJ.changeSoundGame(0)):(u.gotoAndStop("soundAllow"),gameOJ.changeSoundGame(1))})}},
tickPlay:function(e){if(0===gameOJ.gameNN){gameOJ.createControl()
;var t=new createjs.Bitmap(gameOJ.loadMC.getAsset("menuImage")),a=new createjs.Bitmap(gameOJ.loadMC.getAsset("uiList")),i=new createjs.Container
;a.sourceRect=new createjs.Rectangle(32,160,279,64),a.regX=a.sourceRect.width/2,
a.regY=a.sourceRect.height/2,a.x=gameOJ.gameW/2,a.y=gameOJ.gameH/2-100,i.addChild(t,a),
gameOJ.stage2.addChild(i)}else if(gameOJ.playerList.length>0){gameOJ.updateTimeText(e.delta),
gameOJ.updateSkillCountdown(gameOJ.skillValue.k1.countdown-e.delta),
gameOJ.updateDeadCountdown(e.delta)
;for(var n=0,s=0;Boolean(gameOJ.playerList[s])&&gameOJ.player;)Boolean(gameOJ.playerList[s].removed)&&gameOJ.playerList[s].removed===gameOJ.pingtime?(gameOJ.playerList[s].updateShootTime(Math.round(e.delta)),
gameOJ.playerList[s].Tick(e.delta),
s++):Boolean(gameOJ.playerList[s].removed)&&gameOJ.playerList[s].removed!==gameOJ.pingtime?(gameOJ.playerList[s].updateShootTime(Math.round(e.delta)),
gameOJ.playerList[s].Tick(e.delta),
s++):(gameOJ.addEffect(gameOJ.playerList[s].tankPoint.x,gameOJ.playerList[s].tankPoint.y,gameOJ.playerList[s].tankBaseSprite.rotation,"5"),
gameOJ.addEffect(gameOJ.playerList[s].tankPoint.x,gameOJ.playerList[s].tankPoint.y,gameOJ.playerList[s].tankBaseSprite.rotation,"2"),
gameOJ.removePlayer(gameOJ.playerList[s].playerID),n++)
;gameOJ.scoreList.redraw&&(gameOJ.updateScoreList(),gameOJ.scoreList.redraw=!1),n=0
;for(var r=0;Boolean(gameOJ.enemyList[r])&&gameOJ.player;)Boolean(gameOJ.enemyList[r].removed)&&gameOJ.enemyList[r].removed===gameOJ.pingtime?(gameOJ.enemyList[r].updateShootTime(Math.round(e.delta)),
gameOJ.enemyList[r].Tick(e.delta),
r++):Boolean(gameOJ.enemyList[r].removed)&&gameOJ.enemyList[r].removed!==gameOJ.pingtime?(gameOJ.enemyList[r].updateShootTime(Math.round(e.delta)),
gameOJ.enemyList[r].Tick(e.delta),r++):(gameOJ.removeEnemy(gameOJ.enemyList[r].playerID,r),n++);n=0
;for(var l=0;Boolean(gameOJ.bulletList[l]);)if(Boolean(gameOJ.bulletList[l].removed)&&gameOJ.bulletList[l].removed===gameOJ.pingtime)gameOJ.bulletList[l].Tick(),
l++;else if(Boolean(gameOJ.bulletList[l].removed)&&gameOJ.bulletList[l].removed!==gameOJ.pingtime)gameOJ.bulletList[l].Tick(),
l++;else{var o=gameOJ.bulletList[l]
;if(!o.fake)for(var m,g=gameOJ.bulletInfor[o.bulletStyle].effect,c=0;Boolean(m=g[c]);)gameOJ.addEffect(o.bulletPoint.x,o.bulletPoint.y,o.bulletRotation+90,""+m),
c++;gameOJ.removeBullet(o.bulletID),n++}n=0
;for(var h=0;Boolean(gameOJ.effectList[h]);)gameOJ.effectList[h].sortID-=n,
gameOJ.effectList[h].live>0?(gameOJ.effectList[h].Tick(),
h++):(gameOJ.removeEffect(gameOJ.effectList[h].sortID),n++)
;"key"===gameOJ.playerControl.controlType?(gameOJ.playerControl.mouseMoveEvent(gameOJ.stage.mouseX,gameOJ.stage.mouseY),
gameOJ.player&&(gameOJ.player.tankAimSprite.visible=gameOJ.playerControl.touchAim),
2===gameOJ.playerControl.spaceSkill.a&&gameOJ.shootSkill()):"touch"===gameOJ.playerControl.controlType&&(gameOJ.playerControl.fakeMouseMoveEvent(gameOJ.player.tankPoint.x+gameOJ.playerControl.fakeMouse.x,gameOJ.player.tankPoint.y+gameOJ.playerControl.fakeMouse.y),
gameOJ.playerControl.touchShoot&&gameOJ.player.lastShootTime<1&&(gameOJ.shootBullet(),
gameOJ.player&&(gameOJ.player.updateShootTime(Math.round(e.delta)),
gameOJ.playerControl.touchShoot=!1)),
gameOJ.player&&(gameOJ.player.tankAimSprite.visible=gameOJ.playerControl.touchAim),
2===gameOJ.playerControl.spaceSkill.a&&gameOJ.shootSkill()),
gameOJ.player&&gameOJ.moveCamera(gameOJ.player.tankPoint.x,gameOJ.player.tankPoint.y),
null!==gameOJ.player&&gameOJ.moveTurret()}
0!==gameOJ.gameEnd.endCode&&(gameOJ.createFinishMenu(gameOJ.gameEnd),
gameOJ.gameEnd.endCode>2&&gameOJ.stopAllPlayer(),gameOJ.gameEnd.endCode=0,gameOJ.gameEnd.point=0,
gameOJ.gameEnd.lastEnemy="",gameOJ.gameTime=0,gameOJ.skillValue.k1.countdown=0)},
updateData:function(e){if(2===gameOJ.gameTT&&gameOJ.gameNN>0&&null!==gameOJ.currentMap){
var t=Date.now();if(null!==e.Y){for(var a=0;a<e.Y.length;a++){update_player=e.Y[a]
;var i=gameOJ.findPlayer(update_player.p);if(-1===i){
gameOJ.addPlayer(update_player.x,update_player.y,update_player.p)
;let e=gameOJ.playerList[gameOJ.playerList.length-1];e.removed=t,e.moveSpeed=update_player.s,
e.updateVisible(!0),i=gameOJ.playerList.length-1}else{var n=gameOJ.playerList[i]
;n.updateVisible(!0)&&n.tankVisible&&(n.changePosition(update_player.x,update_player.y),
n.showTank()),
n.addNewPosition(update_player.x,update_player.y,update_player.m,update_player.moveAngle),
n.moveTurret(update_player.g),n.updateEffects(update_player.e),n.lastShootTime=update_player.reload,
n.tankHP=update_player.t,n.moveSpeed=update_player.s,n.removed=t}
null===gameOJ.player&&Boolean(gameOJ.playerID)&&gameOJ.playerList[i].playerID===gameOJ.playerID&&(gameOJ.player=gameOJ.playerList[i],
gameOJ.player.tankHpBar.getChildAt(2).sourceRect.y-=10,
gameOJ.player.tankReloadBar.getChildAt(0).sourceRect.y=40,
gameOJ.player.tankReloadBar.getChildAt(1).sourceRect.y=50,
gameOJ.stage2.removeChildAt(gameOJ.stage2.numChildren-1),gameOJ.createInGameMenu(),
gameOJ.buildTimeText())}
null!==gameOJ.userNameUpdateList&&(gameOJ.userNameUpdateList=gameOJ.updateUsername(gameOJ.userNameUpdateList)),
null!==gameOJ.dataTeam&&(gameOJ.updateTeam(gameOJ.dataTeam),gameOJ.dataTeam=null),
null!==gameOJ.tankStyleUpdateList&&(gameOJ.tankStyleUpdateList=gameOJ.updateNewTankStyle(gameOJ.tankStyleUpdateList)),
gameOJ.scoreList.updated&&(gameOJ.scoreList.updated=gameOJ.updateScoreListNick(),
gameOJ.scoreList.redraw=!0)}if(null!==e.E)for(a=0;a<e.E.length;a++){var s;update_enemy=e.E[a]
;var r=gameOJ.findEnemy(update_enemy.p);if(-1===r){
gameOJ.addEnemy(update_enemy.x,update_enemy.y,update_enemy.p,"bot",update_enemy.style)
;let e=gameOJ.enemyList[gameOJ.enemyList.length-1];e.removed=t,e.moveSpeed=update_enemy.s,
e.tankHP=update_enemy.t,
e.updateVisible(!0),update_enemy.team===gameOJ.playerTeam?(e.team=update_enemy.team,
e.tankHpBar.getChildAt(2).sourceRect.y=80,e.tankReloadBar.getChildAt(0).sourceRect.y=40,
e.tankReloadBar.getChildAt(1).sourceRect.y=50):e.team=update_enemy.team,
"2"===e.tankStyle&&e.tankBaseSprite.gotoAndPlay("item"+e.tankHP),s=e}else s=gameOJ.enemyList[r],
s.updateVisible(!0)&&s.tankVisible&&(s.changePosition(update_enemy.x,update_enemy.y),s.showTank())
;s.addNewPosition(update_enemy.x,update_enemy.y,update_enemy.m,update_enemy.moveAngle),
s.moveTurret(update_enemy.g),s.updateEffects(update_enemy.e),s.lastShootTime=update_enemy.reload,
s.countdown=update_enemy.reload>s.countdown?update_enemy.reload:s.countdown,
s.tankMaxHP=update_enemy.t>s.tankMaxHP?update_enemy.t:s.tankMaxHP,s.tankHP=update_enemy.t,
s.moveSpeed=update_enemy.s,s.removed=t}if(null!==e.HE)for(a=0;a<e.HE.length;a++){
r=gameOJ.findEnemy(e.HE[a]);-1!==r&&(gameOJ.enemyList[r].removed=0)}if(null!==e.B){
let n=~~(100*Math.random()+1)+gameOJ.gameNN;for(a=0;a<e.B.length;a++){
var l=e.B[a],o=gameOJ.findBullet(l.i);if(-1===o){var m=gameOJ.player||{tankPoint:{x:0,y:0}}
;if(gameOJ.addBullet(l.x,l.y,l.r,l.p,l.i,l.s),
gameOJ.bulletList[gameOJ.bulletList.length-1].removed=t,
gameOJ.playSound(gameOJ.bulletInfor[l.s].sound,Math.abs(m.tankPoint.x-l.x),Math.abs((m.tankPoint.y||0)-l.y),n),
gameOJ.addEffect(l.x,l.y,l.r+90,"17"),l.n&&"3_1"!=l.s){if("e"!==l.p.charAt(l.p.length-1)){
i=gameOJ.findPlayer(l.p);var g=gameOJ.playerList}else i=gameOJ.findEnemy(l.p),g=gameOJ.enemyList
;if(-1!==i){let e=g[i];e.tankTurretSprite.gotoAndPlay(e.objectType+e.tankStyle+"s")}}
}else gameOJ.bulletList[o].removed=t}}if(null!==e.H)for(a=0;a<e.H.length;a++){
i=gameOJ.findPlayer(e.H[a]);-1!==i&&gameOJ.playerList[i].updateVisible(!1)}
Boolean(e.e)&&gameOJ.applyEffect(e.e),null!==gameOJ.dataDead&&(gameOJ.updateDead(gameOJ.dataDead),
gameOJ.dataDead=null),gameOJ.pingtime=t,gameOJ.moveTankData.Y=null,gameOJ.moveTankData.B=null,
gameOJ.moveTankData.H=null,gameOJ.moveTankData.E=null,gameOJ.moveTankData.HE=null}},
applyEffect:function(e,t=!0){if(2===gameOJ.gameTT&&null!==gameOJ.currentMap){
var a,i=e.split(";"),n=0;for(i.length--;Boolean(a=i[n]);){let e=a.split(",")
;"I"===e[0]?gameOJ.addItem(parseInt(e[1]),parseInt(e[2]),parseInt(e[3]),e[4]):"RI"===e[0]?gameOJ.removeItem(e[1]):"E"===e[0]&&t?gameOJ.addEffect(parseInt(e[1]),parseInt(e[2]),parseInt(e[3]),e[4]):"E"!==e[0]&&gameOJ.changeMapCanvas("map"+e[0]+"Layer",parseInt(e[1]),parseInt(e[2]),parseInt(e[3]),parseInt(e[4])),
n++}}},saveTankData:function(e){gameOJ.moveTankData.Y=e,gameOJ.updateData(gameOJ.moveTankData)},
saveBulletData:function(e){gameOJ.moveTankData.B=e,gameOJ.updateData(gameOJ.moveTankData)},
saveEnemyData:function(e){gameOJ.moveTankData.E=e,gameOJ.updateData(gameOJ.moveTankData)},
saveHideTankData:function(e){gameOJ.moveTankData.H=e,gameOJ.updateData(gameOJ.moveTankData)},
saveHideEnemyData:function(e){gameOJ.moveTankData.HE=e,gameOJ.updateData(gameOJ.moveTankData)},
saveUpdateUserName:function(e){2===gameOJ.gameTT&&(gameOJ.userNameUpdateList=e)},
saveUpdateTankStyle:function(e){2===gameOJ.gameTT&&(gameOJ.tankStyleUpdateList=e)},
savePlayerID:function(e){2===gameOJ.gameTT&&(gameOJ.playerID=e)},saveDataTeam:function(e){
gameOJ.dataTeam=e},saveDeadData:function(e){gameOJ.dataDead=e},saveDetroyedBullet:function(e){
for(var t=0;t<e.length;t++){var a=gameOJ.findBullet(e[t]);-1!==a&&(gameOJ.bulletList[a].removed=0)}
},saveLogoutPlayer:function(e){for(var t=0;t<e.length;t++){var a=gameOJ.findPlayer(e[t])
;-1!==a&&(gameOJ.playerList[a].removed=0)}},updateTeam:function(e){for(var t=0;t<e.length;t++){
var a=e[t],i=gameOJ.findPlayer(a.playerID);if(-1!==i){let e=gameOJ.playerList[i]
;a.teamID===gameOJ.playerTeam&&e!==gameOJ.player?(e.team=a.teamID,
e.tankHpBar.getChildAt(2).sourceRect.y=80,e.tankReloadBar.getChildAt(0).sourceRect.y=40,
e.tankReloadBar.getChildAt(1).sourceRect.y=50):e.team=a.teamID}}},updateDead:function(e){
for(var t=0;t<e.length;t++){var a=e[t],i=gameOJ.findPlayer(a.playerId);if(-1!==i){
let e=gameOJ.playerList[i];e.updateVisible(!1),e.movePointList=[],e.targetMove={baseRotaion:null,
tankPosition:null,turretRotation:null},e===gameOJ.player&&(gameOJ.player.comboKill=0,
gameOJ.stage2.getChildAt(gameOJ.staticValues.alertLayerNumer).getChildAt(2).countdown=parseInt(a.time))
}}},updateStatus:function(e){
2===gameOJ.gameTT&&(gameOJ.gameEnd.endCode=e.r,gameOJ.gameEnd.point=e.p,
gameOJ.gameEnd.lastEnemy=e.rs)},updateSkillIcon:function(e){
gameOJ.stage2.getChildAt(gameOJ.staticValues.alertLayerNumer).getChildAt(1).getChildAt(1).gotoAndStop("skill"+e)
},updateSkill:function(e){for(var t=0;t<e.length;t++){var a=e[t];a.index
;gameOJ.updateSkillCountdown(a.countDown)}},updateSlot:function(e){for(let t=0;t<e.length;t++){
let a=gameOJ.findPlayer(e[t].playerID);if(-1!==a){let i=gameOJ.playerList[a]
;if(i.slot=0===e[t].slotList[0]?[]:e[t].slotList,i===gameOJ.player){
let a=gameOJ.stage2.getChildAt(gameOJ.staticValues.alertLayerNumer).getChildAt(5).getChildAt(1),n=gameOJ.stage2.getChildAt(gameOJ.staticValues.alertLayerNumer).getChildAt(6)
;for(let e=0,t=a.numChildren;e<t;e++)e<i.slot.length?(a.getChildAt(e).gotoAndPlay("slot"+i.slot[e]),
a.getChildAt(e).visible=!0):a.getChildAt(e).visible=!1
;let s=gameOJ.stage2.getChildAt(gameOJ.staticValues.alertLayerNumer).getChildAt(5).getChildAt(2)
;for(let a=0,n=i.unlimitSlot.length,r=e[t].unlimitSlot;a<n;a++){let e=s.getChildAt(a)
;i.unlimitSlot[a]=r[a]||0,e.text!==i.unlimitSlot[a]+""&&gameOJ.buildText(i.unlimitSlot[a]+"",5,e)}
n.removeAllChildren()
;let r=-40,l=gameOJ.stage2.getChildAt(gameOJ.staticValues.alertLayerNumer).getChildAt(5).getChildAt(3)
;for(let e=3;e<gameOJ.slotInfor.length;e++){let t=gameOJ.slotInfor[e];if(i.canBuildSlot(t.id)){
let e=n.saveChild[t.id-4]
;e.y=r+=30,n.addChild(e),l.getChildAt(t.id-4).buildCon.getChildAt(4).gotoAndPlay("install")
}else l.getChildAt(t.id-4).buildCon.getChildAt(4).gotoAndPlay("installOff")}if(n.numChildren>0){
let e=new createjs.Container,t=new createjs.Sprite(gameOJ.SpriteSheetList.icon,"buildBack")
;t.alpha=.5,e.addChild(t,new createjs.Sprite(gameOJ.SpriteSheetList.icon,"closeIcon")),
e.x=n.getChildAt(0).x+30,e.y=n.getChildAt(0).y,n.addChild(e),e.on("mousedown",()=>{
n.removeAllChildren()})}}if(!0===i.tankVisible){let a=e[t].updateItem
;if(0!==a[0])for(let e=0,t=a.length;e<t;e++)gameOJ.addEffect(i.tankPoint.x,i.tankPoint.y,0,"item",!1,new createjs.Sprite(gameOJ.SpriteSheetList.item,"slot"+a[e]))
}}}},updateDeadCountdown:function(e){if(0===gameOJ.gameTime)return
;var t=gameOJ.stage2.getChildAt(gameOJ.staticValues.alertLayerNumer).getChildAt(2)
;if(t.countdown-=e,t.countdown<0)return t.countdown=0,void(t.visible=!1);t.visible=!0
;let a=~~(t.countdown/1e3)+"",i=Math.max(t.numChildren,a.length)
;for(var n=0;n<i;n++)if(n<t.numChildren&&n<a.length)t.getChildAt(n).gotoAndStop("c"+a.charAt(n));else if(n>=t.numChildren){
let e=new createjs.Sprite(gameOJ.SpriteSheetList.font,"c"+a.charAt(n));t.addChild(e)
}else n>=a.length&&t.removeChildAt(n)},updateSkillCountdown:function(e){if(0!==gameOJ.gameTime){
e<=0&&(e=0),gameOJ.skillValue.k1.countdown=e
;var t=~~(parseInt(e)/1e3)+"",a=gameOJ.stage2.getChildAt(gameOJ.staticValues.alertLayerNumer).getChildAt(1).getChildAt(2),i=Math.max(t.length,a.numChildren)
;a.visible=e>0
;for(var n=0;n<i;n++)if(n<a.numChildren)a.getChildAt(n).gotoAndStop("c"+t.charAt(n));else if(n>=a.numChildren){
let e=new createjs.Sprite(gameOJ.SpriteSheetList.font);e.gotoAndStop("c"+t.charAt(n)),e.x=10*n,
a.addChild(e)}else n>=t.length&&a.removeChildAt(n)}},saveScore:function(e){
if(2===gameOJ.gameTT)for(var t,a=0;t=e[a];){
var i=gameOJ.scoreList.value.findIndex(e=>e.playerID===t.playerID)
;for(-1!==i?(gameOJ.scoreList.value[i].point=t.point,gameOJ.scoreList.value[i].dead=t.d,
gameOJ.scoreList.updated=!0,gameOJ.scoreList.redraw=!0):(gameOJ.scoreList.value.push({
playerID:t.playerID,point:t.point,dead:t.d,nick:"@",team:""}),gameOJ.scoreList.updated=!0,
i=gameOJ.scoreList.value.length-1);i>0&&gameOJ.scoreList.value[i-1].point<t.point;){
let e=gameOJ.scoreList.value[i-1];gameOJ.scoreList.value[i-1]=gameOJ.scoreList.value[i],
gameOJ.scoreList.value[i]=e,i-=1}a++}},updateUsername:function(e){if(2===gameOJ.gameTT){
for(var t=[],a=0;a<e.length;a++){var i=e[a],n=gameOJ.findPlayer(i.playerID)
;-1!==n?gameOJ.playerList[n].updateNickName(i.playerName):t.push(i)}return t.length>0?t:null}
return null},updateNewTankStyle:function(e){if(2===gameOJ.gameTT){for(var t=[],a=0;a<e.length;a++){
var i=e[a],n=gameOJ.findPlayer(i.p);if(-1!==n){var s=gameOJ.playerList[n];s.updateTankStyle(i.s),
gameOJ.player===s&&(s.setTankAim(s.tankStyle),gameOJ.updateSkillIcon(s.tankStyle+"_1"))
}else t.push(i)}return t.length>0?t:null}return null},getAndBuildMap:function(e){
2===gameOJ.gameTT&&gameOJ.createMap(e.mapName)},joinGame:function(e){
gameOJ.Socket.emit("join-game",{userName:e,tankStyle:""+gameOJ.pickedTank})},movePlayer:function(e){
null!==gameOJ.player&&gameOJ.Socket.emit(gameOJ.socketName.moveTank,e)},moveTurret:function(){
gameOJ.gameNN},shootBullet:function(){if(null!==gameOJ.player){var e=gameOJ.player.shoot()
;gameOJ.Socket.emit(gameOJ.socketName.shootBullet,Math.round(e))}},shootSkill:function(){
null!==gameOJ.player&&(gameOJ.Socket.emit(gameOJ.socketName.shootSkill,{
t:gameOJ.playerControl.spaceSkill.t,r:Math.round(gameOJ.playerControl.spaceSkill.r),
p:gameOJ.playerControl.spaceSkill.p}),gameOJ.playerControl.spaceSkill.a=0)},buildItem:function(e){
null!==gameOJ.player&&gameOJ.Socket.emit(gameOJ.socketName.buildItem,e)},leaveMatch:function(){
gameOJ.Socket.emit("leave-match","ok")},createControl:function(){
gameOJ.playerControl=new gameOJ.GameControl}};(function(){function e(e,t,a,i="@",n="tank"){
this.tankMaxHP=500,this.countdown=300,this.timeNowServer=0,this.nextBullet="1",this.tankRSize=15,
this.killPoint=0,this.comboKill=0,this.slot=[],this.unlimitSlot=[0,0,0],this.canUpSlot=[],
this.lastShootTime=0,this.tankPoint=new KhoiTest._Point(e,t),this.tankVisible=!0,this.gunAngle=0,
this.tankHP=500,this.moveSpeed=1.5,this.playerName=i,this.tankStyle="1",this.playerID=a,
this.removed=1,this.movePointList=[],this.team="",this.objectType=n,this.targetMove={
baseRotaion:null,tankPosition:null,turretRotation:null},this.tankAimSprite=new createjs.Shape,
this.tankEffectSprite=new createjs.Container,
this.tankNickSprite=gameOJ.buildText(this.playerName,10*this.playerName.length),
this.tankBaseSprite=new createjs.Sprite(gameOJ.SpriteSheetList.TankBase,"tank"+this.tankStyle),
this.tankTurretSprite=new createjs.Sprite(gameOJ.SpriteSheetList.TankTurret,"tank"+this.tankStyle),
this.tankHpBar=new createjs.Container,this.tankReloadBar=new createjs.Container,
this.tankGraphic=new createjs.Container,
this.tankGraphic.addChild(this.tankBaseSprite,this.tankTurretSprite,this.tankAimSprite,this.tankEffectSprite,this.tankNickSprite,this.tankHpBar,this.tankReloadBar),
this.tankBaseSprite.regX=this.tankBaseSprite.regY=16,
this.tankTurretSprite.regX=this.tankTurretSprite.regY=16;var s=10*this.playerName.length
;this.tankNickSprite.regX=s/2,this.tankNickSprite.regY=15
;var r=new createjs.Bitmap(gameOJ.loadMC.getAsset("hpbar")),l=new createjs.Bitmap(gameOJ.loadMC.getAsset("hpbar")),o=new createjs.Bitmap(gameOJ.loadMC.getAsset("hpbar"))
;l.x=1,
o.x=1,r.sourceRect=new createjs.Rectangle(0,0,30,10),l.sourceRect=new createjs.Rectangle(0,30,30,10),
o.sourceRect=new createjs.Rectangle(0,10,30,10),
this.tankHpBar.addChild(r,o,l),this.tankHpBar.regX=15,this.tankHpBar.regY=30
;var m=new createjs.Bitmap(gameOJ.loadMC.getAsset("hpbar")),g=new createjs.Bitmap(gameOJ.loadMC.getAsset("hpbar"))
;g.x=1,
m.sourceRect=new createjs.Rectangle(0,60,30,10),g.sourceRect=new createjs.Rectangle(0,70,30,10),
this.tankReloadBar.addChild(m,g),this.tankReloadBar.regX=15,this.tankReloadBar.regY=5,
this.tankReloadBar.y=-31,this.tankReloadBar.visible=!1,this.tankAimSprite.visible=!1
;let c=new createjs.Sprite(gameOJ.SpriteSheetList.effect_p,"effect1");c.visible=!1,c.regX=c.regY=25,
c.effectType=1;let h=new createjs.Sprite(gameOJ.SpriteSheetList.effect_p,"effect2");h.visible=!1,
h.regX=h.regY=25,h.alpha=.5,h.effectType=2;let d=new createjs.Container;d.visible=!1,d.effectType=3
;let u=new createjs.Sprite(gameOJ.SpriteSheetList.effect_p,"effect3");u.visible=!1,u.regX=u.regY=25,
u.effectType=4;let p=new createjs.Sprite(gameOJ.SpriteSheetList.effect_p,"effect4");p.visible=!1,
p.regX=p.regY=25,p.alpha=.5,p.effectType=5;let O=new createjs.Container;O.visible=!1,O.effectType=6
;let J=new createjs.Sprite(gameOJ.SpriteSheetList.effect_p,"effect5");J.visible=!1,J.regX=J.regY=25,
J.alpha=.5,J.effectType=7;let f=new createjs.Sprite(gameOJ.SpriteSheetList.effect_p,"effect6")
;f.visible=!1,f.regX=f.regY=25,f.alpha=1,f.effectType=8;let y=new createjs.Container;y.effectType=9
;let S=new createjs.Sprite(gameOJ.SpriteSheetList.effect_p,"effect10");S.visible=!1,
S.regX=S.regY=25,S.alpha=.5,S.effectType=10
;let k=new createjs.Sprite(gameOJ.SpriteSheetList.effect_p,"effect11");k.visible=!1,
k.regX=k.regY=25,
k.alpha=.6,k.effectType=11,this.effectSpriteStore=[],this.effectSpriteStore.push(c,h,d,u,p,O,J,f,y,S,k),
this.changePosition(e,t,s,15),this.changeTurretRotation(this.gunAngle)}var t=e.prototype
;t.moveTo=function(e,t,a,i=-1){var n=new KhoiTest._Point(e,t)
;if(i<0)var s=Math.max(this.moveSpeed,this.tankPoint.lengP(n)/5);else s=i
;var r=this.tankPoint.angleP(n);this.updateHistoryMove(a),this.targetMove.tankPosition={
targetPoint:n,stepValue:s,angle:r}},t.updateEffects=function(e){
if("enemy"!==this.objectType||"2"!==this.tankStyle){for(var t=[],a=0;a<e.length;a++){
var i=e[a],n=this.effectSpriteStore[i-1];t[i]=!0,6===i&&(this.tankGraphic.alpha=.6),
n.visible||(this.tankEffectSprite.addChild(n),
n.visible=!0,Boolean(gameOJ.Sound["peffect"+i])&&gameOJ.playSound("peffect"+ +i,Math.abs(this.tankPoint.x-gameOJ.player.tankPoint.x),Math.abs(this.tankPoint.y-gameOJ.player.tankPoint.y)))
}for(var s=0;s<this.tankEffectSprite.numChildren;s++){var r=this.tankEffectSprite.getChildAt(s)
;Boolean(t[r.effectType])||(r.visible=!1,
6===r.effectType?this.tankGraphic.alpha=1:8===r.effectType&&this===gameOJ.player&&(gameOJ.playerControl.touchCode=-1),
this.tankEffectSprite.removeChildAt(s),s--)}}},t.updateVisible=function(e){
if(e===this.tankVisible)return!1;if(this.tankVisible=e,!e){var t={x:0,y:0}
;0===this.movePointList.length?(t.x=this.tankPoint.x+1,
t.y=this.tankPoint.y+1):(t.x=this.movePointList[this.movePointList.length-1].x,
t.y=this.movePointList[this.movePointList.length-1].y),this.hideTank()}return!0},
t.updateKillPoint=function(e){var t=this,a=e-this.killPoint;this.killPoint=e,this.comboKill+=a,
a>0&&gameOJ.displayKillIcon(t.comboKill)},t.showTank=function(){this.tankGraphic.visible=!0},
t.hideTank=function(){this.tankGraphic.visible=!1,this.targetMove.tankPosition=null,
this.movePointList.length=0},t.addNewPosition=function(e,t,a,i=0){
1===this.movePointList.length&&this.movePointList[0].reuse&&(this.targetMove.tankPosition=null),
this.movePointList.push({x:e,y:t,moveCode:a,reuse:!1,moveAngle:i})
},t.updateNickName=function(e,t=null){if(this.playerName!==e){this.playerName=e,
gameOJ.buildText(e,10*e.length,this.tankNickSprite);var a=10*e.length;this.tankNickSprite.regX=a/2,
this.tankNickSprite.regY=40,this.tankNickSprite.scaleY=1.5}},t.updateTankStyle=function(e){
this.tankStyle=e,
this.tankBaseSprite.gotoAndPlay("tank"+e),this.tankTurretSprite.gotoAndPlay("tank"+e),
"1"===e?(this.countdown=750,this.nextBullet="1",this.tankHP=500-this.tankMaxHP+this.tankHP,
this.tankMaxHP=500,this.tankRSize=15):"2"===e?(this.countdown=1e3,this.nextBullet="2",
this.tankHP=700-this.tankMaxHP+this.tankHP,
this.tankMaxHP=700,this.tankRSize=15):"3"===e&&(this.countdown=1e3,this.nextBullet="3",
this.tankHP=500-this.tankMaxHP+this.tankHP,this.tankMaxHP=500,this.tankRSize=15)},
t.setTankAim=function(e){
"1"===e?(this.tankAimSprite.graphics.beginFill("#2300f5").drawRect(0,0,20,280),
this.tankAimSprite.regY=295,this.tankAimSprite.regX=10,this.tankAimSprite.alpha=.3,
this.tankAimSprite.cache(0,0,20,280)):"2"===e?(this.tankAimSprite.graphics.s("#2300f5").drawCircle(0,0,30),
this.tankAimSprite.regY=0,this.tankAimSprite.regX=0,this.tankAimSprite.alpha=.2,
this.tankAimSprite.cache(-30,-30,60,60)):"3"===e?(this.tankAimSprite.graphics.beginFill("#2300f5").drawRect(0,0,20,280),
this.tankAimSprite.regY=295,this.tankAimSprite.regX=10,this.tankAimSprite.alpha=.3,
this.tankAimSprite.cache(0,0,20,280)):"4"===e&&(this.tankAimSprite.graphics.sd([2,2]).setStrokeStyle(2).beginStroke("red").drawRect(0,0,3,gameOJ.gameW),
this.tankAimSprite.regY=gameOJ.gameW+15,this.tankAimSprite.regX=1,this.tankAimSprite.alpha=.5,
this.tankAimSprite.cache(0,0,3,gameOJ.gameW))},t.applyNewPosition=function(e){var t,a=-1
;if(this.movePointList.length>10&&(this.movePointList=[this.movePointList[this.movePointList.length-1],this.movePointList[this.movePointList.length-2]],
this.changePosition(this.movePointList[0].x,this.movePointList[0].y)),
0!==this.movePointList.length){
if(1===this.movePointList.length&&-1===this.movePointList[0].moveCode)return this.movePointList.shift(),
void(this.targetMove.tankPosition=null);if(1===this.movePointList.length){
if(t=this.movePointList[0],null!==this.targetMove.tankPosition){
let e=8!==t.moveCode?45*(t.moveCode-2):t.moveAngle
;newPoint=this.tankPoint.moveT(66*this.moveSpeed,e),t.x=newPoint.x,t.y=newPoint.y,a=this.moveSpeed,
t.reuse=!0}}else this.movePointList.length>1&&(this.movePointList.shift(),t=this.movePointList[0])
;this.moveTo(t.x,t.y,t.moveCode,a)}else this.targetMove.tankPosition=null
},t.shootFakeBullet=function(e){var t=this.timeNowServer;this.gunAngle=e
;var a=this.tankPoint.moveT(16,e-90);return gameOJ.addBullet(a.x,a.y,e,this.playerID,"1","fake",!0),
gameOJ.bulletList[gameOJ.bulletList.length-1].removed=gameOJ.pingtime,this.lastShootTime=t,!0},
t.changePosition=function(e,t){this.tankPoint.setV(e,t),this.tankGraphic.x=e,this.tankGraphic.y=t},
t.updateBloodBar=function(){
this.tankHpBar.getChildAt(2).sourceRect.x=30-this.tankHP/this.tankMaxHP*30,
this.tankHpBar.getChildAt(1).sourceRect.x<this.tankHpBar.getChildAt(2).sourceRect.x?this.tankHpBar.getChildAt(1).sourceRect.x+=1:this.tankHpBar.getChildAt(1).sourceRect.x=this.tankHpBar.getChildAt(2).sourceRect.x
},t.moveTurret=function(e){var t=e,a=this.tankTurretSprite.rotation,i=1
;if(Math.abs(a-t)<1e-4)this.tankTurretSprite.rotation=t;else{if(a<180)var n=a+180,s=a,r=1;else n=a,
s=a-180,r=-1
;t>=s&&t<n?i*=r:i=-i*r,i*=i>0&&t<a?Math.abs(360-a+t)/5:i<0&&t>a?Math.abs(360-t+a)/5:Math.abs(a-t)/5,
this.targetMove.turretRotation={value:t,stepValue:i}}},t.changeTurretRotation=function(e){
e<0&&(e+=360),this.gunAngle=e,this.tankTurretSprite.rotation=e},t.updateHistoryMove=function(e){
if(-1!==e&&8!==e&&this.tankBaseSprite.rotation!==45*e){var t=45*e,a=5,i=this.tankBaseSprite.rotation
;if(i<180)var n=i+180,s=i,r=1;else n=i,s=i-180,r=-1
;t>=s&&t<n?a*=r:a=-a*r,this.targetMove.baseRotaion={value:t,stepValue:a}
}else this.targetMove.baseRotaion=null},t.shoot=function(){return this.gunAngle},
t.updateShootTime=function(e){
0!==this.lastShootTime&&(this.lastShootTime-=e,this.tankReloadBar.visible=!0,
this.tankReloadBar.getChildAt(1).sourceRect.width=30*(this.countdown-this.lastShootTime)/this.countdown,
this.lastShootTime<=0&&(this.lastShootTime=0,this.tankReloadBar.visible=!1))
},t.countSlot=function(e,t=100,a=[]){if(e<4)return Math.min(this.unlimitSlot[e-1],t);var i=0,n=0
;return this.slot.findIndex(s=>(s===e&&a.push(n)&&i++,n++,i===t)),i},t.canBuildSlot=function(e){
let t=gameOJ.getSlotInfor(e-1);if(null===t||0===t.build.length)return!1
;for(let e=0;e<t.build.length;e++){let a=t.build[e];if(this.countSlot(a.id,a.cost)<a.cost)return!1}
return!0},t.Tick=function(e){
if(this.updateBloodBar(),null!==this.targetMove.baseRotaion&&(this.tankBaseSprite.rotation+=this.targetMove.baseRotaion.stepValue,
this.tankBaseSprite.rotation<0?this.tankBaseSprite.rotation=360+this.tankBaseSprite.rotation:this.tankBaseSprite.rotation>=360&&(this.tankBaseSprite.rotation=this.tankBaseSprite.rotation%360),
Math.abs(this.tankBaseSprite.rotation+this.targetMove.baseRotaion.stepValue-this.targetMove.baseRotaion.value)<Math.abs(this.targetMove.baseRotaion.stepValue)?(this.tankBaseSprite.rotation=this.targetMove.baseRotaion.value,
this.targetMove.baseRotaion=null):this.tankBaseSprite.rotation===this.targetMove.baseRotaion.value&&(this.targetMove.baseRotaion=null)),
null!==this.targetMove.tankPosition){
var t=this.tankPoint.lengP(this.targetMove.tankPosition.targetPoint),a=e<16.7?e/16.7:1;a=1
;if(t>this.targetMove.tankPosition.stepValue*a){
var i=this.tankPoint.moveT(this.targetMove.tankPosition.stepValue*a,this.targetMove.tankPosition.angle)
;this.changePosition(i.x,i.y)
}else this.changePosition(this.targetMove.tankPosition.targetPoint.x,this.targetMove.tankPosition.targetPoint.y),
this.applyNewPosition(t)}else this.applyNewPosition();if(null!==this.targetMove.turretRotation){
var n=this.tankTurretSprite.rotation
;this.changeTurretRotation(this.tankTurretSprite.rotation+this.targetMove.turretRotation.stepValue)
;var s=1
;this.tankTurretSprite.rotation<0?(this.changeTurretRotation(360+this.tankTurretSprite.rotation),
s=-1):this.tankTurretSprite.rotation>=360&&(this.changeTurretRotation(this.tankTurretSprite.rotation%360),
s=-1),
(Math.abs(this.tankTurretSprite.rotation+this.targetMove.turretRotation.stepValue-this.targetMove.turretRotation.value)<Math.abs(this.targetMove.turretRotation.stepValue)||this.tankTurretSprite.rotation===this.targetMove.turretRotation.value||s*(this.tankTurretSprite.rotation-this.targetMove.turretRotation.value)*(n-this.targetMove.turretRotation.value)<0)&&(this.changeTurretRotation(this.targetMove.turretRotation.value),
this.targetMove.turretRotation=null)}this.tankAimSprite.rotation=gameOJ.playerControl.spaceSkill.r},
gameOJ.addCon("Player",e)})(),function(){function e(e,t,a,i="@",n="1"){
gameOJ.Player.call(this,e,t,a,i,"enemy"),this.updateTankStyle(n),this.tankNickSprite.visible=!1,
this.master=""}gameOJ.KetThua(gameOJ.Player,e);var t=e.prototype;t.updateTankStyle=function(e="1"){
this.tankStyle=e,
"1"===e?(this.countdown=750,this.nextBullet="1",this.tankHP=100-this.tankMaxHP+this.tankHP,
this.tankMaxHP=100,
this.tankRSize=15,this.tankGraphic.removeChildAt(0),this.tankGraphic.removeChildAt(0),
this.tankBaseSprite=new createjs.Sprite(gameOJ.SpriteSheetList.Enemy,"enemy1"),
this.tankTurretSprite=new createjs.Sprite(gameOJ.SpriteSheetList.EnemyTurret,"enemy1"),
this.tankBaseSprite.regX=this.tankBaseSprite.regY=25,
this.tankTurretSprite.regX=this.tankTurretSprite.regY=25,this.tankBaseSprite.gotoAndPlay("tank"+e),
this.tankTurretSprite.gotoAndPlay("tank"+e),this.tankGraphic.addChildAt(this.tankBaseSprite,0),
this.tankGraphic.addChildAt(this.tankTurretSprite,1)):"2"===e&&(this.countdown=750,
this.nextBullet="1",this.tankHP=100-this.tankMaxHP+this.tankHP,this.tankMaxHP=100,this.tankRSize=15,
this.tankBaseSprite=new createjs.Sprite(gameOJ.SpriteSheetList.item,"item1"),
this.tankBaseSprite.regX=this.tankBaseSprite.regY=25,this.tankTurretSprite.visible=!1,
this.tankGraphic.removeChildAt(0),this.tankGraphic.addChildAt(this.tankBaseSprite,0),
this.tankHpBar.visible=!1,this.tankEffectSprite.visible=!1)},gameOJ.addCon("Enemy",e)}(),function(){
function e(e,t,a,i,n,s,r=!1){this.bulletPoint=new KhoiTest._Point(e,t),this.bulletRotation=a,
this.playerID=i,this.bulletID=n,this.live=1,this.speed=gameOJ.bulletInfor[s].speed,
this.bulletStyle=s,
this.fake=r,this.removed=1,this.bulletSprite=new createjs.Sprite(gameOJ.SpriteSheetList.bullet,s),
this.bulletGraphic=new createjs.Container,this.bulletSprite.regX=25,this.bulletSprite.regY=25,
this.bulletSprite.rotation=this.bulletRotation+90,this.bulletGraphic.addChild(this.bulletSprite),
this.bulletGraphic.x=e,this.bulletGraphic.y=t}var t=e.prototype;t.moveTo=function(e,t){
this.changePosition(e,t)},t.changePosition=function(e,t){this.bulletPoint.setV(e,t),
this.bulletGraphic.x=e,this.bulletGraphic.y=t},t.Tick=function(){if(this.live){
var e=this.bulletPoint.moveT(this.speed,this.bulletRotation);this.changePosition(e.x,e.y)}},
gameOJ.addCon("Bullet",e)}(),function(){function e(e,t,a,i,n,s=!1,r=null){
this.effectPoint=new KhoiTest._Point(e,t),this.effectRotation=a,this.live=100,this.sortID=n,
this.style=i,
this.fixed=s,this.fixedRoot=null,this.targetMove=null,this.effectSprite=r||new createjs.Sprite(gameOJ.SpriteSheetList.effect,"effect"+i),
this.effectGraphic=new createjs.Container,this.effectSprite.regX=25,this.effectSprite.regY=25,
this.effectSprite.rotation=this.effectRotation,this.effectGraphic.addChild(this.effectSprite),
this.effectGraphic.x=e,this.effectGraphic.y=t;let l=this;var o
;"5"!==i&&"10"!=this.style&&"item"!=this.style&&this.effectSprite.on("animationend",()=>{
l.effectGraphic.visible=!1
}),"item"===this.style&&(this.live=30),Boolean(o=gameOJ.effectSound["effect"+i])&&gameOJ.playSound(o,Math.abs((Boolean(gameOJ.player)?gameOJ.player.tankPoint.x:0)-e),Math.abs((Boolean(gameOJ.player)?gameOJ.player.tankPoint.y:0)-t))
}var t=e.prototype;t.moveTo=function(e,t){this.changePosition(e,t)},t.changePosition=function(e,t){
this.effectPoint.setV(e,t),this.effectGraphic.x=e,this.effectGraphic.y=t},t.Tick=function(){
if(this.live&&(this.live--,
"5"!==this.style&&"10"!==this.style&&"3"!==this.style||(this.effectGraphic.alpha-=.01,
this.effectGraphic.scaleX+=.03,
this.effectGraphic.scaleY+=.03),"item"===this.style&&(this.effectGraphic.y--,
this.effectSprite.scaleX=this.effectSprite.scaleY+=.1,this.effectSprite.alpha-=.02),this.fixed)){
if(null===this.fixedRoot){this.fixedRoot={xp:this.effectGraphic.parent.x,
yp:this.effectGraphic.parent.y,xe:this.effectGraphic.x,ye:this.effectGraphic.y}
;let e=new KhoiTest._Point(this.effectGraphic.x+this.effectGraphic.parent.x,this.effectGraphic.y+this.effectGraphic.parent.y),t=new KhoiTest._Point(25,65)
;this.targetMove=e.angleP(t);let a=e.lengP(t)/6;this.live=~~a}
if(this.effectGraphic.x=this.fixedRoot.xe+(this.fixedRoot.xp-this.effectGraphic.parent.x),
this.effectGraphic.y=this.fixedRoot.ye+(this.fixedRoot.yp-this.effectGraphic.parent.y),
"item"===this.style){
let e=new KhoiTest._Point(this.fixedRoot.xe,this.fixedRoot.ye).moveT(6,this.targetMove)
;this.fixedRoot.xe=e.x,this.fixedRoot.ye=e.y}}},gameOJ.addCon("Effect",e)}(),function(){
function e(){
this.moveMap=[],this.moveMap.KeyDKeyW=this.moveMap.KeyWKeyD=1,this.moveMap.KeyDKeyS=this.moveMap.KeySKeyD=3,
this.moveMap.KeyAKeyS=this.moveMap.KeySKeyA=5,this.moveMap.KeyAKeyW=this.moveMap.KeyWKeyA=7,
this.moveMap.KeyW=0,this.moveMap.KeyD=2,this.moveMap.KeyS=4,this.moveMap.KeyA=6,this.moveStack=[],
this.touchCode=-1,this.fakeMouse=new KhoiTest._Point(0,0),this.touchShoot=!1,this.turretAim=!1,
this.touchAim=!1,this.spaceSkill={t:1,r:0,p:"",a:0},this.controlType=null,this.buildKeyEvent()}
var t=e.prototype;t.buildKeyEvent=function(){var e=this;document.onkeydown=function(t){
if(null===e.controlType&&(e.controlType="key",
gameOJ.stage2.getChildAt(gameOJ.staticValues.controlLayerNumber).alpha=0,
gameOJ.stage2.getChildAt(gameOJ.staticValues.controlLayerNumber).hitArea=new createjs.Shape((new createjs.Graphics).beginFill("#ff0000").drawRect(0,0,gameOJ.gameW,gameOJ.gameH)),
gameOJ.stage2.getChildAt(gameOJ.staticValues.controlLayerNumber).on("mousedown",function(){
0===e.spaceSkill.a&&gameOJ.shootBullet()})),!t)t=window.event;if(2===gameOJ.gameTT){
if("KeyS"===t.code||"KeyD"===t.code||"KeyA"===t.code||"KeyW"===t.code){
if(-1!==e.moveStack.indexOf(t.code))return
;e.moveStack.push(t.code),gameOJ.movePlayer(e.buildMoveCode())}
"KeyG"===t.code&&gameOJ.showAndHideBoard(!0),"Space"===t.code&&(e.spaceSkill.a=1,e.touchAim=!0)}},
document.onkeyup=function(t){if(2===gameOJ.gameTT){
if("KeyS"===t.code||"KeyD"===t.code||"KeyA"===t.code||"KeyW"===t.code){
var a=e.moveStack.indexOf(t.code);e.moveStack.splice(a,1),gameOJ.movePlayer(e.buildMoveCode())}
"KeyG"===t.code&&gameOJ.showAndHideBoard(!1),"Space"===t.code&&(e.spaceSkill.a=2,e.touchAim=!1)}}
;var t=new createjs.Shape((new createjs.Graphics).setStrokeStyle(2).beginStroke("#000000").drawCircle(0,0,30)),a=new createjs.Shape((new createjs.Graphics).beginFill("#000000").drawCircle(0,0,10))
;t.x=50,
t.y=gameOJ.gameH-50,t.cache(-35,-35,70,70),t.hitArea=new createjs.Shape((new createjs.Graphics).setStrokeStyle(2).beginStroke("#000000").beginFill("#000000").drawCircle(0,0,30)),
a.x=t.x,a.y=t.y,a.cache(-20,-20,40,40)
;var i=new createjs.Shape((new createjs.Graphics).setStrokeStyle(2).beginStroke("#000000").drawCircle(0,0,30)),n=new createjs.Shape((new createjs.Graphics).beginFill("#000000").drawCircle(0,0,10))
;i.x=gameOJ.gameW-60,
i.y=gameOJ.gameH-60,i.cache(-45,-45,90,90),i.hitArea=new createjs.Shape((new createjs.Graphics).setStrokeStyle(2).beginStroke("#000000").beginFill("#000000").drawCircle(0,0,30)),
n.x=i.x,n.y=i.y,n.cache(-20,-20,40,40)
;var s=new createjs.Shape((new createjs.Graphics).setStrokeStyle(2).beginStroke("#000000").drawCircle(0,0,20)),r=new KhoiTest._Point(i.x,i.y).moveT(60,-80)
;s.x=r.x,
s.y=r.y,s.cache(-45,-45,90,90),s.hitArea=new createjs.Shape((new createjs.Graphics).setStrokeStyle(2).beginStroke("#000000").beginFill("#000000").drawCircle(0,0,20)),
gameOJ.stage2.getChildAt(gameOJ.staticValues.controlLayerNumber).addChild(t,a,i,n,s),
gameOJ.stage2.getChildAt(gameOJ.staticValues.controlLayerNumber).alpha=.5,t.on("pressmove",t=>{
e.touchMoveEvent(t,e)}),t.on("mousedown",t=>{e.touchMoveEvent(t,e)}),t.on("pressup",function(){
a.x=t.x,a.y=t.y,gameOJ.movePlayer(-1),e.touchCode=-1}),i.on("pressmove",t=>{e.touchTurretEvent(t,e)
}),i.on("mousedown",t=>{e.touchTurretEvent(t,e)}),i.on("pressup",function(){n.x=i.x,n.y=i.y,
e.touchShoot=!0,e.turretAim=!1}),s.on("mousedown",t=>{e.touchSkillEvent(t,e,1)}),
s.on("pressmove",t=>{e.touchSkillEvent(t,e,1)}),s.on("pressup",function(){e.spaceSkill.a=2,
e.touchAim=!1})},t.mouseMoveEvent=function(e,t){
var a=gameOJ.stage2.getChildAt(gameOJ.staticValues.mapL1LayerNumber).getChildAt(0).sourceRect,i=e/gameOJ.gameSW+a.x,n=t/gameOJ.gameSH+a.y
;if(null!==gameOJ.player&&gameOJ.gameNN%1==0){
var s=new KhoiTest._Point(i,n),r=gameOJ.player.tankPoint.angleP(s)+90
;1===this.spaceSkill.a?(this.spaceSkill.r=r,
this.spaceSkill.a=1,this.touchAim=!0):gameOJ.player.changeTurretRotation(r)}
},t.fakeMouseMoveEvent=function(e,t){if(null!==gameOJ.player){
var a=new KhoiTest._Point(e,t),i=gameOJ.player.tankPoint.angleP(a)+90
;gameOJ.player.changeTurretRotation(i)}},t.buildMoveCode=function(){
if(1===this.moveStack.length)return this.moveMap[this.moveStack[0]];if(this.moveStack.length>1){
var e=this.moveStack.length,t=this.moveMap[this.moveStack[e-1]+this.moveStack[e-2]]
;return Boolean(t)?t:this.moveMap[this.moveStack[e-1]]}return-1},t.clearMove=function(){
2===gameOJ.gameTT&&(this.moveStack=[],gameOJ.movePlayer(-1))},t.touchMoveEvent=function(e,t){
null===t.controlType&&(t.controlType="touch")
;var a=new KhoiTest._Point(0,0),i=new KhoiTest._Point(0,0),n=gameOJ.stage2.getChildAt(gameOJ.staticValues.controlLayerNumber).getChildAt(0),s=gameOJ.stage2.getChildAt(gameOJ.staticValues.controlLayerNumber).getChildAt(1)
;i.x=e.localX,i.y=e.localY;let r=a.angleP(i),l=a.lengP(i);if(l<=30)s.x=n.x+i.x,s.y=n.y+i.y;else{
let e=new KhoiTest._Point(n.x,n.y).moveT(30,r);s.x=e.x,s.y=e.y}let o=t.findTouchMoveCode(r)
;o!==t.touchCode&&(t.touchCode=o,gameOJ.movePlayer(o))},t.touchTurretEvent=function(e,t,a=!0){
null===t.controlType&&(t.controlType="touch")
;var i=new KhoiTest._Point(0,0),n=new KhoiTest._Point(0,0),s=gameOJ.stage2.getChildAt(gameOJ.staticValues.controlLayerNumber).getChildAt(2),r=gameOJ.stage2.getChildAt(gameOJ.staticValues.controlLayerNumber).getChildAt(3)
;n.x=e.localX,n.y=e.localY;let l=i.angleP(n),o=i.lengP(n);if(o>30){
let e=new KhoiTest._Point(s.x,s.y).moveT(30,l);r.x=e.x,r.y=e.y}else r.x=s.x+n.x,r.y=s.y+n.y
;t.turretAim=!0,this.fakeMouse.x=n.x,this.fakeMouse.y=n.y},t.touchSkillEvent=function(e,t,a){
null===t.controlType&&(t.controlType="touch")
;var i=new KhoiTest._Point(0,0),n=new KhoiTest._Point(0,0);n.x=e.localX,n.y=e.localY
;let s=i.angleP(n);i.lengP(n);1===a&&(t.spaceSkill.r=s+90,t.spaceSkill.a=1,t.touchAim=!0)},
t.findTouchMoveCode=function(e){
return e>=-112.5&&e<-67.5?0:e>=-67.5&&e<-22.5?1:e>=-22.5&&e<22.5?2:e>=22.5&&e<67.5?3:e>=67.5&&e<112.5?4:e>=112.5&&e<157.5?5:e>=157.5||e<-157.5?6:e>=-157.5&&e<-112.5?7:void 0
},gameOJ.addCon("GameControl",e)}();